/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/ObjectPath","sap/fe/core/CommonUtils","sap/fe/core/helpers/FPMHelper","sap/fe/macros/CommonHelper","sap/m/HBox","sap/m/table/Util","sap/ui/core/Lib","sap/ui/model/Filter","sap/ui/model/Sorter","./FieldRuntimeHelper"],function(e,t,n,o,s,r,a,i,c,l,u){"use strict";const p={uploadPromises:{},creatingInactiveRow:false,isDraftIndicatorVisible:function(e,t,n,o,s){if(o!==undefined&&n!==undefined&&(!o||n)&&!s){return e===t}else{return false}},onValidateFieldGroup:function(e){const t=e.getSource();const o=n.getTargetView(t),s=o.getController();const r=u.getExtensionController(s);r._sideEffects.handleFieldGroupChange(e)},_fnFixHashQueryString:function(e){if(e?.includes("?")){e=e.split("?")[0]}return e},retrieveTextFromValueList:async function(t,n,o){let r;let a;let l;if(t){a=s.getMetaModel();l=a.getObject(`${n}@sapui.name`);return a.requestValueListInfo(n,true).then(function(e){const n=e[e[""]?"":Object.keys(e)[0]];const s=n.$model;const a=s.getMetaModel();const i=n.Parameters.find(function(e){return e.LocalDataProperty&&e.LocalDataProperty.$PropertyPath===l});if(i&&!i.ValueListProperty){throw new Error(`Inconsistent value help annotation for ${l}`)}const u=a.getObject(`/${n.CollectionPath}/${i.ValueListProperty}@com.sap.vocabularies.Common.v1.Text`);if(u&&u.$Path){r=u.$Path;const e=new c({path:i.ValueListProperty,operator:"EQ",value1:t});const o=s.bindList(`/${n.CollectionPath}`,undefined,undefined,e,{$select:r});return o.requestContexts(0,2)}else{o="Value";return t}}).then(function(e){const n=r?e[0]?.getObject()[r]:"";switch(o){case"Description":return n;case"DescriptionValue":return i.getResourceBundleFor("sap.fe.core").getText("C_FORMAT_FOR_TEXT_ARRANGEMENT",[n,t]);case"ValueDescription":return i.getResourceBundleFor("sap.fe.core").getText("C_FORMAT_FOR_TEXT_ARRANGEMENT",[t,n]);default:return t}}).catch(function(t){const o=t;const s=o.status&&o.status===404?`Metadata not found (${o.status}) for value help of property ${n}`:o.message;e.error(s)})}return t},displayAggregateDetails:async function(e,t){if(!t){return}const n=e.getSource();const s=o.getMdcTable(n);const i=n.getBindingContext();const c=i.getBinding();const u=i.getObject();const p=[];const d=i.getFilter();if(d){p.push(d)}const f=p.concat(c.getFilters("Application"),c.getFilters("Control"));const g=c.getAggregation();const m=g.aggregate[t].unit;const h={};h[m]={};const P={};P[t]={grandTotal:false,subtotals:false,unit:m};const T=n.getDependents()[0].clone();const C=new r({renderType:"Bare",justifyContent:"End",items:[T]});const F={group:h,aggregate:P};if(g.search){F.search=g.search}const y={path:c.getResolvedPath(),filters:f,parameters:{$$aggregation:F},sorter:new l(m,false)};const $=u["@$ui5.node.level"]===0;const b=await a.createOrUpdateMultiUnitPopover(`${s.getId()}-multiUnitPopover`,{control:s,grandTotal:$,itemsBindingInfo:y,listItemContentTemplate:C});s.addDependent(b);const v=()=>{s.removeDependent(b);b.detachEvent("afterClose",v);b.destroy()};b.attachEvent("afterClose",v);b.openBy(n)}};t.set("sap.fe.macros.field.FieldRuntime",p);return p},false);
//# sourceMappingURL=FieldRuntime.js.map