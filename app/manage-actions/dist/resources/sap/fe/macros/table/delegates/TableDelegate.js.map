{"version":3,"file":"TableDelegate.js","names":["SEMANTICKEY_HAS_DRAFTINDICATOR","SEARCH_HAS_BEEN_FIRED","COLUMN_HAS_BEEN_ADDED","PREVIOUS_SORTERS","Object","assign","TableDelegateBase","apiVersion","_computeVisualSettingsForFieldGroup","table","propertyInfo","propertyInfos","key","indexOf","column","getColumns","find","col","getPropertyKey","showDataFieldsLabel","data","oMetaModel","getModel","getMetaModel","involvedDataModelObjects","getInvolvedDataModelObjects","getContext","annotationPath","convertedMetaData","convertedTypes","oDataField","targetObject","oFieldGroup","Target","$target","aFieldWidth","Data","forEach","oData","oDataFieldWidth","$Type","TableSizeHelper","getWidthForDataFieldForAnnotation","getWidthForDataField","labelWidth","propertyWidth","SizeHelper","getButtonWidth","Label","toString","push","nWidest","reduce","acc","value","Math","max","visualSettings","deepExtend","widthCalculation","verticalArrangement","minWidth","ceil","_computeVisualSettingsForPropertyWithValueHelp","property","tableAPI","getParent","metaModel","dataField","getObject","gap","getProperty","_computeVisualSettingsForPropertyWithUnit","unit","unitText","timezoneText","oTableAPI","text","getReadOnly","_computeLabel","labelMap","label","propertiesWithSameLabel","isPropertyUsedAsTextOnlyProperty","some","prop","path","mode","length","includes","additionalLabels","filterable","join","_updatePropertyInfo","properties","p13nMode","getP13nMode","sortable","groupable","undefined","concat","this","groupLabel","group","dataType","visible","getColumnsFor","getTableDefinition","columns","fetchExportCapabilities","async","oTable","oCapabilities","XLSX","oModel","DelegateUtil","fetchModel","then","model","aSupportedFormats","aLowerFormats","map","element","toLowerCase","oAnnotation","catch","err","Log","error","_isFilterableNavigationProperty","columnInfo","columnDataModelObjectPath","isFilterable","isPathFilterable","relativePath","isPartOfLineItem","isPartOfCustomColumn","isConstant","_fetchPropertyInfo","appComponent","sAbsoluteNavigationPath","oNavigationContext","createBindingContext","isComplexType","typeConfig","className","bFilterable","CommonHelper","isPropertyFilterable","bIsAnalyticalTable","getCustomData","getLocalizedText","tooltip","_getTypeConfig","name","formatOptions","baseType","style","constraints","typeInstance","oConstraints","availability","exportSettings","_setPropertyInfoExportSettings","type","ColumnType","Annotation","template","clipboardSettings","keys","exportDataPointTargetValue","_updateAnalyticalPropertyInfoAttributes","isKey","isGroupable","textArrangement","_setTextArrangementInfo","extension","technicallyGroupable","caseSensitive","additionalLabel","exportFormat","_getExportFormat","format","TypeMap","getTypeConfig","isTypeFilterable","descriptionColumn","oCol","textProperty","valueProperty","descriptionProperty","aggregatable","_fetchComputedPropertyInfo","_fetchCustomPropertyInfo","header","startsWith","ModelHelper","fetchTextFromMetaModel","_bColumnHasPropertyWithDraftIndicator","oColumnInfo","hasDraftIndicator","fieldGroupDraftIndicatorPropertyPath","_updateDraftIndicatorModel","_oTable","_oColumnInfo","aVisibleColumns","oInternalBindingContext","getBindingContext","sInternalPath","getPath","index","setProperty","_fetchPropertiesForEntity","entityTypePath","bindingPath","getEntitySetPath","fetchedProperties","nonFilterableProperties","CommonUtils","getFilterRestrictionsByPath","NonFilterableProperties","Promise","resolve","maxConditions","isMultiValue","Error","setEnhancedFetchedPropertyInfos","getPropertyInfos","_getCachedOrFetchPropertiesForEntity","getCachedPropertyInfos","subFetchedProperties","setCachedPropertyInfos","setNoDataInformation","illustratedMessageInformation","noDataAggregation","getNoData","isA","currentIllustratedMessage","setTitle","title","setDescription","description","setIllustrationType","illustrationType","setIllustrationSize","illustrationSize","illustratedMessage","IllustratedMessage","setNoData","setTableNoDataIllustratedMessage","bindingInfo","tableFilterInfo","TableUtils","getAllFilterInfo","resourceModel","getResourceModel","suffixResourceKey","substring","illustratedInformation","getNoDataIllustratedMessageWithFilters","getQuickFilter","getText","IllustratedMessageType","NoSearchResults","filterAssociation","getFilter","hasFilterOrSearch","search","filters","test","NoData","getTargetView","getViewData","liveMode","getNoDataMessageMode","currentNoData","handleTableDataReceived","oInternalModelContext","oBinding","getRowBinding","bDataReceivedAttached","attachDataReceived","setTimeout","aSelectedContexts","getSelectedContexts","oActionOperationAvailableMap","JSON","parse","tableDefinition","operationAvailableMap","ActionRuntime","setActionEnablement","DeleteHelper","updateDeleteInfoForSelectedContexts","setUpEmptyRows","_updateAvailableCards","setOptimisticBatchPromiseForModel","controller","getAppComponent","setOptimisticBatchEnablerPromise","PromiseKeeper","setOptimisticBatchForModel","enableOptimisticBatchMode","filtersPropertiesAsPotentiallySensitiveDataOrDateType","isFilterEligibleForOptimisticBatch","_getFilterBarControl","getOptimisticBatchEnablerPromise","dataModel","isOptimisticBatchHasToBeEnabled","getShellServices","isFlpOptimisticBatchPluginLoaded","getOptimisticBatchEnabler","isOptimisticBatchDisabled","optimisticBatchEnablerPromiseKeeper","setOptimisticBatchEnabler","promise","rebind","oBindingInfo","bIsSuspended","TableRuntime","clearSelection","apply","onTableBound","whenBound","oError","fetchProperties","preInit","fastCreationRow","getCreationRow","setBindingContext","updateBindingInfo","internalBindingContext","_handleSortersOnCurrenciesOrUoM","_internalUpdateBindingInfo","_handleRecommendationOutputFields","_handleFiltersForExternalID","fireEvent","collectionBindingInfo","CollectionBindingInfoAPI","context","TableHelper","enableFastCreationRow","e","sorters","sorter","newSortersToBeApplied","tableProperties","tableProperty","unitProperty","unitSorterAvailable","sort","Sorter","getFilters","updateFiltersForExternalID","getPageController","recommendations","isRecommendationEnabled","tableDef","recommendationOutputProperties","getSideEffectsService","getRecommendationOutputFields","annotation","entityTypeName","parameters","$select","getView","converterType","cards","collectAvailableCards","collaborationManager","CollaborationManager","cardObject","updateCards","parentAppId","getId","getCollaborationManagerService","addCardsToCollaborationManager","shareAvailableCards","getInResultPropertyKeys","control","analyticalConfiguration","aggregationOnLeafLevel","allKkeysRequested","checkAllKeysAreRequested","overrideRowPress","requestAtLeast","filter","fieldName","origin","getContent","allColumns","keyPropertyNames","c","displayedColumns","referencedPropertyPaths","Set","processColumn","add","additionalProperties","additionalColumnName","additionalColumn","relatedColumnName","relatedColumn","every","propName","has","updateBinding","binding","needManualRefresh","view","manualUpdatePropertyKey","pendingManualUpdate","newSorters","stringify","viewData","oldFilters","previousSorters","filterNotChanged","deepEqual","getQueryOptionsFromParameters","$search","LRMultiViewEnabled","views","enableAnalytics","setAggregateConditions","setGroupConditions","setTableBindingInfo","setDownloadUrl","requestRefresh","getGroupId","finally","_computeRowBindingInfoFromTemplate","rowBindingInfo","getTableTemplateBindingInfo","bindingContext","tableCanBeInInlineEdit","getBinding","getUpdateGroupId","INLINEEDIT_UPDATEGROUPID","$$updateGroupId","$$getKeepAliveContext","collectionPath","internalModel","keptAliveLists","suspended","oFilter","oFilterInfo","Filter","and","oDataStateIndicator","getDataStateIndicator","isFiltering","updateBindingInfoWithSearchQuery","addFilterOnActiveEntities","filterInfo","normalizeSearchTerm","payload","getPayload","filterOnActiveEntities","filterOnActive","operator","value1","_templateSlotColumnFragment","modifier","tableId","slotColumnsXML","DOMParser","parseFromString","jsx","renderAsXML","getSlotColumn","slotXML","getElementsByTagName","oTemplate","firstElementChild","nodeName","replaceWith","remove","resultXML","XMLPreprocessor","process","models","getController","getOwnerComponent","getPreprocessorContext","targets","Fragment","load","definition","ExcelFormat","getExcelDatefromJSDate","getExcelDateTimefromJSDateTime","getExcelTimefromJSTime","_getVHRelevantFields","sMetadataPath","sBindingPath","aFields","oDataFieldData","$kind","oValue","iIndex","getNavigationPath","_setDraftIndicatorOnVisibleColumn","aColumns","aColumnsWithDraftIndicator","oColumn","sAddVisibleColumnName","sVisibleColumnName","bFoundColumnVisibleWithDraft","sColumnNameWithDraftIndicator","i","j","removeItem","oPropertyInfoName","mPropertyBag","doRemoveItem","oModifier","sDataProperty","insertAggregation","_setDraftIndicatorStatus","_getMetaModel","_getGroupId","sRetrievedGroupId","_insertAggregation","oValueHelp","addItem","propertyInfoName","sTableId","warning","sPath","getCustomDataWithModifier","oTableContext","getCurrentPageView","getComputedColumn","getEnhancedFetchedPropertyInfos","propInfo","oPropertyContext","fnTemplateFragment","oInPropertyInfo","oView","bDisplayMode","sTableTypeCustomData","sCreationModeCustomData","all","aCustomData","oThis","JSONModel","enableAutoColumnWidth","readOnly","tableType","id","navigationPropertyPath","collection","creationMode","widthIncludingColumnHeader","oPreprocessorSettings","bindingContexts","entitySet","tableCollection","handlerProvider","TableEventHandlerProvider","collectionEntity","computedColumnXML","getColumnTemplate","templateControlFragment","destroy","getFilterDelegate","FilterBarDelegate","oParentControl","sPropertyInfoName","replace","getTypeMap","formatGroupHeader","obj","dataBaseType","externalFormat","ValueFormatter","formatWithBrackets"],"sources":["./TableDelegate.ts"],"sourcesContent":["import type { DataFieldAbstractTypes, DataFieldForAnnotation, FieldGroupType } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport deepEqual from \"sap/base/util/deepEqual\";\nimport deepExtend from \"sap/base/util/deepExtend\";\nimport { isConstant } from \"sap/fe/base/BindingToolkit\";\nimport type { EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport jsx from \"sap/fe/base/jsx-runtime/jsx\";\nimport ActionRuntime from \"sap/fe/core/ActionRuntime\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type { FEView } from \"sap/fe/core/BaseController\";\nimport type { BaseTreeModifier } from \"sap/fe/core/CommonUtils\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport type { ListReportManifestSettings } from \"sap/fe/core/converters/ManifestSettings\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { WrappedCard } from \"sap/fe/core/services/CollaborationManagerServiceFactory\";\n\nimport type { EntitySet, NavigationProperty } from \"@sap-ux/vocabularies-types\";\nimport CollaborationManager from \"sap/fe/core/controllerextensions/cards/CollaborationManager\";\nimport type {\n\tAnnotationTableColumn,\n\tColumnExportSettings,\n\tComputedTableColumn,\n\tCustomBasedTableColumn,\n\tTableColumn\n} from \"sap/fe/core/converters/controls/Common/table/Columns\";\nimport { ColumnType } from \"sap/fe/core/converters/controls/Common/table/Columns\";\nimport type { CustomElement } from \"sap/fe/core/converters/helpers/ConfigurableObject\";\nimport ValueFormatter from \"sap/fe/core/formatters/ValueFormatter\";\nimport DeleteHelper from \"sap/fe/core/helpers/DeleteHelper\";\nimport ExcelFormat from \"sap/fe/core/helpers/ExcelFormatHelper\";\nimport type { InternalModelContext } from \"sap/fe/core/helpers/ModelHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport PromiseKeeper from \"sap/fe/core/helpers/PromiseKeeper\";\nimport { getLocalizedText, getResourceModel } from \"sap/fe/core/helpers/ResourceModelHelper\";\nimport SizeHelper from \"sap/fe/core/helpers/SizeHelper\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { isPathFilterable } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { isTypeFilterable } from \"sap/fe/core/type/EDM\";\nimport type { CollectionBindingInfo } from \"sap/fe/macros/CollectionBindingInfo\";\nimport CollectionBindingInfoAPI from \"sap/fe/macros/CollectionBindingInfo\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport DelegateUtil from \"sap/fe/macros/DelegateUtil\";\nimport type FilterBar from \"sap/fe/macros/controls/FilterBar\";\nimport FilterBarDelegate from \"sap/fe/macros/filterBar/FilterBarDelegate\";\nimport { getColumnTemplate, getComputedColumn, getSlotColumn } from \"sap/fe/macros/table/MdcTableTemplate\";\nimport type TableAPI from \"sap/fe/macros/table/TableAPI\";\nimport type { EnhancedFEPropertyInfo } from \"sap/fe/macros/table/TableAPI\";\nimport TableHelper from \"sap/fe/macros/table/TableHelper\";\nimport TableRuntime from \"sap/fe/macros/table/TableRuntime\";\nimport TableSizeHelper from \"sap/fe/macros/table/TableSizeHelper\";\nimport type { InternalBindingInfo } from \"sap/fe/macros/table/Utils\";\nimport TableUtils from \"sap/fe/macros/table/Utils\";\nimport type ListReportController from \"sap/fe/templates/ListReport/ListReportController.controller\";\nimport type { $IllustratedMessageSettings } from \"sap/m/IllustratedMessage\";\nimport IllustratedMessage from \"sap/m/IllustratedMessage\";\nimport IllustratedMessageType from \"sap/m/IllustratedMessageType\";\nimport type { BaseAggregationBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport Fragment from \"sap/ui/core/Fragment\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport XMLPreprocessor from \"sap/ui/core/util/XMLPreprocessor\";\nimport type { JsControlTreeModifier } from \"sap/ui/core/util/reflection\";\nimport type Control from \"sap/ui/mdc/Control\";\nimport type { default as MDCTable, MDCTablePropertyInfo as PropertyInfo, default as Table, VisualSettings } from \"sap/ui/mdc/Table\";\nimport type TypeConfig from \"sap/ui/mdc/TypeConfig\";\nimport type { ConditionObject } from \"sap/ui/mdc/condition/Condition\";\nimport TableDelegateBase from \"sap/ui/mdc/odata/v4/TableDelegate\";\nimport TypeMap from \"sap/ui/mdc/odata/v4/TypeMap\";\nimport type Context from \"sap/ui/model/Context\";\nimport Filter from \"sap/ui/model/Filter\";\nimport type MetaModel from \"sap/ui/model/MetaModel\";\nimport type Model from \"sap/ui/model/Model\";\nimport Sorter from \"sap/ui/model/Sorter\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type { default as ODataV4Context, default as v4Context } from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport TableEventHandlerProvider from \"../TableEventHandlerProvider\";\n\nconst SEMANTICKEY_HAS_DRAFTINDICATOR = \"/semanticKeyHasDraftIndicator\";\nconst SEARCH_HAS_BEEN_FIRED = \"searchFired\";\nconst COLUMN_HAS_BEEN_ADDED = \"columnAdded\";\nconst PREVIOUS_SORTERS = \"previousSorters\";\n\n/**\n * Helper class for sap.ui.mdc.Table.\n * <h3><b>Note:</b></h3>\n * The class is experimental and the API and the behavior are not finalized. This class is not intended for productive usage.\n * @author SAP SE\n * @private\n * @experimental\n * @since 1.69.0\n * @alias sap.fe.macros.TableDelegate\n */\nexport default Object.assign({}, TableDelegateBase, {\n\tapiVersion: 2,\n\t/**\n\t * This function calculates the width of a FieldGroup column.\n\t * The width of the FieldGroup is the width of the widest property contained in the FieldGroup (including the label if showDataFieldsLabel is true)\n\t * The result of this calculation is stored in the visualSettings.widthCalculation.minWidth property, which is used by the MDCtable.\n\t * @param table Instance of the MDCtable\n\t * @param propertyInfo Current propertyInfo\n\t * @param propertyInfos Array of properties\n\t * @private\n\t * @alias sap.fe.macros.TableDelegate\n\t */\n\t_computeVisualSettingsForFieldGroup: function (\n\t\ttable: Table,\n\t\tpropertyInfo: EnhancedFEPropertyInfo,\n\t\tpropertyInfos: EnhancedFEPropertyInfo[]\n\t) {\n\t\tif (propertyInfo.key.indexOf(\"DataFieldForAnnotation::FieldGroup::\") === 0) {\n\t\t\tconst column = table.getColumns().find((col) => {\n\t\t\t\treturn col.getPropertyKey() === propertyInfo.key;\n\t\t\t});\n\t\t\tconst showDataFieldsLabel = column ? column.data(\"showDataFieldsLabel\") === \"true\" : false;\n\t\t\tconst oMetaModel = (table.getModel() as ODataModel).getMetaModel();\n\t\t\tconst involvedDataModelObjects = getInvolvedDataModelObjects(oMetaModel.getContext(propertyInfo.annotationPath));\n\t\t\tconst convertedMetaData = involvedDataModelObjects.convertedTypes;\n\t\t\tconst oDataField = involvedDataModelObjects.targetObject as DataFieldForAnnotation;\n\t\t\tconst oFieldGroup = oDataField.Target.$target as FieldGroupType;\n\t\t\tconst aFieldWidth: number[] = [];\n\t\t\toFieldGroup.Data.forEach(function (oData: DataFieldAbstractTypes) {\n\t\t\t\tlet oDataFieldWidth: { labelWidth: number; propertyWidth: number };\n\t\t\t\tswitch (oData.$Type) {\n\t\t\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldForAnnotation\":\n\t\t\t\t\t\toDataFieldWidth = TableSizeHelper.getWidthForDataFieldForAnnotation(\n\t\t\t\t\t\t\toData,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\tpropertyInfos,\n\t\t\t\t\t\t\tconvertedMetaData,\n\t\t\t\t\t\t\tshowDataFieldsLabel\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"com.sap.vocabularies.UI.v1.DataField\":\n\t\t\t\t\t\toDataFieldWidth = TableSizeHelper.getWidthForDataField(\n\t\t\t\t\t\t\toData,\n\t\t\t\t\t\t\tshowDataFieldsLabel,\n\t\t\t\t\t\t\tpropertyInfos,\n\t\t\t\t\t\t\tconvertedMetaData,\n\t\t\t\t\t\t\tfalse\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldForAction\":\n\t\t\t\t\t\toDataFieldWidth = {\n\t\t\t\t\t\t\tlabelWidth: 0,\n\t\t\t\t\t\t\tpropertyWidth: SizeHelper.getButtonWidth(oData.Label?.toString())\n\t\t\t\t\t\t};\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t\tif (oDataFieldWidth!) {\n\t\t\t\t\taFieldWidth.push(oDataFieldWidth.labelWidth + oDataFieldWidth.propertyWidth);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst nWidest = aFieldWidth.reduce(function (acc: number, value: number) {\n\t\t\t\treturn Math.max(acc, value);\n\t\t\t}, 0);\n\t\t\tpropertyInfo.visualSettings = deepExtend(propertyInfo.visualSettings as object, {\n\t\t\t\twidthCalculation: {\n\t\t\t\t\tverticalArrangement: true,\n\t\t\t\t\tminWidth: Math.ceil(nWidest)\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t_computeVisualSettingsForPropertyWithValueHelp: function (table: Table, property: EnhancedFEPropertyInfo) {\n\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\tif (!property.propertyInfos) {\n\t\t\tconst metaModel = (table.getModel() as ODataModel).getMetaModel();\n\t\t\tif (property.annotationPath && metaModel) {\n\t\t\t\tconst dataField = metaModel.getObject(`${property.annotationPath}@`);\n\t\t\t\tif (dataField && dataField[\"@com.sap.vocabularies.Common.v1.ValueList\"]) {\n\t\t\t\t\tproperty.visualSettings = deepExtend(property.visualSettings || {}, {\n\t\t\t\t\t\twidthCalculation: {\n\t\t\t\t\t\t\tgap: tableAPI.getProperty(\"readOnly\") ? 0 : 4\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_computeVisualSettingsForPropertyWithUnit: function (\n\t\ttable: Table,\n\t\tpropertyInfo: PropertyInfo,\n\t\tunit?: string,\n\t\tunitText?: string,\n\t\ttimezoneText?: string\n\t) {\n\t\tconst oTableAPI: EnhanceWithUI5<TableAPI> | null = table ? (table.getParent() as EnhanceWithUI5<TableAPI>) : null;\n\t\t// update gap for properties with string unit\n\t\tconst text = unitText || timezoneText;\n\t\tif (text) {\n\t\t\tpropertyInfo.visualSettings = deepExtend(propertyInfo.visualSettings as VisualSettings, {\n\t\t\t\twidthCalculation: {\n\t\t\t\t\tgap: Math.ceil(SizeHelper.getButtonWidth(text))\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (unit) {\n\t\t\tpropertyInfo.visualSettings = deepExtend(propertyInfo.visualSettings as VisualSettings, {\n\t\t\t\twidthCalculation: {\n\t\t\t\t\t// For properties with unit, a gap needs to be added to properly render the column width on edit mode\n\t\t\t\t\tgap: oTableAPI && oTableAPI.getReadOnly() ? 0 : 6\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\n\t_computeLabel: function (property: EnhancedFEPropertyInfo, labelMap: { [label: string]: EnhancedFEPropertyInfo[] }) {\n\t\tif (property.label) {\n\t\t\tconst propertiesWithSameLabel = labelMap[property.label];\n\t\t\t// This computation is only for duplicate labels on navigation properties.\n\t\t\t// Exclude text navigation properties referenced as text on a property annotated with text arrangement set as TextOnly.\n\t\t\t// Exclude navigation properties created only for filtering purposes with a text arrangement set to TextOnly.\n\t\t\tconst isPropertyUsedAsTextOnlyProperty = propertiesWithSameLabel?.some(\n\t\t\t\t(prop) => prop.text === property.path && prop?.mode === \"Description\"\n\t\t\t);\n\t\t\tif (\n\t\t\t\tpropertiesWithSameLabel?.length > 1 &&\n\t\t\t\tproperty.path?.includes(\"/\") &&\n\t\t\t\tproperty.additionalLabels &&\n\t\t\t\t!isPropertyUsedAsTextOnlyProperty &&\n\t\t\t\t!(property?.mode === \"Description\" && property.filterable)\n\t\t\t) {\n\t\t\t\tproperty.label = property.label + \" (\" + property.additionalLabels.join(\" / \") + \")\";\n\t\t\t}\n\t\t\tdelete property.additionalLabels;\n\t\t}\n\t},\n\t//Update VisualSetting for columnWidth calculation and labels on navigation properties\n\t_updatePropertyInfo: function (table: Table, properties: EnhancedFEPropertyInfo[]) {\n\t\tconst labelMap: { [label: string]: EnhancedFEPropertyInfo[] } = {};\n\t\t// Check available p13n modes\n\t\tconst p13nMode = table.getP13nMode();\n\t\tproperties.forEach((property) => {\n\t\t\tif (!property.propertyInfos && property.label) {\n\t\t\t\t// Only for non-complex properties\n\t\t\t\tif (\n\t\t\t\t\t(p13nMode?.includes(\"Sort\") && property.sortable) ||\n\t\t\t\t\t(p13nMode?.includes(\"Filter\") && property.filterable) ||\n\t\t\t\t\t(p13nMode?.includes(\"Group\") && property.groupable)\n\t\t\t\t) {\n\t\t\t\t\tlabelMap[property.label] =\n\t\t\t\t\t\tlabelMap[property.label] !== undefined ? labelMap[property.label].concat([property]) : [property];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tproperties.forEach((property) => {\n\t\t\tthis._computeVisualSettingsForFieldGroup(table, property, properties);\n\t\t\tthis._computeVisualSettingsForPropertyWithValueHelp(table, property);\n\t\t\tthis._computeLabel(property, labelMap);\n\t\t});\n\t\t// Add the $editState property\n\t\tproperties.push({\n\t\t\tkey: \"$editState\",\n\t\t\tpath: \"$editState\",\n\t\t\tgroupLabel: \"\",\n\t\t\tgroup: \"\",\n\t\t\tlabel: \"\",\n\t\t\tdataType: \"sap.ui.model.odata.type.String\",\n\t\t\tvisible: false,\n\t\t\tgroupable: false,\n\t\t\tsortable: false,\n\t\t\tfilterable: false\n\t\t} as EnhancedFEPropertyInfo);\n\t\treturn properties;\n\t},\n\n\tgetColumnsFor: function (table: Table): TableColumn[] {\n\t\treturn (table.getParent() as TableAPI).getTableDefinition().columns;\n\t},\n\n\t/**\n\t * Returns the export capabilities for the given sap.ui.mdc.Table instance.\n\t * @param oTable Instance of the table\n\t * @returns Promise representing the export capabilities of the table instance\n\t */\n\tfetchExportCapabilities: async function (oTable: Table): Promise<{ XLSX?: unknown; PDF?: unknown }> {\n\t\tconst oCapabilities: { XLSX?: unknown; PDF?: unknown } = { XLSX: {} };\n\t\tlet oModel!: ODataModel;\n\t\treturn DelegateUtil.fetchModel(oTable)\n\t\t\t.then(function (model: Model) {\n\t\t\t\toModel = model as ODataModel;\n\t\t\t\treturn oModel.getMetaModel().getObject(\"/$EntityContainer@Org.OData.Capabilities.V1.SupportedFormats\");\n\t\t\t})\n\t\t\t.then(function (aSupportedFormats: string[] | undefined) {\n\t\t\t\tconst aLowerFormats = (aSupportedFormats || []).map((element) => {\n\t\t\t\t\treturn element.toLowerCase();\n\t\t\t\t});\n\t\t\t\tif (aLowerFormats.includes(\"application/pdf\")) {\n\t\t\t\t\treturn oModel.getMetaModel().getObject(\"/$EntityContainer@com.sap.vocabularies.PDF.v1.Features\");\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t})\n\t\t\t.then(function (oAnnotation: unknown) {\n\t\t\t\tif (oAnnotation) {\n\t\t\t\t\toCapabilities[\"PDF\"] = Object.assign({}, oAnnotation);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t})\n\t\t\t.catch(function (err) {\n\t\t\t\tLog.error(`An error occurs while computing export capabilities: ${err}`);\n\t\t\t})\n\t\t\t.then(function () {\n\t\t\t\treturn oCapabilities;\n\t\t\t});\n\t},\n\n\t/**\n\t * Filtering on navigation properties that are not part of the LineItem annotation nor of the custom columns is forbidden.\n\t * @param columnInfo\n\t * @param columnDataModelObjectPath\n\t * @returns Boolean true if filtering is allowed, false otherwise\n\t */\n\t_isFilterableNavigationProperty: function (\n\t\tcolumnInfo: AnnotationTableColumn,\n\t\tcolumnDataModelObjectPath: DataModelObjectPath<unknown>\n\t): boolean {\n\t\tconst isFilterable = isPathFilterable(columnDataModelObjectPath);\n\t\treturn (\n\t\t\t!columnInfo.relativePath.includes(\"/\") ||\n\t\t\t((columnInfo.isPartOfLineItem === true || columnInfo.isPartOfCustomColumn === true) &&\n\t\t\t\t!(isConstant(isFilterable) && isFilterable.value === false))\n\t\t);\n\t},\n\n\t_fetchPropertyInfo: function (\n\t\tmetaModel: MetaModel,\n\t\tcolumnInfo: AnnotationTableColumn,\n\t\ttable: Table,\n\t\tappComponent: AppComponent\n\t): EnhancedFEPropertyInfo {\n\t\tconst sAbsoluteNavigationPath = columnInfo.annotationPath,\n\t\t\toDataField = metaModel.getObject(sAbsoluteNavigationPath),\n\t\t\toNavigationContext = metaModel.createBindingContext(sAbsoluteNavigationPath) as Context,\n\t\t\tisComplexType = columnInfo.typeConfig?.className && columnInfo.typeConfig.className?.indexOf(\"Edm.\") !== 0,\n\t\t\tbFilterable = CommonHelper.isPropertyFilterable(oNavigationContext, oDataField),\n\t\t\tbIsAnalyticalTable = DelegateUtil.getCustomData(table, \"enableAnalytics\") === \"true\",\n\t\t\tlabel = getLocalizedText(columnInfo.label ?? \"\", appComponent ?? table),\n\t\t\ttooltip = getLocalizedText(columnInfo.tooltip ?? \"\", appComponent ?? table),\n\t\t\ttypeConfig = this._getTypeConfig(columnInfo, isComplexType),\n\t\t\tpropertyInfo: EnhancedFEPropertyInfo = {\n\t\t\t\tname: columnInfo.name,\n\t\t\t\tkey: columnInfo.name,\n\t\t\t\tannotationPath: sAbsoluteNavigationPath,\n\t\t\t\tgroupLabel: columnInfo.groupLabel,\n\t\t\t\tgroup: columnInfo.group,\n\t\t\t\tlabel: label,\n\t\t\t\ttooltip: tooltip,\n\t\t\t\tdataType: typeConfig.className,\n\t\t\t\ttypeConfig: typeConfig,\n\t\t\t\tformatOptions:\n\t\t\t\t\tcolumnInfo.typeConfig?.baseType === \"Edm.DateTimeOffset\"\n\t\t\t\t\t\t? { style: \"medium/short\" }\n\t\t\t\t\t\t: columnInfo.typeConfig?.formatOptions,\n\t\t\t\tconstraints: (typeConfig.typeInstance as { oConstraints?: object })?.oConstraints, // typeInstance is a SimpleType from MDC typeMap, the type is overwritten to get the constraints. It's possible to use the getConstraints method on the typeInstance but it adds unknown constraints (\"isV4\") so keeping as it's for now\n\t\t\t\tvisible: columnInfo.availability !== \"Hidden\" && !isComplexType,\n\t\t\t\texportSettings: this._setPropertyInfoExportSettings(columnInfo.exportSettings, columnInfo),\n\t\t\t\tunit: columnInfo.unit,\n\t\t\t\ttype: ColumnType.Annotation,\n\t\t\t\trelativePath: columnInfo.relativePath\n\t\t\t};\n\t\tif (propertyInfo.exportSettings?.template) {\n\t\t\tpropertyInfo.clipboardSettings = { template: propertyInfo.exportSettings.template };\n\t\t\t// if I set this clipBoardSettings the copy provider extract the data according to the template in the html property and it is properly copied in excel\n\t\t\t// but when we copy elsewhere we only get the raw data and not the templated data\n\t\t}\n\n\t\t// Set visualSettings only if it exists\n\t\tif (columnInfo.visualSettings && Object.keys(columnInfo.visualSettings).length > 0) {\n\t\t\tpropertyInfo.visualSettings = columnInfo.visualSettings;\n\t\t}\n\n\t\tif (columnInfo.exportDataPointTargetValue) {\n\t\t\tpropertyInfo.exportDataPointTargetValue = columnInfo.exportDataPointTargetValue;\n\t\t}\n\n\t\t// MDC expects  'propertyInfos' only for complex properties.\n\t\t// An empty array throws validation error and undefined value is unhandled.\n\t\tif (columnInfo.propertyInfos?.length) {\n\t\t\tpropertyInfo.propertyInfos = columnInfo.propertyInfos;\n\t\t} else {\n\t\t\t// Add properties which are supported only by simple PropertyInfos.\n\n\t\t\t//get the DataModelObjectPath for the column\n\t\t\tconst columnDataModelObjectPath = getInvolvedDataModelObjects(\n\t\t\t\tmetaModel.getContext(columnInfo.annotationPath),\n\t\t\t\tmetaModel.getContext(DelegateUtil.getCustomData(table, \"metaPath\")!)\n\t\t\t);\n\t\t\tpropertyInfo.path = columnInfo.relativePath;\n\t\t\t// TODO with the new complex property info, a lot of \"Description\" fields are added as filter/sort fields\n\t\t\tpropertyInfo.sortable = columnInfo.sortable;\n\t\t\tif (bIsAnalyticalTable) {\n\t\t\t\tthis._updateAnalyticalPropertyInfoAttributes(propertyInfo, columnInfo);\n\t\t\t}\n\t\t\tpropertyInfo.filterable =\n\t\t\t\tcolumnInfo.filterable !== false &&\n\t\t\t\t!!bFilterable &&\n\t\t\t\tthis._isFilterableNavigationProperty(columnInfo, columnDataModelObjectPath);\n\t\t\tpropertyInfo.isKey = columnInfo.isKey;\n\t\t\tpropertyInfo.groupable = columnInfo.isGroupable;\n\t\t\tif (columnInfo.textArrangement) {\n\t\t\t\tthis._setTextArrangementInfo(propertyInfo, columnInfo, table);\n\t\t\t}\n\t\t\tif (propertyInfo.isKey) {\n\t\t\t\tpropertyInfo.extension = {\n\t\t\t\t\t// MDC needs to fix this, it doesn't make sense for a non Analytical Table\n\t\t\t\t\ttechnicallyGroupable: true\n\t\t\t\t};\n\t\t\t}\n\t\t\tpropertyInfo.caseSensitive = columnInfo.caseSensitive;\n\t\t\tif (columnInfo.additionalLabels) {\n\t\t\t\tpropertyInfo.additionalLabels = columnInfo.additionalLabels.map((additionalLabel: string) => {\n\t\t\t\t\treturn getLocalizedText(additionalLabel, appComponent || table);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._computeVisualSettingsForPropertyWithUnit(table, propertyInfo, columnInfo.unit, columnInfo.unitText, columnInfo.timezoneText);\n\n\t\treturn propertyInfo;\n\t},\n\n\t/**\n\t * Extend the export settings based on the column info.\n\t * @param exportSettings The export settings to be extended\n\t * @param columnInfo The columnInfo object\n\t * @returns The extended export settings\n\t */\n\t_setPropertyInfoExportSettings: function (\n\t\texportSettings: ColumnExportSettings | undefined | null,\n\t\tcolumnInfo: AnnotationTableColumn\n\t): ColumnExportSettings | undefined | null {\n\t\tconst exportFormat = this._getExportFormat(columnInfo.typeConfig?.className);\n\t\tif (exportFormat && exportSettings) {\n\t\t\texportSettings.format = exportFormat;\n\t\t}\n\t\treturn exportSettings;\n\t},\n\n\t/**\n\t * Gets the type config for the given column info.\n\t * @param columnInfo The columnInfo object.\n\t * @param isComplexType Indicates if the dataType is complex.\n\t * @returns The MDC type config.\n\t */\n\t_getTypeConfig(columnInfo: AnnotationTableColumn, isComplexType?: boolean): TypeConfig {\n\t\tlet typeConfig = TypeMap.getTypeConfig(\"sap.ui.model.odata.type.String\"); // MDC expects always a dataType\n\t\tif (columnInfo.typeConfig?.className && isTypeFilterable(columnInfo.typeConfig.className)) {\n\t\t\ttypeConfig = TypeMap.getTypeConfig(\n\t\t\t\tcolumnInfo.typeConfig.className,\n\t\t\t\tcolumnInfo.typeConfig.formatOptions,\n\t\t\t\tcolumnInfo.typeConfig.constraints\n\t\t\t);\n\t\t} else if (columnInfo.typeConfig?.className && columnInfo.typeConfig?.className !== \"Edm.Stream\" && !isComplexType) {\n\t\t\t// Stream isn't supported as a DataType on MDC typeMap\n\t\t\ttypeConfig = TypeMap.getTypeConfig(columnInfo.typeConfig.className);\n\t\t}\n\t\treturn typeConfig;\n\t},\n\t/**\n\t * Set the text arrangement info for the column info.\n\t * @param propertyInfo The current propertyInfo object.\n\t * @param columnInfo The columnInfo object.\n\t * @param table The mdc table control.\n\t */\n\t_setTextArrangementInfo: function (propertyInfo: EnhancedFEPropertyInfo, columnInfo: AnnotationTableColumn, table: Table): void {\n\t\tconst descriptionColumn = this.getColumnsFor(table).find(function (oCol) {\n\t\t\treturn oCol.name === columnInfo.textArrangement?.textProperty;\n\t\t});\n\t\tif (descriptionColumn) {\n\t\t\tpropertyInfo.mode = columnInfo.textArrangement!.mode;\n\t\t\tpropertyInfo.valueProperty = columnInfo.relativePath;\n\t\t\tpropertyInfo.descriptionProperty = (descriptionColumn as EnhancedFEPropertyInfo).relativePath;\n\t\t}\n\t\tpropertyInfo.text = columnInfo.textArrangement?.textProperty;\n\t},\n\n\t_updateAnalyticalPropertyInfoAttributes(propertyInfo: PropertyInfo, columnInfo: AnnotationTableColumn) {\n\t\tif (columnInfo.aggregatable) {\n\t\t\tpropertyInfo.aggregatable = columnInfo.aggregatable;\n\t\t}\n\t\tif (columnInfo.extension) {\n\t\t\tpropertyInfo.extension = columnInfo.extension;\n\t\t}\n\t},\n\n\t_fetchComputedPropertyInfo: function (columnInfo: ComputedTableColumn, table: Table) {\n\t\tconst label = getLocalizedText(columnInfo.label, table); // Todo: To be removed once MDC provides translation support\n\t\tconst propertyInfo: PropertyInfo = {\n\t\t\tkey: columnInfo.name,\n\t\t\tlabel: label.toString(),\n\t\t\tdataType: \"sap.ui.model.odata.type.String\",\n\t\t\tvisible: columnInfo.availability !== \"Hidden\",\n\t\t\tfilterable: false,\n\t\t\tsortable: false,\n\t\t\tgroupable: false,\n\t\t\texportSettings: columnInfo.exportSettings,\n\t\t\tclipboardSettings: columnInfo.clipboardSettings as PropertyInfo[\"clipboardSettings\"]\n\t\t};\n\t\tif (columnInfo.propertyInfos !== undefined && columnInfo.propertyInfos.length > 0) {\n\t\t\tpropertyInfo.propertyInfos = columnInfo.propertyInfos;\n\t\t}\n\t\treturn propertyInfo;\n\t},\n\n\t_fetchCustomPropertyInfo: function (columnInfo: CustomBasedTableColumn, table: Table, appComponent: AppComponent) {\n\t\tlet label;\n\t\tif (columnInfo.header) {\n\t\t\tif (columnInfo.header.startsWith(\"{metaModel>\")) {\n\t\t\t\tlabel = ModelHelper.fetchTextFromMetaModel(columnInfo.header, undefined, (table.getModel() as ODataModel).getMetaModel());\n\t\t\t} else {\n\t\t\t\tlabel = getLocalizedText(columnInfo.header, appComponent); // Todo: To be removed once MDC provides translation support\n\t\t\t}\n\t\t}\n\t\tconst propertyInfo: PropertyInfo = {\n\t\t\tkey: columnInfo.name,\n\t\t\tgroupLabel: undefined,\n\t\t\tgroup: undefined,\n\t\t\tlabel: label ?? \"\",\n\t\t\tdataType: \"sap.ui.model.odata.type.String\",\n\t\t\tvisible: columnInfo.availability !== \"Hidden\",\n\t\t\texportSettings: columnInfo.exportSettings,\n\t\t\tvisualSettings: columnInfo.visualSettings as PropertyInfo[\"visualSettings\"]\n\t\t};\n\n\t\t// MDC expects 'propertyInfos' only for complex properties.\n\t\t// An empty array throws validation error and undefined value is unhandled.\n\t\tif (columnInfo.propertyInfos && columnInfo.propertyInfos.length) {\n\t\t\tpropertyInfo.propertyInfos = columnInfo.propertyInfos;\n\t\t} else {\n\t\t\t// Add properties which are supported only by simple PropertyInfos.\n\t\t\tpropertyInfo.path = columnInfo.name;\n\t\t\tpropertyInfo.sortable = false;\n\t\t\tpropertyInfo.filterable = false;\n\t\t}\n\t\treturn propertyInfo;\n\t},\n\t_bColumnHasPropertyWithDraftIndicator: function (oColumnInfo: TableColumn): boolean {\n\t\treturn !!(\n\t\t\t(oColumnInfo.formatOptions && oColumnInfo.formatOptions.hasDraftIndicator) ||\n\t\t\t(oColumnInfo.formatOptions && oColumnInfo.formatOptions.fieldGroupDraftIndicatorPropertyPath)\n\t\t);\n\t},\n\t_updateDraftIndicatorModel: function (_oTable: Table, _oColumnInfo: TableColumn): void {\n\t\tconst aVisibleColumns = _oTable.getColumns();\n\t\tconst oInternalBindingContext = _oTable.getBindingContext(\"internal\");\n\t\tconst sInternalPath = oInternalBindingContext && oInternalBindingContext.getPath();\n\t\tif (aVisibleColumns && oInternalBindingContext) {\n\t\t\tfor (const index in aVisibleColumns) {\n\t\t\t\tif (\n\t\t\t\t\tthis._bColumnHasPropertyWithDraftIndicator(_oColumnInfo) &&\n\t\t\t\t\t_oColumnInfo.name === aVisibleColumns[index].getPropertyKey()\n\t\t\t\t) {\n\t\t\t\t\tif (oInternalBindingContext.getProperty(sInternalPath + SEMANTICKEY_HAS_DRAFTINDICATOR) === undefined) {\n\t\t\t\t\t\toInternalBindingContext.setProperty(sInternalPath + SEMANTICKEY_HAS_DRAFTINDICATOR, _oColumnInfo.name);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t_fetchPropertiesForEntity: async function (\n\t\ttable: Table,\n\t\tentityTypePath: string,\n\t\tmetaModel: ODataMetaModel,\n\t\tappComponent: AppComponent\n\t): Promise<PropertyInfo[]> {\n\t\t// when fetching properties, this binding context is needed - so lets create it only once and use if for all properties/data-fields/line-items\n\t\tconst bindingPath = ModelHelper.getEntitySetPath(entityTypePath);\n\t\tlet fetchedProperties: PropertyInfo[] = [];\n\t\tconst nonFilterableProperties = CommonUtils.getFilterRestrictionsByPath(bindingPath, metaModel).NonFilterableProperties;\n\t\treturn Promise.resolve(this.getColumnsFor(table))\n\t\t\t.then((columns: TableColumn[]) => {\n\t\t\t\t// DraftAdministrativeData does not work via 'entitySet/$NavigationPropertyBinding/DraftAdministrativeData'\n\t\t\t\tif (columns) {\n\t\t\t\t\tlet propertyInfo;\n\t\t\t\t\tcolumns.forEach((columnInfo) => {\n\t\t\t\t\t\tthis._updateDraftIndicatorModel(table, columnInfo);\n\t\t\t\t\t\tswitch (columnInfo.type) {\n\t\t\t\t\t\t\tcase \"Annotation\":\n\t\t\t\t\t\t\t\tpropertyInfo = this._fetchPropertyInfo(metaModel, columnInfo as AnnotationTableColumn, table, appComponent);\n\t\t\t\t\t\t\t\tif (propertyInfo && !nonFilterableProperties.includes((propertyInfo as AnnotationTableColumn).name)) {\n\t\t\t\t\t\t\t\t\tpropertyInfo.maxConditions = DelegateUtil.isMultiValue(propertyInfo as AnnotationTableColumn) ? -1 : 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"Computed\":\n\t\t\t\t\t\t\t\tpropertyInfo = this._fetchComputedPropertyInfo(columnInfo as ComputedTableColumn, table);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"Slot\":\n\t\t\t\t\t\t\tcase \"Default\":\n\t\t\t\t\t\t\t\tpropertyInfo = this._fetchCustomPropertyInfo(columnInfo as CustomBasedTableColumn, table, appComponent);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthrow new Error(`unhandled switch case ${columnInfo.type}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfetchedProperties.push(propertyInfo as EnhancedFEPropertyInfo);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tfetchedProperties = this._updatePropertyInfo(table, fetchedProperties as EnhancedFEPropertyInfo[]);\n\t\t\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\t\t\ttableAPI.setEnhancedFetchedPropertyInfos(fetchedProperties as EnhancedFEPropertyInfo[]);\n\t\t\t\tfetchedProperties = tableAPI.getPropertyInfos();\n\t\t\t\treturn;\n\t\t\t})\n\t\t\t.catch(function (err) {\n\t\t\t\tLog.error(`An error occurs while updating fetched properties: ${err as string}`);\n\t\t\t})\n\t\t\t.then(function () {\n\t\t\t\treturn fetchedProperties;\n\t\t\t});\n\t},\n\n\t_getCachedOrFetchPropertiesForEntity: async function (\n\t\ttable: Table,\n\t\tentityTypePath: string,\n\t\tmetaModel: ODataMetaModel,\n\t\tappComponent: AppComponent\n\t): Promise<PropertyInfo[]> {\n\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\tconst fetchedProperties = tableAPI.getCachedPropertyInfos();\n\t\tif (fetchedProperties.length) {\n\t\t\treturn Promise.resolve(fetchedProperties);\n\t\t}\n\t\treturn this._fetchPropertiesForEntity(table, entityTypePath, metaModel, appComponent).then(function (\n\t\t\tsubFetchedProperties: PropertyInfo[]\n\t\t) {\n\t\t\ttableAPI.setCachedPropertyInfos(subFetchedProperties);\n\t\t\treturn subFetchedProperties;\n\t\t});\n\t},\n\tsetNoDataInformation: function (table: Table, illustratedMessageInformation: $IllustratedMessageSettings): void {\n\t\tconst noDataAggregation = table.getNoData();\n\t\tif (typeof noDataAggregation != \"string\" && (noDataAggregation as Control)?.isA(\"sap.m.IllustratedMessage\")) {\n\t\t\tconst currentIllustratedMessage = noDataAggregation as IllustratedMessage;\n\t\t\t// We override the current values of the IllustratedMessage\n\t\t\tcurrentIllustratedMessage.setTitle(illustratedMessageInformation.title);\n\t\t\tcurrentIllustratedMessage.setDescription(illustratedMessageInformation.description);\n\t\t\tcurrentIllustratedMessage.setIllustrationType(illustratedMessageInformation.illustrationType);\n\t\t\tcurrentIllustratedMessage.setIllustrationSize(illustratedMessageInformation.illustrationSize);\n\t\t} else {\n\t\t\tconst illustratedMessage = new IllustratedMessage({\n\t\t\t\t...illustratedMessageInformation\n\t\t\t});\n\t\t\ttable.setNoData(illustratedMessage);\n\t\t}\n\t},\n\n\tsetTableNoDataIllustratedMessage: function (table: Table, bindingInfo: CollectionBindingInfo) {\n\t\tconst tableFilterInfo = TableUtils.getAllFilterInfo(table);\n\t\tconst resourceModel = getResourceModel(table);\n\t\tconst suffixResourceKey = bindingInfo.path?.startsWith(\"/\") ? bindingInfo.path.substring(1) : bindingInfo.path;\n\t\tlet illustratedInformation: $IllustratedMessageSettings;\n\n\t\tconst getNoDataIllustratedMessageWithFilters = function (): $IllustratedMessageSettings {\n\t\t\tif (table.data(\"hiddenFilters\") || table.getQuickFilter()) {\n\t\t\t\treturn {\n\t\t\t\t\ttitle: resourceModel.getText(\"T_ILLUSTRATED_MESSAGE_TITLE_NOSEARCHRESULTS\"),\n\t\t\t\t\tdescription: resourceModel.getText(\"M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW\", undefined, suffixResourceKey),\n\t\t\t\t\tillustrationType: IllustratedMessageType.NoSearchResults\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\ttitle: resourceModel.getText(\"T_ILLUSTRATED_MESSAGE_TITLE_NOSEARCHRESULTS\"),\n\t\t\t\tdescription: resourceModel.getText(\"T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER\", undefined, suffixResourceKey),\n\t\t\t\tillustrationType: IllustratedMessageType.NoSearchResults\n\t\t\t};\n\t\t};\n\n\t\tconst filterAssociation = table.getFilter();\n\t\tconst hasFilterOrSearch = tableFilterInfo.search || tableFilterInfo.filters?.length;\n\t\tif (filterAssociation && !/BasicSearch$/.test(filterAssociation)) {\n\t\t\t// check if a FilterBar is associated to the Table (basic search on toolBar is excluded)\n\t\t\tif (hasFilterOrSearch) {\n\t\t\t\t// check if table has any Filterbar filters or personalization filters\n\t\t\t\tillustratedInformation = getNoDataIllustratedMessageWithFilters();\n\t\t\t} else {\n\t\t\t\tillustratedInformation = {\n\t\t\t\t\ttitle: resourceModel.getText(\"T_ILLUSTRATED_MESSAGE_TITLE_NOSEARCHRESULTS\"),\n\t\t\t\t\tdescription: resourceModel.getText(\"T_TABLE_AND_CHART_NO_DATA_TEXT\", undefined, suffixResourceKey),\n\t\t\t\t\tillustrationType: IllustratedMessageType.NoSearchResults\n\t\t\t\t};\n\t\t\t}\n\t\t} else if (hasFilterOrSearch) {\n\t\t\t//check if table has any personalization filters\n\t\t\tillustratedInformation = getNoDataIllustratedMessageWithFilters();\n\t\t} else {\n\t\t\tillustratedInformation = {\n\t\t\t\ttitle: resourceModel.getText(\"T_ILLUSTRATED_MESSAGE_TITLE_NODATA\"),\n\t\t\t\tdescription: resourceModel.getText(\"M_TABLE_AND_CHART_NO_FILTERS_NO_DATA_TEXT\", undefined, suffixResourceKey),\n\t\t\t\tillustrationType: IllustratedMessageType.NoData\n\t\t\t};\n\t\t}\n\t\tif (CommonUtils.getTargetView(table).getViewData().liveMode) {\n\t\t\tillustratedInformation = {\n\t\t\t\ttitle: resourceModel.getText(\"T_ILLUSTRATED_MESSAGE_TITLE_NOSEARCHRESULTS\"),\n\t\t\t\tdescription: resourceModel.getText(\"T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER\"),\n\t\t\t\tillustrationType: IllustratedMessageType.NoSearchResults\n\t\t\t};\n\t\t}\n\t\tillustratedInformation.illustrationSize = (table.getParent() as TableAPI).getNoDataMessageMode();\n\n\t\tif (illustratedInformation.illustrationSize === \"text\") {\n\t\t\tconst currentNoData = table.getNoData();\n\t\t\tif (typeof currentNoData === \"string\" && currentNoData === illustratedInformation.description) {\n\t\t\t\t// We don't change the noData aggregation unnecessary.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttable.setNoData(illustratedInformation.description);\n\t\t} else {\n\t\t\tthis.setNoDataInformation(table, illustratedInformation);\n\t\t}\n\t},\n\n\thandleTableDataReceived: function (oTable: Table, oInternalModelContext: InternalModelContext): void {\n\t\tconst oBinding = oTable && oTable.getRowBinding(),\n\t\t\tbDataReceivedAttached = oInternalModelContext && oInternalModelContext.getProperty(\"dataReceivedAttached\");\n\n\t\tif (oInternalModelContext && !bDataReceivedAttached) {\n\t\t\toBinding.attachDataReceived(() => {\n\t\t\t\t// as the dataReceived event is fired multiple times, we need to ensure that the event is only handled once\n\t\t\t\tif (!oInternalModelContext.getProperty(\"dataReceivedTimeoutSet\")) {\n\t\t\t\t\toInternalModelContext.setProperty(\"dataReceivedTimeoutSet\", true);\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\toInternalModelContext.setProperty(\"dataReceivedTimeoutSet\", false);\n\t\t\t\t\t\t// Refresh the selected contexts to trigger re-calculation of enabled state of actions.\n\t\t\t\t\t\toInternalModelContext.setProperty(\"selectedContexts\", []);\n\t\t\t\t\t\tconst aSelectedContexts = oTable.getSelectedContexts() as ODataV4Context[];\n\t\t\t\t\t\toInternalModelContext.setProperty(\"selectedContexts\", aSelectedContexts);\n\t\t\t\t\t\toInternalModelContext.setProperty(\"numberOfSelectedContexts\", aSelectedContexts.length);\n\t\t\t\t\t\tconst tableAPI = oTable.getParent() as TableAPI;\n\t\t\t\t\t\tconst oActionOperationAvailableMap = JSON.parse(tableAPI.tableDefinition.operationAvailableMap);\n\t\t\t\t\t\tActionRuntime.setActionEnablement(oInternalModelContext, oActionOperationAvailableMap, aSelectedContexts, \"table\");\n\t\t\t\t\t\t// Refresh enablement of delete button\n\t\t\t\t\t\tDeleteHelper.updateDeleteInfoForSelectedContexts(oInternalModelContext, aSelectedContexts);\n\t\t\t\t\t\tconst oTableAPI = oTable ? oTable.getParent() : null;\n\t\t\t\t\t\tif (oTableAPI) {\n\t\t\t\t\t\t\t(oTableAPI as TableAPI).setUpEmptyRows(oTable);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._updateAvailableCards(oTable);\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t});\n\t\t\toInternalModelContext.setProperty(\"dataReceivedAttached\", true);\n\t\t}\n\t},\n\n\t/**\n\t * Set the optimistic batch promise for the enabler callback function.\n\t * @param controller The controller\n\t * @param tableAPI The TableAPI\n\t */\n\tsetOptimisticBatchPromiseForModel: function (controller: ListReportController, tableAPI: TableAPI): void {\n\t\tconst model = controller.getAppComponent().getModel();\n\t\tif (model) {\n\t\t\ttableAPI.setOptimisticBatchEnablerPromise(new PromiseKeeper<boolean>());\n\t\t\tthis.setOptimisticBatchForModel(controller, model, tableAPI);\n\t\t}\n\t},\n\n\t/**\n\t * Enable the optimistic batch mode if available.\n\t * @param controller\n\t * @param table\n\t */\n\tenableOptimisticBatchMode: function (controller: ListReportController, table: Table): void {\n\t\tconst filtersPropertiesAsPotentiallySensitiveDataOrDateType =\n\t\t\ttable && TableUtils.isFilterEligibleForOptimisticBatch(table, controller._getFilterBarControl() as FilterBar);\n\t\t(table.getParent() as TableAPI).getOptimisticBatchEnablerPromise()?.resolve(!filtersPropertiesAsPotentiallySensitiveDataOrDateType);\n\t},\n\n\t/**\n\t * Setter for the optimistic batch enabler callback function.\n\t * @param controller\n\t * @param dataModel The OData Model\n\t * @param tableAPI The TableAPI\n\t * @see {sap.ui.model.odata.v4.ODataModel#setOptimisticBatchEnabler} for further information.\n\t */\n\tsetOptimisticBatchForModel: function (controller: ListReportController, dataModel: ODataModel, tableAPI: TableAPI): void {\n\t\tconst isOptimisticBatchHasToBeEnabled = controller.getAppComponent().getShellServices().isFlpOptimisticBatchPluginLoaded();\n\t\tif (dataModel.getOptimisticBatchEnabler() === null && !tableAPI.isOptimisticBatchDisabled() && isOptimisticBatchHasToBeEnabled) {\n\t\t\tconst optimisticBatchEnablerPromiseKeeper = tableAPI.getOptimisticBatchEnablerPromise();\n\t\t\tdataModel.setOptimisticBatchEnabler(function (): Promise<boolean> | undefined {\n\t\t\t\treturn optimisticBatchEnablerPromiseKeeper?.promise;\n\t\t\t});\n\t\t}\n\t},\n\n\trebind: async function (oTable: Table, oBindingInfo: BaseAggregationBindingInfo): Promise<void> {\n\t\tconst oTableAPI = oTable.getParent() as TableAPI;\n\t\tconst bIsSuspended = oTableAPI?.getProperty(\"bindingSuspended\");\n\t\toTableAPI?.setProperty(\"outDatedBinding\", bIsSuspended);\n\t\tif (!bIsSuspended) {\n\t\t\tTableRuntime.clearSelection(oTable);\n\t\t\tTableDelegateBase.rebind.apply(this, [oTable, oBindingInfo]);\n\t\t\tTableUtils.onTableBound(oTable);\n\t\t\treturn TableUtils.whenBound(oTable)\n\t\t\t\t.then((table: Table): void => {\n\t\t\t\t\tthis.handleTableDataReceived(table, table.getBindingContext(\"internal\") as InternalModelContext);\n\t\t\t\t\treturn;\n\t\t\t\t})\n\t\t\t\t.catch(function (oError) {\n\t\t\t\t\tLog.error(\"Error while waiting for the table to be bound\", oError as string);\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.resolve();\n\t},\n\n\t/**\n\t * Fetches the relevant metadata for the table and returns property info array.\n\t * @param table Instance of the MDCtable\n\t * @returns Array of property info\n\t */\n\tfetchProperties: async function (table: Table): Promise<PropertyInfo[]> {\n\t\treturn DelegateUtil.fetchModel(table)\n\t\t\t.then(async (model): Promise<PropertyInfo[]> => {\n\t\t\t\tconst appComponent = CommonUtils.getAppComponent(table);\n\t\t\t\treturn this._getCachedOrFetchPropertiesForEntity(\n\t\t\t\t\ttable,\n\t\t\t\t\tDelegateUtil.getCustomData<string>(table, \"entityType\") ?? \"\",\n\t\t\t\t\tmodel.getMetaModel() as ODataMetaModel,\n\t\t\t\t\tappComponent\n\t\t\t\t);\n\t\t\t})\n\t\t\t.then((properties) => {\n\t\t\t\t(table.getBindingContext(\"internal\") as Context)?.setProperty(\"tablePropertiesAvailable\", true);\n\t\t\t\treturn properties;\n\t\t\t});\n\t},\n\n\tpreInit: async function (table: Table): Promise<void> {\n\t\treturn (TableDelegateBase.preInit as (table: Table) => Promise<void>).apply(this, [table]).then(() => {\n\t\t\t/**\n\t\t\t * Set the binding context to null for every fast creation row to avoid inheriting\n\t\t\t * the wrong context and requesting the table columns on the parent entity\n\t\t\t * Set the correct binding context in ObjectPageController.enableFastCreationRow()\n\t\t\t */\n\t\t\tconst fastCreationRow = table.getCreationRow();\n\t\t\tif (fastCreationRow) {\n\t\t\t\tfastCreationRow.setBindingContext(null as unknown as Context);\n\t\t\t}\n\t\t\treturn;\n\t\t});\n\t},\n\tupdateBindingInfo: function (table: Table, bindingInfo: CollectionBindingInfo) {\n\t\tconst internalBindingContext = table.getBindingContext(\"internal\") as InternalModelContext | undefined;\n\t\tinternalBindingContext?.setProperty(\"isInsightsEnabled\", true);\n\t\tTableDelegateBase.updateBindingInfo.apply(this, [table, bindingInfo]);\n\t\ttry {\n\t\t\tthis._handleSortersOnCurrenciesOrUoM(table, bindingInfo);\n\t\t\tthis._internalUpdateBindingInfo(table, bindingInfo);\n\t\t\tthis.setTableNoDataIllustratedMessage(table, bindingInfo);\n\t\t\tthis._handleRecommendationOutputFields(table, bindingInfo);\n\t\t\tthis._handleFiltersForExternalID(table, bindingInfo);\n\n\t\t\ttable.getParent()?.fireEvent(\"beforeRebindTable\", { collectionBindingInfo: new CollectionBindingInfoAPI(bindingInfo) });\n\t\t\t/**\n\t\t\t * We have to set the binding context to null for every fast creation row to avoid it inheriting\n\t\t\t * the wrong context and requesting the table columns for the parent entity\n\t\t\t * The correct binding context is set in ObjectPageController.enableFastCreationRow()\n\t\t\t */\n\t\t\tconst context = table.getBindingContext();\n\t\t\t// eslint-disable-next-line deprecation/deprecation\n\t\t\tif (table.getCreationRow()?.getBindingContext() === null && bindingInfo.path && context) {\n\t\t\t\tTableHelper.enableFastCreationRow(\n\t\t\t\t\t// eslint-disable-next-line deprecation/deprecation\n\t\t\t\t\ttable.getCreationRow(),\n\t\t\t\t\tbindingInfo.path,\n\t\t\t\t\tcontext as v4Context,\n\t\t\t\t\ttable.getModel() as ODataModel,\n\t\t\t\t\tPromise.resolve()\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tLog.error(\"Error while updating the binding info\", e as string);\n\t\t}\n\t},\n\n\t_handleSortersOnCurrenciesOrUoM: function (table: Table, bindingInfo: CollectionBindingInfo) {\n\t\tconst sorters: Sorter[] | undefined = bindingInfo.sorter;\n\t\tconst newSortersToBeApplied: Sorter[] = [];\n\t\tif (sorters?.length) {\n\t\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\t\tconst tableProperties = tableAPI.getCachedPropertyInfos();\n\t\t\tfor (const sorter of sorters) {\n\t\t\t\tconst tableProperty = tableProperties?.find((property) => property.path === sorter.getPath());\n\t\t\t\tif (tableProperty?.unit) {\n\t\t\t\t\tconst unitProperty = tableProperties?.find((property) => property.key === tableProperty?.unit);\n\t\t\t\t\tconst unitSorterAvailable = unitProperty?.path && sorters.some((sort) => sort.getPath() === unitProperty.path);\n\t\t\t\t\tif (!unitSorterAvailable && unitProperty?.sortable !== false && unitProperty?.path) {\n\t\t\t\t\t\tnewSortersToBeApplied.push(new Sorter(unitProperty.path, false));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnewSortersToBeApplied.push(sorter);\n\t\t\t}\n\t\t\tbindingInfo.sorter = newSortersToBeApplied;\n\t\t}\n\t},\n\n\t_handleFiltersForExternalID: function (table: Table, bindingInfo: CollectionBindingInfo) {\n\t\tconst metaModel = (table.getModel() as ODataModel)?.getMetaModel();\n\t\tconst entityTypePath = bindingInfo.path + \"/\";\n\t\tconst filters = bindingInfo.filters?.getFilters();\n\t\tif (filters !== undefined) {\n\t\t\tTableUtils.updateFiltersForExternalID(metaModel, filters as unknown as ConditionObject[], entityTypePath);\n\t\t}\n\t},\n\n\t_handleRecommendationOutputFields: function (table: Table, oBindingInfo: CollectionBindingInfo) {\n\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\tconst controller = tableAPI?.getPageController();\n\t\tif (controller?.recommendations.isRecommendationEnabled()) {\n\t\t\tconst appComponent = controller.getAppComponent();\n\t\t\tconst tableDef = tableAPI.getTableDefinition();\n\t\t\tconst recommendationOutputProperties = appComponent\n\t\t\t\t.getSideEffectsService()\n\t\t\t\t.getRecommendationOutputFields(tableDef.annotation.entityTypeName);\n\t\t\tif (recommendationOutputProperties && recommendationOutputProperties.length > 0 && oBindingInfo.parameters) {\n\t\t\t\toBindingInfo.parameters.$select = oBindingInfo.parameters?.$select?.concat(\",\", recommendationOutputProperties.join());\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Update the cards when the binding is refreshed.\n\t * @param table The mdc table control.\n\t */\n\t_updateAvailableCards: async function (table: Table): Promise<void> {\n\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\tif (tableAPI.getPageController().getView().getViewData()?.converterType === \"ListReport\") {\n\t\t\tconst appComponent = tableAPI?.getPageController()?.getAppComponent();\n\t\t\tconst cards: WrappedCard[] = [];\n\t\t\tawait tableAPI.collectAvailableCards(cards);\n\t\t\tconst collaborationManager = new CollaborationManager();\n\t\t\tconst cardObject = collaborationManager.updateCards(cards);\n\t\t\tconst parentAppId = appComponent.getId();\n\t\t\tappComponent.getCollaborationManagerService().addCardsToCollaborationManager(cardObject, parentAppId);\n\t\t\tappComponent.getCollaborationManagerService().shareAvailableCards();\n\t\t}\n\t},\n\n\t/**\n\t * The hook implemented by MDC that we can override.\n\t * This allows us to define properties to be requested in the MDC table (Main case is for the analytical table).\n\t * @param table The mdc table control.\n\t * @returns An array of property name to be requested.\n\t */\n\tgetInResultPropertyKeys: function (table: MDCTable): string[] {\n\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\tif (tableAPI.tableDefinition.control.analyticalConfiguration?.aggregationOnLeafLevel) {\n\t\t\tconst allKkeysRequested = this.checkAllKeysAreRequested(tableAPI);\n\t\t\tconst internalBindingContext = table.getBindingContext(\"internal\");\n\t\t\t// if a rowpress is overridden, we  should enable the navigation at the node level\n\t\t\tinternalBindingContext?.setProperty(\"isNodeLevelNavigable\", tableAPI.overrideRowPress ? true : allKkeysRequested);\n\t\t\treturn (\n\t\t\t\tObject.keys(tableAPI.tableDefinition.requestAtLeast)\n\t\t\t\t\t// for analytic tables with aggregationOnLeafLevel we should not request the semanticKey expected when all keys are requested ->  it will permits to navigate from a node level when semanticKey are enabled\n\t\t\t\t\t// restriction are also excluded as we cannot destinguish between a node and a aggregation level\n\n\t\t\t\t\t.filter((fieldName: string) =>\n\t\t\t\t\t\t!allKkeysRequested\n\t\t\t\t\t\t\t? tableAPI.tableDefinition.requestAtLeast[fieldName].some(\n\t\t\t\t\t\t\t\t\t(origin) => origin !== \"restriction\" && origin !== \"semanticKey\"\n\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t: true\n\t\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn Object.keys(tableAPI.tableDefinition.requestAtLeast ?? {});\n\t},\n\n\t/**\n\t * Check if all keys() excepted IsActiveEntity) are requested in the table.\n\t * @param tableAPI The table API\n\t * @returns  True if all keys are requested, false otherwise\n\t */\n\tcheckAllKeysAreRequested: function (tableAPI: TableAPI): boolean {\n\t\tconst table = tableAPI.getContent();\n\t\tconst allColumns = tableAPI.getTableDefinition().columns as (TableColumn & { isKey: boolean; relativePath: string })[];\n\t\tconst keyPropertyNames = allColumns\n\t\t\t.filter((c) => c.isKey && c.relativePath && c.relativePath !== \"IsActiveEntity\")\n\t\t\t.map((c) => c.relativePath);\n\n\t\tconst displayedColumns = table\n\t\t\t.getColumns()\n\t\t\t.map((column) => tableAPI.getTableDefinition().columns.find((c) => c.name === column.getPropertyKey()));\n\n\t\t// Store all properties referenced by displayed columns in a Set\n\t\tconst referencedPropertyPaths = new Set<string>();\n\t\tfunction processColumn(col: AnnotationTableColumn): void {\n\t\t\t// Add the property name from column itself if it's not a complex propertyInfo\n\t\t\tif (col.relativePath && col.propertyInfos === undefined) {\n\t\t\t\treferencedPropertyPaths.add(col.relativePath);\n\t\t\t}\n\n\t\t\t// Add the additional properties referenced by the column\n\t\t\tcol.extension?.additionalProperties?.forEach((additionalColumnName) => {\n\t\t\t\tconst additionalColumn = allColumns.find((c) => c.name === additionalColumnName);\n\t\t\t\tif (additionalColumn?.relativePath) {\n\t\t\t\t\treferencedPropertyPaths.add(additionalColumn.relativePath);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tdisplayedColumns.forEach((column) => {\n\t\t\tif (!column) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Process the column itself\n\t\t\tprocessColumn(column as AnnotationTableColumn);\n\n\t\t\t// Process the columns referenced by the column\n\t\t\tcolumn.propertyInfos?.forEach((relatedColumnName) => {\n\t\t\t\tconst relatedColumn = allColumns.find((c) => c.name === relatedColumnName);\n\t\t\t\tif (relatedColumn) {\n\t\t\t\t\tprocessColumn(relatedColumn as AnnotationTableColumn);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn keyPropertyNames.every((propName) => propName && referencedPropertyPaths.has(propName));\n\t},\n\n\tupdateBinding: function (table: MDCTable, bindingInfo: CollectionBindingInfo, binding?: ODataListBinding): void {\n\t\tconst tableAPI = table.getParent() as TableAPI;\n\t\tconst bIsSuspended = tableAPI?.getProperty(\"bindingSuspended\");\n\t\tif (!bIsSuspended) {\n\t\t\tlet needManualRefresh = false;\n\t\t\tconst view = CommonUtils.getTargetView(table);\n\t\t\tconst internalBindingContext = table.getBindingContext(\"internal\");\n\t\t\tconst manualUpdatePropertyKey = \"pendingManualBindingUpdate\";\n\t\t\tconst pendingManualUpdate = internalBindingContext?.getProperty(manualUpdatePropertyKey) as boolean;\n\t\t\tconst newSorters = JSON.stringify(bindingInfo.sorter ?? []);\n\n\t\t\tif (binding) {\n\t\t\t\t/**\n\t\t\t\t * Manual refresh if filters are not changed by binding.refresh() since updating the bindingInfo\n\t\t\t\t * is not enough to trigger a batch request.\n\t\t\t\t * Removing columns creates one batch request that was not executed before\n\t\t\t\t */\n\t\t\t\tconst viewData = view?.getViewData() as ListReportManifestSettings;\n\t\t\t\tconst oldFilters = binding.getFilters(\"Application\");\n\t\t\t\tconst previousSorters = internalBindingContext?.getProperty(PREVIOUS_SORTERS) ?? \"[]\";\n\n\t\t\t\tconst filterNotChanged =\n\t\t\t\t\tdeepEqual(bindingInfo.filters, oldFilters[0]) &&\n\t\t\t\t\tnewSorters === previousSorters &&\n\t\t\t\t\tbindingInfo.path === binding.getPath() && // The path can be changed in case of a parametrized entity\n\t\t\t\t\tbinding.getQueryOptionsFromParameters().$search === bindingInfo?.parameters?.$search;\n\t\t\t\tconst LRMultiViewEnabled = !!viewData.views;\n\n\t\t\t\tneedManualRefresh =\n\t\t\t\t\tfilterNotChanged &&\n\t\t\t\t\t(internalBindingContext?.getProperty(SEARCH_HAS_BEEN_FIRED) || // check if the search has been triggered\n\t\t\t\t\t\tinternalBindingContext?.getProperty(COLUMN_HAS_BEEN_ADDED) || // check if a column has been added\n\t\t\t\t\t\tLRMultiViewEnabled) && // if the multi view is enabled the request should be refreshed as we don't known if the content of the table is outdated due to an action on another table\n\t\t\t\t\t!pendingManualUpdate;\n\t\t\t}\n\t\t\t// Cleanup groupConditions and aggregateConditions if they don't make sense\n\t\t\tif (tableAPI.getTableDefinition().enableAnalytics !== true) {\n\t\t\t\t// Aggregate conditions never make sense outside of an analytical table\n\t\t\t\ttable.setAggregateConditions();\n\n\t\t\t\t// Group conditions don't make sense in a Tree or Grid table\n\t\t\t\tif (\n\t\t\t\t\ttableAPI.getTableDefinition().control.type === \"GridTable\" ||\n\t\t\t\t\ttableAPI.getTableDefinition().control.type === \"TreeTable\"\n\t\t\t\t) {\n\t\t\t\t\ttable.setGroupConditions();\n\t\t\t\t}\n\t\t\t}\n\t\t\tTableDelegateBase.updateBinding.apply(this, [table, bindingInfo, binding]);\n\t\t\t// we store the table binding info that was used to bind the table in the table API\n\t\t\t// this needs to be done after the call to TableDelegateBase.updateBinding other wise we don't get the aggregate parameters\n\t\t\t// otherwise there is no way to retrieve sorters added in the onBeforeRebindTable event\n\t\t\ttableAPI.setTableBindingInfo(bindingInfo);\n\t\t\t// we make the call to update the download url but do not await it\n\t\t\ttableAPI.setDownloadUrl();\n\n\t\t\ttable.fireEvent(\"bindingUpdated\");\n\t\t\tif (needManualRefresh && table.getFilter() && binding) {\n\t\t\t\tbinding\n\t\t\t\t\t.requestRefresh(binding.getGroupId())\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tinternalBindingContext?.setProperty(manualUpdatePropertyKey, false);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function (oError) {\n\t\t\t\t\t\tLog.error(\"Error while refreshing the table\", oError as string);\n\t\t\t\t\t});\n\t\t\t\tinternalBindingContext?.setProperty(manualUpdatePropertyKey, true);\n\t\t\t}\n\t\t\tinternalBindingContext?.setProperty(SEARCH_HAS_BEEN_FIRED, false);\n\t\t\tinternalBindingContext?.setProperty(COLUMN_HAS_BEEN_ADDED, false);\n\t\t\tinternalBindingContext?.setProperty(PREVIOUS_SORTERS, newSorters);\n\n\t\t\t//for Treetable, it's necessary to clear the pastableContexts since the binding destroys previous contexts.\n\t\t\tif (tableAPI.getTableDefinition().control.type === \"TreeTable\") {\n\t\t\t\tinternalBindingContext?.setProperty(\"pastableContexts\", []);\n\t\t\t}\n\t\t}\n\t\ttableAPI?.setProperty(\"outDatedBinding\", bIsSuspended);\n\t},\n\n\t_computeRowBindingInfoFromTemplate: function (oTable: Table): CollectionBindingInfo {\n\t\tconst tableAPI = oTable.getParent() as TableAPI;\n\t\tconst rowBindingInfo = tableAPI.getTableTemplateBindingInfo();\n\t\tconst bindingContext = oTable.getBindingContext();\n\t\tlet tableCanBeInInlineEdit = false;\n\t\tif (\n\t\t\tbindingContext === undefined &&\n\t\t\toTable.getBindingContext(\"ui\")?.getProperty(\"isEditable\") === false &&\n\t\t\toTable.getModel(\"viewData\")?.getProperty(\"/isInlineEditEnabled\")\n\t\t) {\n\t\t\ttableCanBeInInlineEdit = true;\n\t\t} else if (\n\t\t\t(bindingContext as ODataV4Context | undefined)?.getBinding().getUpdateGroupId() == CommonUtils.INLINEEDIT_UPDATEGROUPID\n\t\t) {\n\t\t\ttableCanBeInInlineEdit = true;\n\t\t}\n\n\t\tif (tableCanBeInInlineEdit) {\n\t\t\trowBindingInfo.parameters ??= {};\n\t\t\trowBindingInfo.parameters.$$updateGroupId = CommonUtils.INLINEEDIT_UPDATEGROUPID;\n\t\t}\n\n\t\t// if the rowBindingInfo has a $$getKeepAliveContext parameter we need to check it is the only Table with such a\n\t\t// parameter for the collectionMetaPath\n\t\tif (rowBindingInfo.parameters?.$$getKeepAliveContext === true) {\n\t\t\tconst collectionPath = DelegateUtil.getCustomData<string>(oTable, \"targetCollectionPath\") ?? \"\";\n\t\t\tconst internalModel = oTable.getModel(\"internal\") as JSONModel;\n\t\t\tconst keptAliveLists = internalModel?.getObject(\"/keptAliveLists\") ?? {};\n\t\t\tif (!keptAliveLists[collectionPath]) {\n\t\t\t\tkeptAliveLists[collectionPath] = oTable.getId();\n\t\t\t\tinternalModel?.setProperty(\"/keptAliveLists\", keptAliveLists);\n\t\t\t} else if (keptAliveLists[collectionPath] !== oTable.getId()) {\n\t\t\t\tdelete rowBindingInfo.parameters.$$getKeepAliveContext;\n\t\t\t}\n\t\t}\n\n\t\treturn rowBindingInfo;\n\t},\n\t_internalUpdateBindingInfo: function (oTable: Table, oBindingInfo: CollectionBindingInfo) {\n\t\tconst oInternalModelContext = oTable.getBindingContext(\"internal\") as InternalModelContext | undefined;\n\t\tObject.assign(oBindingInfo, this._computeRowBindingInfoFromTemplate(oTable));\n\t\t/**\n\t\t * Binding info might be suspended at the beginning when the first bindRows is called:\n\t\t * To avoid duplicate requests but still have a binding to create new entries.\t\t\t\t *\n\t\t * After the initial binding step, follow up bindings should no longer be suspended.\n\t\t */\n\t\tif (oTable.getRowBinding()) {\n\t\t\toBindingInfo.suspended = false;\n\t\t}\n\t\t// The previously added handler for the event 'dataReceived' is not anymore there\n\t\t// since the bindingInfo is recreated from scratch so we need to set the flag to false in order\n\t\t// to again add the handler on this event if needed\n\t\tif (oInternalModelContext) {\n\t\t\toInternalModelContext.setProperty(\"dataReceivedAttached\", false);\n\t\t}\n\n\t\tlet oFilter;\n\t\tconst oFilterInfo = TableUtils.getAllFilterInfo(oTable);\n\t\t// Prepare binding info with filter/search parameters\n\t\tif (oFilterInfo.filters.length > 0) {\n\t\t\toFilter = new Filter({ filters: oFilterInfo.filters, and: true });\n\t\t}\n\t\tif (oFilterInfo.bindingPath) {\n\t\t\toBindingInfo.path = oFilterInfo.bindingPath;\n\t\t}\n\n\t\tconst oDataStateIndicator = oTable.getDataStateIndicator();\n\t\tif (oDataStateIndicator && oDataStateIndicator.isFiltering()) {\n\t\t\t// Include filters on messageStrip\n\t\t\tif ((oBindingInfo.filters as unknown as Filter[]).length > 0) {\n\t\t\t\toFilter = new Filter({ filters: (oBindingInfo.filters as unknown as Filter[]).concat(oFilterInfo.filters), and: true });\n\t\t\t\tthis.updateBindingInfoWithSearchQuery(oBindingInfo, oFilterInfo, oFilter);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.updateBindingInfoWithSearchQuery(oBindingInfo, oFilterInfo, oFilter);\n\t\t}\n\n\t\tthis.addFilterOnActiveEntities(oTable, oBindingInfo);\n\t},\n\n\tupdateBindingInfoWithSearchQuery: function (bindingInfo: CollectionBindingInfo, filterInfo: InternalBindingInfo, filter?: Filter) {\n\t\tbindingInfo.filters = filter;\n\t\tbindingInfo.parameters ??= {};\n\t\tif (filterInfo.search) {\n\t\t\tbindingInfo.parameters.$search = CommonUtils.normalizeSearchTerm(filterInfo.search);\n\t\t} else {\n\t\t\tbindingInfo.parameters.$search = undefined;\n\t\t}\n\t},\n\t/**\n\t * If specified in the payload, adds a filter to display only active entities.\n\t * @param table\n\t * @param bindingInfo\n\t */\n\taddFilterOnActiveEntities: function (table: Table, bindingInfo: CollectionBindingInfo) {\n\t\tconst payload = table.getPayload() as { filterOnActiveEntities?: boolean };\n\n\t\tif (payload?.filterOnActiveEntities === true) {\n\t\t\tconst filterOnActive = new Filter({ path: \"IsActiveEntity\", operator: \"EQ\", value1: true });\n\t\t\tif (bindingInfo.filters) {\n\t\t\t\tbindingInfo.filters = new Filter({ filters: [filterOnActive, bindingInfo.filters], and: true });\n\t\t\t} else {\n\t\t\t\tbindingInfo.filters = filterOnActive;\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Creates a template from the fragment of a slot column.\n\t * @param columnInfo The custom table column\n\t * @param view The current view\n\t * @param modifier The control tree modifier\n\t * @param tableId The id of the underlying table\n\t * @returns The loaded fragment\n\t */\n\t_templateSlotColumnFragment: async function (\n\t\tcolumnInfo: CustomElement<CustomBasedTableColumn>,\n\t\tview: View,\n\t\tmodifier: BaseTreeModifier | JsControlTreeModifier,\n\t\ttableId: string\n\t): Promise<null | Control | Control[] | Element> {\n\t\tconst slotColumnsXML = new DOMParser().parseFromString(\n\t\t\tjsx.renderAsXML(() => {\n\t\t\t\treturn getSlotColumn(tableId, columnInfo, false) as unknown as string;\n\t\t\t}),\n\t\t\t\"text/xml\"\n\t\t);\n\t\tif (!slotColumnsXML) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\t\tconst slotXML = slotColumnsXML.getElementsByTagName(\"slot\")[0];\n\n\t\tif (columnInfo.template) {\n\t\t\tif (slotXML) {\n\t\t\t\tconst oTemplate = new DOMParser().parseFromString(columnInfo.template as string, \"text/xml\");\n\t\t\t\tif (oTemplate.firstElementChild && oTemplate.firstElementChild.nodeName !== \"html\") {\n\t\t\t\t\tslotXML.replaceWith(oTemplate.firstElementChild);\n\t\t\t\t} else {\n\t\t\t\t\tslotXML.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tLog.error(`Please provide content inside this Building Block Column: ${columnInfo.header}`);\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\t\tconst resultXML = await XMLPreprocessor.process(\n\t\t\tslotColumnsXML.firstElementChild,\n\t\t\t{ models: {} },\n\t\t\t(view.getController().getOwnerComponent() as EnhanceWithUI5<TemplateComponent>).getPreprocessorContext()\n\t\t);\n\t\tif (modifier?.targets !== \"jsControlTree\") {\n\t\t\treturn resultXML.firstElementChild;\n\t\t}\n\t\treturn Fragment.load({\n\t\t\ttype: \"XML\",\n\t\t\tdefinition: resultXML,\n\t\t\tcontroller: view.getController()\n\t\t}) as Promise<Control | Control[]>;\n\t},\n\n\t_getExportFormat: function (dataType?: string) {\n\t\tswitch (dataType) {\n\t\t\tcase \"Edm.Date\":\n\t\t\t\treturn ExcelFormat.getExcelDatefromJSDate();\n\t\t\tcase \"Edm.DateTimeOffset\":\n\t\t\t\treturn ExcelFormat.getExcelDateTimefromJSDateTime();\n\t\t\tcase \"Edm.TimeOfDay\":\n\t\t\t\treturn ExcelFormat.getExcelTimefromJSTime();\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t},\n\n\t_getVHRelevantFields: function (oMetaModel: ODataMetaModel, sMetadataPath: string, sBindingPath?: string): string[] {\n\t\tlet aFields: string[] = [],\n\t\t\toDataFieldData = oMetaModel.getObject(sMetadataPath);\n\n\t\tif (oDataFieldData.$kind && oDataFieldData.$kind === \"Property\") {\n\t\t\toDataFieldData = oMetaModel.getObject(`${sMetadataPath}@com.sap.vocabularies.UI.v1.DataFieldDefault`);\n\t\t\tsMetadataPath = `${sMetadataPath}@com.sap.vocabularies.UI.v1.DataFieldDefault`;\n\t\t}\n\t\tswitch (oDataFieldData.$Type) {\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldForAnnotation\":\n\t\t\t\tif (oMetaModel.getObject(`${sMetadataPath}/Target/$AnnotationPath`).includes(\"com.sap.vocabularies.UI.v1.FieldGroup\")) {\n\t\t\t\t\toMetaModel.getObject(`${sMetadataPath}/Target/$AnnotationPath/Data`).forEach((oValue: unknown, iIndex: number) => {\n\t\t\t\t\t\taFields = aFields.concat(\n\t\t\t\t\t\t\tthis._getVHRelevantFields(oMetaModel, `${sMetadataPath}/Target/$AnnotationPath/Data/${iIndex}`)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath\":\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldWithUrl\":\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataField\":\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation\":\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldWithAction\":\n\t\t\t\taFields.push(oMetaModel.getObject(`${sMetadataPath}/Value/$Path`));\n\t\t\t\tbreak;\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldForAction\":\n\t\t\tcase \"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation\":\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// property\n\t\t\t\t// temporary workaround to make sure VH relevant field path do not contain the bindingpath\n\t\t\t\tif (sBindingPath && sMetadataPath.indexOf(sBindingPath) === 0) {\n\t\t\t\t\taFields.push(sMetadataPath.substring(sBindingPath.length + 1));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\taFields.push(CommonHelper.getNavigationPath(sMetadataPath, true));\n\t\t\t\tbreak;\n\t\t}\n\t\treturn aFields;\n\t},\n\t_setDraftIndicatorOnVisibleColumn: function (oTable: Table, aColumns: TableColumn[], oColumnInfo?: TableColumn) {\n\t\tconst oInternalBindingContext = oTable.getBindingContext(\"internal\");\n\t\tif (!oInternalBindingContext) {\n\t\t\treturn;\n\t\t}\n\t\tconst sInternalPath = oInternalBindingContext.getPath();\n\t\tconst aColumnsWithDraftIndicator = aColumns.filter((oColumn: TableColumn) => {\n\t\t\treturn this._bColumnHasPropertyWithDraftIndicator(oColumn);\n\t\t});\n\t\tconst aVisibleColumns = oTable.getColumns();\n\t\tlet sAddVisibleColumnName, sVisibleColumnName, bFoundColumnVisibleWithDraft, sColumnNameWithDraftIndicator;\n\t\tfor (const i in aVisibleColumns) {\n\t\t\tsVisibleColumnName = aVisibleColumns[i].getPropertyKey();\n\t\t\tfor (const j in aColumnsWithDraftIndicator) {\n\t\t\t\tsColumnNameWithDraftIndicator = aColumnsWithDraftIndicator[j].name;\n\t\t\t\tif (sVisibleColumnName === sColumnNameWithDraftIndicator) {\n\t\t\t\t\tbFoundColumnVisibleWithDraft = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (oColumnInfo && oColumnInfo.name === sColumnNameWithDraftIndicator) {\n\t\t\t\t\tsAddVisibleColumnName = oColumnInfo.name;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bFoundColumnVisibleWithDraft) {\n\t\t\t\toInternalBindingContext.setProperty(sInternalPath + SEMANTICKEY_HAS_DRAFTINDICATOR, sVisibleColumnName);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!bFoundColumnVisibleWithDraft && sAddVisibleColumnName) {\n\t\t\toInternalBindingContext.setProperty(sInternalPath + SEMANTICKEY_HAS_DRAFTINDICATOR, sAddVisibleColumnName);\n\t\t}\n\t},\n\tremoveItem: async function (\n\t\toTable: UI5Element | Element,\n\t\toPropertyInfoName: UI5Element | Element,\n\t\tmPropertyBag: { modifier: BaseTreeModifier; appComponent: AppComponent }\n\t): Promise<boolean> {\n\t\tlet doRemoveItem = true;\n\t\tif (!oPropertyInfoName) {\n\t\t\t// 1. Application removed the property from their data model\n\t\t\t// 2. addItem failed before revertData created\n\t\t\treturn Promise.resolve(doRemoveItem);\n\t\t}\n\t\tconst oModifier = mPropertyBag.modifier;\n\t\tconst sDataProperty = await oModifier.getProperty<string>(oPropertyInfoName, \"dataProperty\");\n\t\tif (sDataProperty && sDataProperty.includes && sDataProperty.includes(\"InlineXML\")) {\n\t\t\toModifier.insertAggregation(oTable, \"dependents\", oPropertyInfoName);\n\t\t\tdoRemoveItem = false;\n\t\t}\n\t\tif ((oTable as UI5Element).isA && oModifier.targets === \"jsControlTree\") {\n\t\t\tthis._setDraftIndicatorStatus(oModifier, oTable, this.getColumnsFor(oTable as Table));\n\t\t}\n\t\treturn Promise.resolve(doRemoveItem);\n\t},\n\t_getMetaModel: function (mPropertyBag: { appComponent: AppComponent }) {\n\t\treturn mPropertyBag.appComponent && mPropertyBag.appComponent.getModel().getMetaModel();\n\t},\n\t_setDraftIndicatorStatus: function (\n\t\toModifier: BaseTreeModifier,\n\t\toTable: UI5Element | Element,\n\t\taColumns: TableColumn[],\n\t\toColumnInfo?: TableColumn\n\t) {\n\t\tif (oModifier.targets === \"jsControlTree\") {\n\t\t\tthis._setDraftIndicatorOnVisibleColumn(oTable as Table, aColumns, oColumnInfo);\n\t\t}\n\t},\n\t_getGroupId: function (sRetrievedGroupId: string) {\n\t\treturn sRetrievedGroupId || undefined;\n\t},\n\t_insertAggregation: async function (\n\t\toValueHelp: Element | UI5Element | Element[] | UI5Element[],\n\t\toModifier: BaseTreeModifier,\n\t\toTable: Element | UI5Element\n\t): Promise<void> {\n\t\tif (oValueHelp) {\n\t\t\treturn oModifier.insertAggregation(oTable, \"dependents\", oValueHelp, 0);\n\t\t}\n\t\treturn;\n\t},\n\n\t/**\n\t * Invoked when a column is added using the table personalization dialog.\n\t * @param oTable Instance of table control\n\t * @param sPropertyInfoName Name of the property for which the column is added\n\t * @param mPropertyBag Instance of property bag from the flexibility API\n\t * @param mPropertyBag.modifier Instance of the control tree modifier\n\t * @param mPropertyBag.appComponent Instance of the app component\n\t * @param mPropertyBag.view Instance of the view\n\t * @returns Once resolved, a table column definition is returned\n\t */\n\taddItem: async function (\n\t\ttable: Element | UI5Element,\n\t\tpropertyInfoName: string,\n\t\tmPropertyBag: { modifier: BaseTreeModifier; appComponent: AppComponent; view?: FEView }\n\t) {\n\t\tconst oMetaModel = this._getMetaModel(mPropertyBag),\n\t\t\toModifier = mPropertyBag.modifier,\n\t\t\tsTableId = oModifier.getId(table),\n\t\t\taColumns = (table as UI5Element).isA ? this.getColumnsFor(table as Table) : null;\n\t\tif (!aColumns) {\n\t\t\t// We return null here because everything should apply at runtime\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\tconst columnInfo = aColumns.find(function (oColumn) {\n\t\t\treturn oColumn.name === propertyInfoName;\n\t\t});\n\t\tif (!columnInfo) {\n\t\t\tLog.error(`${propertyInfoName} not found while adding column`);\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\t\tif (columnInfo.availability === \"Hidden\") {\n\t\t\tLog.warning(`Column for ${propertyInfoName} not added because it's hidden`);\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\t\tconst internalBindingContext = (table as Table).getBindingContext(\"internal\");\n\t\tinternalBindingContext?.setProperty(COLUMN_HAS_BEEN_ADDED, true);\n\t\tthis._setDraftIndicatorStatus(oModifier, table, aColumns, columnInfo);\n\t\tconst sPath = await DelegateUtil.getCustomDataWithModifier<string>(table, \"metaPath\", oModifier);\n\t\tconst oTableContext: Context = oMetaModel.createBindingContext(sPath!)!;\n\t\t// If view is not provided try to get it by accessing to the parental hierarchy\n\t\t// If it doesn't work (table into an unattached OP section) get the view via the AppComponent\n\t\tconst view =\n\t\t\tmPropertyBag.view ||\n\t\t\tCommonUtils.getTargetView(table as UI5Element) ||\n\t\t\t(mPropertyBag.appComponent ? CommonUtils.getCurrentPageView(mPropertyBag.appComponent) : undefined);\n\n\t\tif (columnInfo.type === \"Default\") {\n\t\t\tLog.error(\"Custom columns defined in the manifest are not supported when using a table building block.\");\n\t\t\tthrow new Error(\"Custom columns defined in the manifest are not supported when using a table building block.\");\n\t\t}\n\n\t\tif (columnInfo.type === \"Slot\") {\n\t\t\treturn this._templateSlotColumnFragment(columnInfo as CustomElement<CustomBasedTableColumn>, view, oModifier, sTableId);\n\t\t}\n\n\t\tif (columnInfo.type === \"Computed\") {\n\t\t\tconst enableAnalytics = ((table as MDCTable).getParent() as TableAPI).getTableDefinition().enableAnalytics;\n\t\t\treturn getComputedColumn(sTableId, columnInfo as ComputedTableColumn, oTableContext, enableAnalytics);\n\t\t}\n\n\t\t// fall-back\n\t\tif (!oMetaModel) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\tconst propertyInfo = ((table as MDCTable).getParent() as TableAPI).getEnhancedFetchedPropertyInfos().find(function (\n\t\t\tpropInfo: EnhancedFEPropertyInfo\n\t\t) {\n\t\t\treturn propInfo.name === propertyInfoName;\n\t\t});\n\n\t\tconst oPropertyContext: Context = oMetaModel.createBindingContext(propertyInfo!.annotationPath)!;\n\n\t\tconst fnTemplateFragment = async (\n\t\t\toInPropertyInfo: unknown,\n\t\t\toView: FEView\n\t\t): Promise<UI5Element | Element | UI5Element[] | Element[]> => {\n\t\t\tlet bDisplayMode: boolean | undefined;\n\t\t\tlet sTableTypeCustomData: string | undefined;\n\t\t\tlet sCreationModeCustomData: string | undefined;\n\n\t\t\treturn Promise.all([\n\t\t\t\tDelegateUtil.getCustomDataWithModifier<string | boolean>(table, \"displayModePropertyBinding\", oModifier),\n\t\t\t\tDelegateUtil.getCustomDataWithModifier<string>(table, \"tableType\", oModifier),\n\t\t\t\tDelegateUtil.getCustomDataWithModifier<string>(table, \"creationMode\", oModifier)\n\t\t\t]).then(async (aCustomData: (string | boolean | undefined)[]) => {\n\t\t\t\tbDisplayMode = aCustomData[0] as boolean | undefined;\n\t\t\t\tsTableTypeCustomData = aCustomData[1] as string | undefined;\n\t\t\t\tsCreationModeCustomData = aCustomData[2] as string | undefined;\n\t\t\t\t// Read Only and Column Edit Mode can both have three state\n\t\t\t\t// Undefined means that the framework decides what to do\n\t\t\t\t// True / Display means always read only\n\t\t\t\t// False / Editable means editable but while still respecting the low level principle (immutable property will not be editable)\n\t\t\t\tif (bDisplayMode !== undefined && typeof bDisplayMode !== \"boolean\") {\n\t\t\t\t\tbDisplayMode = bDisplayMode === \"true\";\n\t\t\t\t}\n\n\t\t\t\tconst tableAPI = (table as Table).getParent() as TableAPI;\n\t\t\t\tconst oThis = new JSONModel({\n\t\t\t\t\t\tenableAutoColumnWidth: tableAPI.getTableDefinition().control.enableAutoColumnWidth,\n\t\t\t\t\t\treadOnly: bDisplayMode,\n\t\t\t\t\t\ttableType: sTableTypeCustomData,\n\t\t\t\t\t\tid: sTableId,\n\t\t\t\t\t\tnavigationPropertyPath: propertyInfoName,\n\t\t\t\t\t\tcolumnInfo: columnInfo,\n\t\t\t\t\t\tcollection: oMetaModel.createBindingContext(sPath!),\n\t\t\t\t\t\tcreationMode: { name: sCreationModeCustomData },\n\t\t\t\t\t\twidthIncludingColumnHeader: tableAPI.getTableDefinition().control.widthIncludingColumnHeader\n\t\t\t\t\t}),\n\t\t\t\t\toPreprocessorSettings = {\n\t\t\t\t\t\tbindingContexts: {\n\t\t\t\t\t\t\tentitySet: oTableContext,\n\t\t\t\t\t\t\tcollection: oTableContext,\n\t\t\t\t\t\t\tdataField: oPropertyContext,\n\t\t\t\t\t\t\tthis: oThis.createBindingContext(\"/\"),\n\t\t\t\t\t\t\tcolumn: oThis.createBindingContext(\"/columnInfo\")\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmodels: {\n\t\t\t\t\t\t\tthis: oThis,\n\t\t\t\t\t\t\tentitySet: oMetaModel,\n\t\t\t\t\t\t\tcollection: oMetaModel,\n\t\t\t\t\t\t\tdataField: oMetaModel,\n\t\t\t\t\t\t\tmetaModel: oMetaModel,\n\t\t\t\t\t\t\tcolumn: oThis\n\t\t\t\t\t\t},\n\t\t\t\t\t\tappComponent: mPropertyBag.appComponent\n\t\t\t\t\t};\n\n\t\t\t\tconst tableCollection = getInvolvedDataModelObjects<EntitySet | NavigationProperty>(\n\t\t\t\t\toMetaModel.createBindingContext(tableAPI.tableDefinition.annotation.collection)!\n\t\t\t\t);\n\t\t\t\tconst handlerProvider = new TableEventHandlerProvider(\n\t\t\t\t\ttableAPI,\n\t\t\t\t\t{ collectionEntity: tableCollection.targetObject!, metaModel: oMetaModel },\n\t\t\t\t\ttableAPI\n\t\t\t\t);\n\t\t\t\tconst computedColumnXML = new DOMParser().parseFromString(\n\t\t\t\t\tjsx.renderAsXML(() => {\n\t\t\t\t\t\treturn (getColumnTemplate(\n\t\t\t\t\t\t\tsTableId,\n\t\t\t\t\t\t\ttableAPI,\n\t\t\t\t\t\t\tcolumnInfo as AnnotationTableColumn,\n\t\t\t\t\t\t\toMetaModel.createBindingContext(sPath!)!,\n\t\t\t\t\t\t\thandlerProvider\n\t\t\t\t\t\t) ?? \"\") as unknown as string;\n\t\t\t\t\t}),\n\t\t\t\t\t\"text/xml\"\n\t\t\t\t);\n\t\t\t\treturn DelegateUtil.templateControlFragment(\n\t\t\t\t\tcomputedColumnXML.firstElementChild,\n\t\t\t\t\toPreprocessorSettings,\n\t\t\t\t\t{ view: oView },\n\t\t\t\t\toModifier\n\t\t\t\t).finally(function () {\n\t\t\t\t\toThis.destroy();\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\treturn fnTemplateFragment(propertyInfo, view);\n\t},\n\n\t/**\n\t * Provide the Table's filter delegate to provide basic filter functionality such as adding FilterFields.\n\t * @returns Object for the Tables filter personalization.\n\t */\n\tgetFilterDelegate: function () {\n\t\treturn Object.assign(\n\t\t\t{\n\t\t\t\tapiVersion: 2\n\t\t\t},\n\t\t\tFilterBarDelegate,\n\t\t\t{\n\t\t\t\taddItem: async function (oParentControl: Control, sPropertyInfoName: string) {\n\t\t\t\t\tif (sPropertyInfoName.indexOf(\"Property::\") === 0) {\n\t\t\t\t\t\t// Correct the name of complex property info references.\n\t\t\t\t\t\tsPropertyInfoName = sPropertyInfoName.replace(\"Property::\", \"\");\n\t\t\t\t\t}\n\t\t\t\t\treturn FilterBarDelegate.addItem(oParentControl as FilterBar, sPropertyInfoName);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t},\n\n\t/**\n\t * Returns the TypeMap attached to this delegate.\n\t * @returns Any instance of TypeMap\n\t */\n\tgetTypeMap: function (/*oPayload: object*/) {\n\t\treturn TypeMap;\n\t},\n\n\t/**\n\t * Format the title of the group header .\n\t * @param table Instance of table control\n\t * @param context Context\n\t * @param property Name of the property\n\t * @returns Formatted title of the group header.\n\t */\n\tformatGroupHeader(table: MDCTable, context: ODataV4Context, property: string) {\n\t\tconst propertyInfos = (table.getParent() as TableAPI).getEnhancedFetchedPropertyInfos();\n\t\tconst propertyInfo = propertyInfos?.find((obj) => {\n\t\t\treturn obj.name === property;\n\t\t});\n\t\t/*For a Date, DateTime, Boolean or Decimal property, the value is returned in external format using a UI5 type for the\n\t        given property path that formats corresponding to the property's EDM type and constraints*/\n\t\tconst dataBaseType = TypeMap.getTypeConfig(propertyInfo?.dataType).baseType;\n\t\tconst externalFormat =\n\t\t\tdataBaseType === \"DateTime\" || dataBaseType === \"Date\" || dataBaseType === \"Boolean\" || dataBaseType === \"Numeric\";\n\t\tlet value;\n\t\tif (!context) {\n\t\t\tvalue = getResourceModel(CommonUtils.getTargetView(table)).getText(\"M_TABLE_GROUP_HEADER_TITLE_VALUE\");\n\t\t\treturn getResourceModel(table).getText(\"M_TABLE_GROUP_HEADER_TITLE\", [propertyInfo?.label, value]);\n\t\t}\n\t\tif (propertyInfo?.mode) {\n\t\t\tswitch (propertyInfo.mode) {\n\t\t\t\tcase \"Description\":\n\t\t\t\t\tvalue = propertyInfo.descriptionProperty ? context.getProperty(propertyInfo.descriptionProperty, externalFormat) : null;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"DescriptionValue\":\n\t\t\t\t\tvalue = ValueFormatter.formatWithBrackets(\n\t\t\t\t\t\tpropertyInfo.descriptionProperty ? context.getProperty(propertyInfo.descriptionProperty, externalFormat) : null,\n\t\t\t\t\t\tpropertyInfo.valueProperty ? context.getProperty(propertyInfo.valueProperty, externalFormat) : null\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ValueDescription\":\n\t\t\t\t\tvalue = ValueFormatter.formatWithBrackets(\n\t\t\t\t\t\tpropertyInfo.valueProperty ? context.getProperty(propertyInfo.valueProperty, externalFormat) : null,\n\t\t\t\t\t\tpropertyInfo.descriptionProperty ? context.getProperty(propertyInfo.descriptionProperty, externalFormat) : null\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tvalue = propertyInfo?.path ? context.getProperty(propertyInfo.path, externalFormat) : null;\n\t\t}\n\t\tif (value === null || value === \"\") {\n\t\t\tvalue = getResourceModel(CommonUtils.getTargetView(table)).getText(\"M_TABLE_GROUP_HEADER_TITLE_VALUE\");\n\t\t}\n\t\treturn getResourceModel(table).getText(\"M_TABLE_GROUP_HEADER_TITLE\", [propertyInfo?.label, value]);\n\t}\n});\n"],"mappings":"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","ignoreList":[]}