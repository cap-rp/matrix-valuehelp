/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/controls/CommandExecution","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/MetaModelConverter","sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/FPMHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/library","sap/fe/core/templating/CriticalityFormatters","sap/fe/macros/messages/MessageButton","sap/m/Button","sap/m/DraftIndicator","sap/m/Menu","sap/m/MenuButton","sap/m/MenuItem","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/core/InvisibleText","sap/fe/base/HookSupport","sap/fe/templates/ObjectPage/ObjectPageTemplating","sap/m/OverflowToolbarLayoutData","sap/ui/model/json/JSONModel","sap/fe/base/jsx-runtime/jsx","sap/fe/base/jsx-runtime/jsxs"],function(e,t,n,i,a,o,r,s,l,c,d,u,p,f,g,h,b,m,_,C,v,E,A,w,y,O,D,x,M){"use strict";var I,B,P,T,S,N,V,j,R,F,z,G,H,L,J,k;var U={};var q=w.controllerExtensionHandler;var W=c.UI;var $=c.Draft;var X=l.aiIcon;var Y=s.isActionWithDialog;var K=r.getInvolvedDataModelObjects;var Q=o.ActionType;var Z=n.property;var ee=n.implementInterface;var te=n.defineUI5Class;var ne=n.defineReference;var ie=t.pathInModel;var ae=t.or;var oe=t.ifElse;var re=t.equal;var se=t.constant;var le=t.compileExpression;var ce=t.and;function de(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function ue(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,pe(e,t)}function pe(e,t){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pe(e,t)}function fe(e,t,n,i,a){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,i){return i(e,t,n)||n},o),a&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(a):void 0,o.initializer=void 0),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}function ge(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let he=(I=te("sap.fe.macros.FooterContent"),B=ee("sap.ui.core.Toolbar"),P=ee("sap.m.IBar"),T=Z({type:"string",required:true}),S=Z({type:"string",required:true}),N=Z({type:"string"}),V=ne(),j=q("routing","onAfterBinding"),I(R=(F=function(t){function n(e,n){var i;i=t.call(this,e,n)||this;de(i,"__implements__sap_ui_core_Toolbar",z,i);de(i,"__implements__sap_m_IBar",G,i);de(i,"id",H,i);de(i,"metaPath",L,i);de(i,"contextPath",J,i);de(i,"cmdExecution",k,i);i._hideCreateNext=false;return i}U=n;ue(n,t);var i=n.prototype;i.onAfterBinding=async function e(){if(this._hiddenDraft){const e=this._getOwner()?.getRootController();const t=e.getView().getBindingContext();const n=await e.editFlow.isRootContextNew(t);this.getModel("footerInternal").setProperty("/rootIsNewObject",n)}};i.initialize=function e(){const t=this._getOwner();this.setModel(new D,"footerInternal");this.actions=t?.preprocessorContext?.bindingContexts?.converterContext?.getObject("footerActions");const n=t?.preprocessorContext?.fullContextPath;this.oDataMetaModel=t?.preprocessorContext?.models.metaModel;this.dataViewModelPath=this.getDataModelObjectForMetaPath(this.metaPath,n??this.contextPath);const i=this.dataViewModelPath.startingEntitySet;this.isDraftValidation=!!(u.getDraftRoot(i)?.PreparationAction&&i?.entityType.annotations.Common?.Messages);this.content=this.createContent()};i.onMetadataAvailable=function e(){const t=this._getOwner()?.getRootController();this._hiddenDraft=t.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.enabled;this._hideCreateNext=t.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.hideCreateNext===true;if(!this.content){this.initialize()}};i.getActionModelPath=function e(t){const n=t.annotationPath;if(n){const e=this.oDataMetaModel.getContext(n);return K(e)}return undefined};i.getDraftIndicator=function e(){const t=this.dataViewModelPath.targetEntitySet||this.dataViewModelPath.startingEntitySet;const n=t.annotations?.Common;if((n?.DraftRoot||n?.DraftNode)&&!this._hiddenDraft){return x(b,{state:"{ui>/draftStatus}",visible:"{ui>/isEditable}"})}return undefined};i.getApplyButton=function e(t){const n=this._getOwner()?.getRootController();const i=n.getView().getViewData();if(i?.viewLevel!=null&&i?.viewLevel<=1||this._hiddenDraft){return null}if(this.isDraftValidation&&!i.isDesktop&&!i.fclEnabled){return x(_,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_APPLY_DRAFT}",defaultAction:async()=>{await n._applyDocument(n.getView().getBindingContext())},useDefaultActionOnly:"true",buttonMode:"Split",type:t,"dt:designtime":"not-adaptable",children:x(m,{children:x(C,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_VALIDATE_DRAFT}",press:async()=>{await n._validateDocument()}})})})}return x(h,{id:this.createId("StandardAction::Apply"),text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_APPLY_DRAFT}",type:t,enabled:true,press:async()=>{await n._applyDocument(n.getView().getBindingContext())},visible:"{ui>/isEditable}","dt:designtime":"not-adaptable"})};i.getPrimary=function e(t){const n=this._getOwner()?.getRootController();const i=n.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.enabled;const o=n.getView().getViewData();n.getView().addDependent(x(a,{ref:this.cmdExecution,command:"Save",execute:n._saveDocument,visible:ae(oe(i===true,oe(o.fclEnabled===true,ce(W.IsEditable,re(ie("/showSaveAndCancelButton","fclhelper"),true)),W.IsEditable),W.IsEditable),re(ie("/isInlineEditActive","ui"),true))}));if(this.isDraftValidation&&!o.isDesktop){return x(_,{text:this.getTextSaveButton(),"jsx:command":"cmd:Save|defaultAction",useDefaultActionOnly:"true",buttonMode:"Split",type:t,visible:le(oe(i===true,oe(o.fclEnabled===true,ce(W.IsEditable,re(ie("/showSaveAndCancelButton","fclhelper"),true)),W.IsEditable),W.IsEditable)),"dt:designtime":"not-adaptable",children:x(m,{children:x(C,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_VALIDATE_DRAFT}",press:async()=>{await n._validateDocument()}})})})}return x(h,{id:this.createId("StandardAction::Save"),text:this.getTextSaveButton(),type:t,visible:le(oe(i===true,oe(o.fclEnabled===true,ce(W.IsEditable,re(ie("/showSaveAndCancelButton","fclhelper"),true)),W.IsEditable),W.IsEditable)),enabled:true,"jsx:command":"cmd:Save|press","dt:designtime":"not-adaptable"})};i.getTextSaveButton=function e(){const t=this.getTranslatedText("T_OP_OBJECT_PAGE_SAVE");const n=this.getTranslatedText("T_OP_OBJECT_PAGE_CREATE");return oe(oe(this.dataViewModelPath.startingEntitySet.annotations.Session?.StickySessionSupported!==undefined,W.IsCreateMode,oe(this._hiddenDraft,ce(ie("/rootIsNewObject","footerInternal")),$.IsNewObject)),n,t)};i.getCancelButton=function e(){const t=this._getOwner()?.getRootController();const n=t.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.enabled;const i=t.getView().getViewData();t.getView().addDependent(x(a,{ref:this.cmdExecution,command:"Cancel",execute:()=>{t._cancelDocument({cancelButton:"fe::FooterBar::StandardAction::Cancel"})},visible:oe(n===true,oe(i.fclEnabled===true,ce(W.IsEditable,re(ie("/showSaveAndCancelButton","fclhelper"),true)),W.IsEditable),W.IsEditable)}));return x(h,{id:this.createId("StandardAction::Cancel"),text:u.isDraftRoot(this.dataViewModelPath.targetEntitySet)&&!this._hiddenDraft?"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_DISCARD_DRAFT}":"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_CANCEL}","jsx:command":"cmd:Cancel|press",visible:le(oe(n===true,oe(i.fclEnabled===true,ce(W.IsEditable,re(ie("/showSaveAndCancelButton","fclhelper"),true)),W.IsEditable),W.IsEditable)),ariaHasPopup:oe(ie("/isDocumentModified","ui"),se("Dialog"),se("None")),enabled:true,"dt:designtime":"not-adaptable",children:{layoutData:x(O,{closeOverflowOnInteraction:false})}})};i.getCreateNextButton=function e(t){const n=this._getOwner()?.getRootController();const i=n.getView().getViewData();return x(h,{id:this.createId("StandardAction::CreateNext"),text:"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_CREATE_NEXT}",press:n.editFlow.createNextDocument,type:t,visible:oe(this._hiddenDraft===true,oe(i.fclEnabled===true,ce($.IsNewObject,re(ie("/showSaveAndCancelButton","fclhelper"),true)),$.IsNewObject),$.IsNewObject),enabled:true,"dt:designtime":"not-adaptable",children:{layoutData:x(O,{closeOverflowOnInteraction:false})}})};i.getDataFieldForActionButton=function e(t){if(t.annotationPath){const e=this._getOwner()?.getRootController();const n=t.annotationPath;let i;const a=e.getView();const o=this.oDataMetaModel.getContext(n);const r=K(o);const s=r.targetObject;if(s){const n={entitySetName:this.dataViewModelPath.targetEntitySet?.name,invocationGrouping:s.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?p.InvocationGrouping.ChangeSet:p.InvocationGrouping.Isolated,label:s.Label?.toString(),isNavigable:t.isNavigable,defaultValuesExtensionFunction:t.defaultValuesExtensionFunction};if(!t.command){i={press:()=>{e.handlers.onCallAction(a,s.Action,{...n,...{contexts:a.getBindingContext(),model:a.getModel()}})}}}else{if(!t.command.startsWith("cmd:")){t.command=`cmd:${t.command}`}i={"jsx:command":`${t.command}|press`}}return x(h,{id:this.createId(this.getActionModelPath(t)),"dt:designtime":t.visible==="true"||t.visible==="false"?undefined:"not-adaptable-visibility",text:n.label,...i,ariaHasPopup:Y(r.targetObject),visible:t.visible,enabled:t.enabled,type:f.buildExpressionForCriticalityButtonType(r),icon:t?.isAIOperation===true?X:undefined})}}};i.getManifestButton=function t(n){if(y.isManifestAction(n)){let t;if(n.command){t={"jsx:command":`cmd:${n.command}|press`}}else{t={press:t=>{d.actionWrapper(t,n.handlerModule,n.handlerMethod,{}).catch(t=>e.error(t))}}}return x(h,{id:this.createId(n.id),"dt:designtime":n.visible==="true"||n.visible==="false"?undefined:"not-adaptable-visibility",text:n.text??"",...t,type:"Transparent",visible:n.visible,enabled:n.enabled,icon:n?.isAIOperation===true?X:undefined})}};i.getActionControls=function e(){const t=y.buildEmphasizedButtonExpression(this.dataViewModelPath);return this.actions?.map(e=>{switch(e.type){case Q.DefaultApply:return this.getApplyButton(t);case Q.DataFieldForAction:return this.getDataFieldForActionButton(e);case Q.Primary:if(this._hiddenDraft&&!this._hideCreateNext){return this.getPrimary(le(oe($.IsNewObject,undefined,t)))}return this.getPrimary(t);case Q.Secondary:return this.getCancelButton();case Q.CreateNext:if(this._hiddenDraft&&!this._hideCreateNext){return this.getCreateNextButton(le(oe($.IsNewObject,t,undefined)))}return;default:return this.getManifestButton(e)}}).filter(e=>!!e)};i.createContent=function e(){const t=this._getOwner()?.getRootController();const n=t.getView().getViewData();const i=x(g,{id:this.createId("MessageButton"),visible:le(oe(this._hiddenDraft===true,oe(n.fclEnabled===true,ce(W.IsEditable,re(ie("/showSaveAndCancelButton","fclhelper"),true)),true),true)),messageChange:()=>t._getFooterVisibility(),ariaLabelledBy:[this.createId("MessageButton::AriaText")],type:"Emphasized",ariaHasPopup:"Dialog"});const o=M(v,{id:this.createId("_fc"),asyncMode:true,children:[x(A,{id:this.createId("MessageButton::AriaText"),text:"{sap.fe.i18n>C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_BUTTON_ARIA_TEXT}"}),i,x(E,{}),this.getDraftIndicator(),this.getActionControls()]});t.getView().addDependent(x(a,{ref:this.cmdExecution,command:"OpenMessageButtonMenu",execute:()=>i.firePress()}));return o};return n}(i),z=fe(F.prototype,"__implements__sap_ui_core_Toolbar",[B],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),G=fe(F.prototype,"__implements__sap_m_IBar",[P],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),H=fe(F.prototype,"id",[T],{configurable:true,enumerable:true,writable:true,initializer:null}),L=fe(F.prototype,"metaPath",[S],{configurable:true,enumerable:true,writable:true,initializer:null}),J=fe(F.prototype,"contextPath",[N],{configurable:true,enumerable:true,writable:true,initializer:null}),k=fe(F.prototype,"cmdExecution",[V],{configurable:true,enumerable:true,writable:true,initializer:null}),fe(F.prototype,"onAfterBinding",[j],Object.getOwnPropertyDescriptor(F.prototype,"onAfterBinding"),F.prototype),F))||R);U=he;return U},false);
//# sourceMappingURL=FooterContent.js.map