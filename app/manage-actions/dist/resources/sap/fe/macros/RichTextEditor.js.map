{"version":3,"file":"RichTextEditor.js","names":["RichTextEditorBlock","_dec","defineUI5Class","_dec2","property","type","required","_dec3","isBindingInfo","_dec4","_dec5","aggregation","multiple","defaultClass","ButtonGroup","_dec6","PluginDefinition","_dec7","_dec8","bindable","_dec9","_class","_class2","_BuildingBlock","properties","others","_this","_isInEditMode","compileExpression","UI","IsEditable","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_descriptor7","_descriptor8","getPlugins","pluginsArray","excludeDefaultPlugins","map","name","plugins","length","plugin","push","getButtonGroups","buttonGroups","buttonGroup","visible","priority","row","customToolbarPriority","buttons","split","getEditContent","_editContent","destroy","_jsx","RichTextEditor","id","createId","value","customToolbar","editable","editorType","showGroupFontStyle","showGroupTextAlign","showGroupStructure","showGroupFont","showGroupClipboard","showGroupInsert","showGroupLink","showGroupUndo","sanitizeValue","wrapping","width","undefined","attachReady","addButtonGroups","_exports","_inheritsLoose","_proto","prototype","onMetadataAvailable","_ownerComponent","content","createContent","createContentDebounced","_contentTimer","clearTimeout","setTimeout","exit","_displayContent","set_isInEditMode","inEditMode","setProperty","setReadOnly","readOnly","lateButtonGroups","reverse","lateButtonGroup","addButtonGroup","detachReady","getDisplayContent","FormattedText","htmlText","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./RichTextEditor.tsx"],"sourcesContent":["import { compileExpression } from \"sap/fe/base/BindingToolkit\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { aggregation, defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport { UI } from \"sap/fe/core/helpers/BindingHelper\";\nimport ButtonGroup from \"sap/fe/macros/richtexteditor/ButtonGroup\";\nimport PluginDefinition from \"sap/fe/macros/richtexteditor/Plugin\";\nimport FormattedText from \"sap/m/FormattedText\";\nimport type { PropertyBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\n// eslint-disable-next-line @typescript-eslint/no-restricted-imports\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport RichTextEditor from \"sap/ui/richtexteditor/RichTextEditor\";\n\ntype PluginDefinitionData = {\n\tname: string;\n};\ntype ButtonGroupData = {\n\tname: string;\n\tvisible: boolean;\n\tpriority?: number;\n\trow?: number;\n\tcustomToolbarPriority?: number;\n\tbuttons: string[];\n};\n\n/**\n * Building block that exposes the RichTextEditor UI5 control.\n *\n * It's used to enter formatted text, and uses the third-party component called TinyMCE.\n * @public\n * @since 1.117.0\n */\n@defineUI5Class(\"sap.fe.macros.RichTextEditor\")\nexport default class RichTextEditorBlock extends BuildingBlock<Control> {\n\t/**\n\t * ID of the editor\n\t */\n\t@property({ type: \"string\", required: true })\n\tid!: string;\n\n\t/**\n\t * The value contained in the editor. You can use this attribute to set a default value.\n\t * @public\n\t */\n\t@property({ type: \"any\", isBindingInfo: true })\n\tvalue?: PropertyBindingInfo;\n\n\t/**\n\t * Use the readOnly attribute to override the edit flow of the page.\n\t * By setting 'readOnly' to true, a FormattedText will be displayed instead of the editor.\n\t * @public\n\t */\n\t@property({ type: \"boolean\" })\n\treadOnly: PropertyBindingInfo = false;\n\n\t/**\n\t * With the 'buttonGroups' attribute you can customize the buttons that are displayed on the toolbar of the editor.\n\t * @public\n\t */\n\t@aggregation({ type: \"sap.fe.macros.richtexteditor.ButtonGroup\", multiple: true, defaultClass: ButtonGroup })\n\tbuttonGroups: ButtonGroup[] = [];\n\n\t/**\n\t * With the 'plugins' attribute you can customize the plugins that will be loaded by the editor.\n\t * @public\n\t */\n\t@aggregation({ type: \"sap.fe.macros.richtexteditor.Plugin\", multiple: true, defaultClass: PluginDefinition })\n\tplugins?: PluginDefinition[];\n\n\t/**\n\t * With the 'excludeDefaultPlugins' you can ask to remove the plugins that will be added by default\n\t * The default plugins are \"emoticons\" \"directionality\" \"image\" \"table\" \"link\" \"powerpaste\".\n\t * @public\n\t */\n\t@property({ type: \"boolean\" })\n\texcludeDefaultPlugins = false;\n\n\t/**\n\t * Use the 'required' attribute to make sure that the editor is filled with some text.\n\t * @public\n\t */\n\t@property({ type: \"any\", bindable: false })\n\trequired: PropertyBindingInfo = false;\n\n\t@property({ type: \"boolean\" })\n\t_isInEditMode: PropertyBindingInfo = false;\n\n\tprivate _displayContent?: FormattedText;\n\n\tprivate _editContent?: RichTextEditor;\n\n\tprivate _contentTimer?: number;\n\n\tconstructor(properties: $ControlSettings & PropertiesOf<RichTextEditorBlock>, others?: $ControlSettings) {\n\t\tproperties._isInEditMode = compileExpression(UI.IsEditable);\n\t\tsuper(properties, others);\n\t}\n\n\tonMetadataAvailable(_ownerComponent: TemplateComponent): void {\n\t\tsuper.onMetadataAvailable(_ownerComponent);\n\t\tthis.content = this.createContent();\n\t}\n\n\tcreateContentDebounced(): void {\n\t\tif (this._contentTimer) {\n\t\t\tclearTimeout(this._contentTimer);\n\t\t}\n\t\tthis._contentTimer = setTimeout(() => {\n\t\t\tthis.content = this.createContent();\n\t\t}, 200) as unknown as number;\n\t}\n\n\texit(): void {\n\t\tthis._displayContent?.destroy();\n\t\tthis._editContent?.destroy();\n\t}\n\n\t/**\n\t * Method that returns the button customizations for the editor toolbar.\n\t * Because all values come as strings from XML, some parsing needs to be done to get attributes with the correct type.\n\t * @returns The button groups.\n\t */\n\tgetPlugins = (): { plugins?: PluginDefinitionData[] } => {\n\t\tlet pluginsArray: PluginDefinitionData[] | undefined;\n\t\tif (this.excludeDefaultPlugins) {\n\t\t\tpluginsArray = [];\n\t\t} else {\n\t\t\tpluginsArray = [\"emoticons\", \"directionality\", \"image\", \"table\", \"link\", \"powerpaste\"].map((name: string) => {\n\t\t\t\treturn { name: name };\n\t\t\t});\n\t\t}\n\t\tif (this.plugins?.length) {\n\t\t\tfor (const plugin of this.plugins) {\n\t\t\t\tpluginsArray.push(plugin);\n\t\t\t}\n\t\t}\n\t\treturn { plugins: pluginsArray };\n\t};\n\n\t/**\n\t * Method that returns the button customizations for the editor toolbar.\n\t * Because all values come as strings from XML, some parsing needs to be done to get attributes with the correct type.\n\t * @returns The button groups.\n\t */\n\tgetButtonGroups = (): ButtonGroupData[] => {\n\t\tif (this.buttonGroups && this.buttonGroups.length > 0) {\n\t\t\treturn this.buttonGroups.map((buttonGroup: ButtonGroup) => ({\n\t\t\t\tname: buttonGroup.name ?? \"\",\n\t\t\t\tvisible: buttonGroup.visible === \"true\",\n\t\t\t\tpriority: buttonGroup.priority,\n\t\t\t\trow: buttonGroup.row,\n\t\t\t\tcustomToolbarPriority: buttonGroup.customToolbarPriority,\n\t\t\t\tbuttons: buttonGroup.buttons?.split(\",\") || []\n\t\t\t}));\n\t\t}\n\t\treturn [];\n\t};\n\n\tset_isInEditMode(inEditMode: boolean): void {\n\t\tsuper.setProperty(\"_isInEditMode\", inEditMode);\n\t\tthis.createContentDebounced();\n\t}\n\n\tsetReadOnly(readOnly: boolean): void {\n\t\tsuper.setProperty(\"readOnly\", readOnly);\n\t\tthis.createContentDebounced();\n\t}\n\n\tgetEditContent = (): RichTextEditor => {\n\t\tif (this._editContent) {\n\t\t\t// It's better to destroy the rich text editor as in some case with slow machine switching between edit and display may break it\n\t\t\tthis._editContent.destroy();\n\t\t}\n\n\t\tthis._editContent = (\n\t\t\t<RichTextEditor\n\t\t\t\tid={this.createId(\"_rte\")}\n\t\t\t\tvalue={this.value}\n\t\t\t\tvisible={true}\n\t\t\t\tcustomToolbar={true}\n\t\t\t\teditable={true}\n\t\t\t\teditorType=\"TinyMCE6\"\n\t\t\t\tshowGroupFontStyle={true}\n\t\t\t\tshowGroupTextAlign={true}\n\t\t\t\tshowGroupStructure={true}\n\t\t\t\tshowGroupFont={false}\n\t\t\t\tshowGroupClipboard={true}\n\t\t\t\tshowGroupInsert={false}\n\t\t\t\tshowGroupLink={false}\n\t\t\t\tshowGroupUndo={false}\n\t\t\t\tsanitizeValue={true}\n\t\t\t\twrapping={true}\n\t\t\t\twidth={\"100%\"}\n\t\t\t\trequired={this.required}\n\t\t\t\t{...this.getPlugins()}\n\t\t\t\tbuttonGroups={this.buttonGroups.length > 0 ? [] : undefined}\n\t\t\t/>\n\t\t) as RichTextEditor;\n\n\t\tthis._editContent.attachReady(this.addButtonGroups, this);\n\t\treturn this._editContent;\n\t};\n\n\t/**\n\t * Buttons groups need to be added when the RTE is ready, otherwise some of them are not available.\n\t */\n\taddButtonGroups(): void {\n\t\tconst lateButtonGroups = this.getButtonGroups().reverse();\n\t\t// They also somehow need to be added in reverse because they also get added in the first place :D\n\t\tfor (const lateButtonGroup of lateButtonGroups) {\n\t\t\tthis._editContent?.addButtonGroup(lateButtonGroup);\n\t\t}\n\t\tthis._editContent?.detachReady(this.addButtonGroups, this);\n\t}\n\n\tgetDisplayContent(): FormattedText {\n\t\tif (this._displayContent) {\n\t\t\tthis._displayContent.destroy();\n\t\t}\n\t\tthis._displayContent = (<FormattedText htmlText={this.value} />) as FormattedText;\n\t\treturn this._displayContent;\n\t}\n\n\tcreateContent(): RichTextEditor | FormattedText {\n\t\tif (this._isInEditMode && !this.readOnly) {\n\t\t\treturn this.getEditContent();\n\t\t} else {\n\t\t\treturn this.getDisplayContent();\n\t\t}\n\t}\n}\n"],"mappings":";;;;o8CA2BA,IAQqBA,GAAmBC,EADvCC,EAAe,gCAA+BC,EAK7CC,EAAS,CAAEC,KAAM,SAAUC,SAAU,OAAOC,EAO5CH,EAAS,CAAEC,KAAM,MAAOG,cAAe,OAAOC,EAQ9CL,EAAS,CAAEC,KAAM,YAAYK,EAO7BC,EAAY,CAAEN,KAAM,2CAA4CO,SAAU,KAAMC,aAAcC,IAAcC,EAO5GJ,EAAY,CAAEN,KAAM,sCAAuCO,SAAU,KAAMC,aAAcG,IAAmBC,EAQ5Gb,EAAS,CAAEC,KAAM,YAAYa,EAO7Bd,EAAS,CAAEC,KAAM,MAAOc,SAAU,QAAQC,EAG1ChB,EAAS,CAAEC,KAAM,YAAYJ,EAAAoB,GAAAC,EAAA,SAAAC,GAS9B,SAAAvB,EAAYwB,EAAkEC,GAA2B,IAAAC,EACxGF,EAAWG,cAAgBC,EAAkBC,EAAGC,YAChDJ,EAAAH,EAAAQ,KAAAC,KAAMR,EAAYC,IAAOO,KA7D1BC,EAAAP,EAAA,KAAAQ,EAAAR,GAMAO,EAAAP,EAAA,QAAAS,EAAAT,GAOAO,EAAAP,EAAA,WAAAU,EAAAV,GAQAO,EAAAP,EAAA,eAAAW,EAAAX,GAOAO,EAAAP,EAAA,UAAAY,EAAAZ,GAOAO,EAAAP,EAAA,wBAAAa,EAAAb,GAQAO,EAAAP,EAAA,WAAAc,EAAAd,GAAAO,EAAAP,EAAA,gBAAAe,EAAAf,GAwCAA,EAKAgB,WAAa,KACZ,IAAIC,EACJ,GAAIjB,EAAKkB,sBAAuB,CAC/BD,EAAe,EAChB,KAAO,CACNA,EAAe,CAAC,YAAa,iBAAkB,QAAS,QAAS,OAAQ,cAAcE,IAAKC,IACpF,CAAEA,KAAMA,IAEjB,CACA,GAAIpB,EAAKqB,SAASC,OAAQ,CACzB,IAAK,MAAMC,KAAUvB,EAAKqB,QAAS,CAClCJ,EAAaO,KAAKD,EACnB,CACD,CACA,MAAO,CAAEF,QAASJ,IAGnBjB,EAKAyB,gBAAkB,KACjB,GAAIzB,EAAK0B,cAAgB1B,EAAK0B,aAAaJ,OAAS,EAAG,CACtD,OAAOtB,EAAK0B,aAAaP,IAAKQ,IAAwB,CACrDP,KAAMO,EAAYP,MAAQ,GAC1BQ,QAASD,EAAYC,UAAY,OACjCC,SAAUF,EAAYE,SACtBC,IAAKH,EAAYG,IACjBC,sBAAuBJ,EAAYI,sBACnCC,QAASL,EAAYK,SAASC,MAAM,MAAQ,KAE9C,CACA,MAAO,IACPjC,EAYDkC,eAAiB,KAChB,GAAIlC,EAAKmC,aAAc,CAEtBnC,EAAKmC,aAAaC,SACnB,CAEApC,EAAKmC,aACJE,EAACC,EAAc,CACdC,GAAIvC,EAAKwC,SAAS,QAClBC,MAAOzC,EAAKyC,MACZb,QAAS,KACTc,cAAe,KACfC,SAAU,KACVC,WAAW,WACXC,mBAAoB,KACpBC,mBAAoB,KACpBC,mBAAoB,KACpBC,cAAe,MACfC,mBAAoB,KACpBC,gBAAiB,MACjBC,cAAe,MACfC,cAAe,MACfC,cAAe,KACfC,SAAU,KACVC,MAAO,OACP3E,SAAUoB,EAAKpB,YACXoB,EAAKgB,aACTU,aAAc1B,EAAK0B,aAAaJ,OAAS,EAAI,GAAKkC,YAIpDxD,EAAKmC,aAAasB,YAAYzD,EAAK0D,gBAAe1D,GAClD,OAAOA,EAAKmC,cACZ,OAAAnC,CAzGD,CAAC2D,EAAArF,EAAAsF,EAAAtF,EAAAuB,GAAA,IAAAgE,EAAAvF,EAAAwF,UAAAD,EAEDE,oBAAA,SAAAA,EAAoBC,GACnBnE,EAAAiE,UAAMC,oBAAmB1D,KAAAC,KAAC0D,GAC1B1D,KAAK2D,QAAU3D,KAAK4D,eACrB,EAACL,EAEDM,uBAAA,SAAAA,IACC,GAAI7D,KAAK8D,cAAe,CACvBC,aAAa/D,KAAK8D,cACnB,CACA9D,KAAK8D,cAAgBE,WAAW,KAC/BhE,KAAK2D,QAAU3D,KAAK4D,iBAClB,IACJ,EAACL,EAEDU,KAAA,SAAAA,IACCjE,KAAKkE,iBAAiBpC,UACtB9B,KAAK6B,cAAcC,SACpB,EAACyB,EA2CDY,iBAAA,SAAAA,EAAiBC,GAChB7E,EAAAiE,UAAMa,YAAWtE,KAAAC,KAAC,gBAAiBoE,GACnCpE,KAAK6D,wBACN,EAACN,EAEDe,YAAA,SAAAA,EAAYC,GACXhF,EAAAiE,UAAMa,YAAWtE,KAAAC,KAAC,WAAYuE,GAC9BvE,KAAK6D,wBACN,EAqCAN,EAGAH,gBAAA,SAAAA,IACC,MAAMoB,EAAmBxE,KAAKmB,kBAAkBsD,UAEhD,IAAK,MAAMC,KAAmBF,EAAkB,CAC/CxE,KAAK6B,cAAc8C,eAAeD,EACnC,CACA1E,KAAK6B,cAAc+C,YAAY5E,KAAKoD,gBAAiBpD,KACtD,EAACuD,EAEDsB,kBAAA,SAAAA,IACC,GAAI7E,KAAKkE,gBAAiB,CACzBlE,KAAKkE,gBAAgBpC,SACtB,CACA9B,KAAKkE,gBAAmBnC,EAAC+C,EAAa,CAACC,SAAU/E,KAAKmC,QACtD,OAAOnC,KAAKkE,eACb,EAACX,EAEDK,cAAA,SAAAA,IACC,GAAI5D,KAAKL,gBAAkBK,KAAKuE,SAAU,CACzC,OAAOvE,KAAK4B,gBACb,KAAO,CACN,OAAO5B,KAAK6E,mBACb,CACD,EAAC,OAAA7G,CAAA,CAjJ6B,CAnDkBgH,GAAa9E,EAAA+E,EAAA3F,EAAAkE,UAAA,MAAArF,GAAA,CAAA+G,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAlF,EAAA8E,EAAA3F,EAAAkE,UAAA,SAAAjF,GAAA,CAAA2G,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAjF,EAAA6E,EAAA3F,EAAAkE,UAAA,YAAA/E,GAAA,CAAAyG,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,kBAoB7B,KAAK,IAAAhF,EAAA4E,EAAA3F,EAAAkE,UAAA,gBAAA9E,GAAA,CAAAwG,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,iBAOP,EAAE,IAAA/E,EAAA2E,EAAA3F,EAAAkE,UAAA,WAAAzE,GAAA,CAAAmG,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA9E,EAAA0E,EAAA3F,EAAAkE,UAAA,yBAAAvE,GAAA,CAAAiG,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,kBAeR,KAAK,IAAA7E,EAAAyE,EAAA3F,EAAAkE,UAAA,YAAAtE,GAAA,CAAAgG,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,kBAOG,KAAK,IAAA5E,EAAAwE,EAAA3F,EAAAkE,UAAA,iBAAApE,GAAA,CAAA8F,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,kBAGA,KAAK,IAAA/F,KAAAD,GAAAgE,EAAArF,EAAA,OAAAqF,CAAA","ignoreList":[]}