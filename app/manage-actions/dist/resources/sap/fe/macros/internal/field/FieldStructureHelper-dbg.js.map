{"version":3,"names":["setUpField","field","controlConfiguration","viewDataModel","internalModel","appComponent","isReadOnlyInitial","metaPath","contextPath","resultField","Object","defineProperty","get","value","description","change","visible","vhIdPrefix","_flexId","id","idPrefix","formatOptions","getFormatOptions","showOnlyUnitDecimals","getProperty","valueHelpMetaPath","computeCommonProperties","getModel","convertedMetaPath","setUpDataPointType","setUpVisibleProperties","computeIDs","dataSourcePath","getTargetObjectPath","dataModelPath","computeExternalID","entityType","odataMetaModel","createBindingContext","targetEntityType","fullyQualifiedName","forInlineCreationRows","hasPropertyInsertRestrictions","computeEditMode","computeCollaborationProperties","computeEditableExpressions","setUpFormatOptions","dataModelPathExternalID","setUpDisplayStyle","setUpEditStyle","valueState","setUpValueState","editStyle","editStylePlaceholder","setInputWithValuehelpPlaceholder","computeFileUploaderProperties","computeInlineEditProperties","aDisplayStylesWithoutPropText","displayStyle","includes","targetObject","text","FieldTemplating","getTextBinding","showEmptyIndicator","emptyIndicatorMode","String","undefined","isProperty","annotations","UI","DataFieldDefault","computedEditMode","compileExpression","ifElse","equal","readOnly","eventHandlers","liveChange","validateFieldGroup","handleTypeMissmatch","handleFileSizeExceed","handleUploadComplete","uploadStream","removeStream","handleOpenUploader","handleCloseUploader","openExternalLink","onFocusOut","linkPressed","displayAggregationDetails","onDataFieldWithNavigationPath","showCollaborationEditUser","onDataFieldActionButton","onDataFieldWithIBN","_exports","computedEditableExpression","UIFormatters","getEditableExpressionAsObject","propertyForFieldControl","ModelHelper","isCollaborationDraftSupported","editMode","FieldEditMode","Display","collaborationEnabled","collaborationExpression","getCollaborationExpression","CollaborationFormatters","hasCollaborationActivity","editableExpression","and","not","constant","IsInactive","editModeAsObject","metaModel","MetaModelConverter","convertMetaModelContext","metaPathContext","getInvolvedDataModelObjects","getDataModelObjectPathForValue","property","Value","requiredPropertiesFromInsertRestrictions","getRequiredPropertiesFromInsertRestrictions","contextPathContext","getPath","replaceAll","requiredPropertiesFromUpdateRestrictions","getRequiredPropertiesFromUpdateRestrictions","oRequiredProperties","enabledExpression","getEnabledExpression","requiredExpression","getRequiredExpression","measureReadOnly","measureDisplayMode","getEditMode","externalIDProperty","getAssociatedExternalIdProperty","type","isDataField","$target","externalIdPropertyPath","getAssociatedExternalIdPropertyPath","externalIdContext","convertedMetaPathExternalID","computeFieldGroupIds","typesForCollaborationFocusManagement","sideEffectService","getSideEffectsService","fieldGroupIds","mainPropertyRelativePath","getContextRelativeTargetObjectPath","collaborationFieldGroup","CollaborationFieldGroupPrefix","push","length","_apiId","getContentId","editStyleId","generate","fieldMode","displayStyleId","textAlignMode","displayMode","textLinesEdit","textMaxLines","textMaxCharactersDisplay","textExpandBehaviorDisplay","textMaxLength","fieldEditStyle","radioButtonsHorizontalLayout","showTime","showTimezone","showDate","getObjectIdentifierText","fieldFormatOptions","propertyDataModelObjectPath","propertyBindingExpression","pathInModel","targetDisplayMode","propertyDefinition","isPropertyPathExpression","commonText","Common","Text","formatWithTypeInformation","relativeLocation","getRelativePaths","getExpressionFromAnnotation","formatResult","valueFormatters","formatToKeepWhitespace","getOverrides","props","controlConfig","keys","forEach","configKey","manageQuickViewForDisplayStyle","hasSemanticObjects","hasQuickView","quickViewType","foundSemanticObjects","manageSemanticObjectsForCurrentUser","semanticObject","hasReachableStaticSemanticObject","dynamicSemanticObjects","propertyOrNavigationPropertyHasSemanticObject","getPropertyWithSemanticObject","fieldContainerType","propertyPath","name","recommendationValue","recommendationDescription","placeholderExp","additionalValueFormatter","formatPlaceholder","dataField","dataPointType","term","$Type","getDecimalPadding","manifest","getManifestEntry","Measures","ISOCurrency","macros","table","currency","decimalPadding","unitOfMeasure","hasUnitOrCurrency","Unit","hasValidAnalyticalCurrencyOrUnit","textFromValueList","IsImage","IsImageURL","InputMask","Masked","setUpDraftIndicator","Target","isUsedInNavigationWithQuickViewFacets","isSemanticKey","semanticKeyStyle","setUpObjectIdentifierTitleAndText","showErrorIndicator","contextLocation","_type","fieldGroupDraftIndicatorPropertyPath","situationsIndicatorPropertyPath","Criticality","isCurrencyOrUnitAligned","FieldStructureHelper","valueAsStringBindingExpression","getValueBinding","unitBindingExpression","getBindingForUnitOrCurrency","Communication","IsEmailAddress","IsPhoneNumber","MultiLineText","hasSituationsIndicator","SituationsIndicator","getSituationsNavigationProperty","targetEntitySet","DraftRoot","hasDraftIndicator","draftIndicatorVisible","getDraftIndicatorVisibleBinding","addDraftIndicator","setEditStyleProperties","semanticStyle","identifierTitle","getTitleBindingExpression","getTextBindingExpression","splitTitleOnTwoLines","identifierText","overrideProps","getDisplayMode","retrieveTextFromValueList","isRetrieveTextFromValueListEnabled","hasEntityTextArrangement","TextArrangement","valueStateExp","propertyPathInModel","textPath","formatValueState","getVisibleExpression","displayVisible","macroId","fileRelativePropertyPath","fileNameAnnotation","Core","ContentDisposition","Filename","isPathAnnotationExpression","fileNameDataModelPath","enhanceDataModelPath","path","fileFilenameExpression","inlineEditEnabled","hasInlineEdit","transformRecursively","expr","modelName"],"sourceRoot":".","sources":["FieldStructureHelper.ts"],"sourcesContent":["import type { EntitySet, Property, PropertyPath, ServiceObject } from \"@sap-ux/vocabularies-types\";\nimport type {\n\tDataFieldAbstractTypes,\n\tDataFieldForAnnotation,\n\tDataFieldTypes,\n\tDataPoint,\n\tDataPointTypeTypes\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { UIAnnotationTerms, UIAnnotationTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport type {\n\tBindingToolkitExpression,\n\tCompiledBindingToolkitExpression,\n\tExpressionOrPrimitive,\n\tPathInModelExpression\n} from \"sap/fe/base/BindingToolkit\";\nimport {\n\tand,\n\tcompileExpression,\n\tconstant,\n\tequal,\n\tformatResult,\n\tformatWithTypeInformation,\n\tgetExpressionFromAnnotation,\n\tifElse,\n\tnot,\n\tpathInModel,\n\ttransformRecursively\n} from \"sap/fe/base/BindingToolkit\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type { TemplateProcessorSettings } from \"sap/fe/core/buildingBlocks/templating/BuildingBlockTemplateProcessor\";\nimport { CollaborationFieldGroupPrefix } from \"sap/fe/core/controllerextensions/collaboration/CollaborationCommon\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport { isDataField } from \"sap/fe/core/converters/annotations/DataField\";\nimport * as CollaborationFormatters from \"sap/fe/core/formatters/CollaborationFormatter\";\nimport valueFormatters from \"sap/fe/core/formatters/ValueFormatter\";\nimport { UI } from \"sap/fe/core/helpers/BindingHelper\";\nimport {\n\tgetRequiredPropertiesFromInsertRestrictions,\n\tgetRequiredPropertiesFromUpdateRestrictions\n} from \"sap/fe/core/helpers/MetaModelFunction\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { getTitleBindingExpression } from \"sap/fe/core/helpers/TitleHelper\";\nimport { isPathAnnotationExpression, isProperty, isPropertyPathExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport {\n\tenhanceDataModelPath,\n\tgetContextRelativeTargetObjectPath,\n\tgetRelativePaths,\n\tgetTargetObjectPath\n} from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { getAssociatedExternalIdProperty, getAssociatedExternalIdPropertyPath, isSemanticKey } from \"sap/fe/core/templating/PropertyHelper\";\nimport { getPropertyWithSemanticObject, manageSemanticObjectsForCurrentUser } from \"sap/fe/core/templating/SemanticObjectHelper\";\nimport type { DisplayMode } from \"sap/fe/core/templating/UIFormatters\";\nimport * as UIFormatters from \"sap/fe/core/templating/UIFormatters\";\nimport type { InputMaskFormatOptions } from \"sap/fe/core/type/InputMask\";\nimport * as FieldTemplating from \"sap/fe/macros/field/FieldTemplating\";\nimport {\n\tgetDataModelObjectPathForValue,\n\tgetDraftIndicatorVisibleBinding,\n\tgetTextBindingExpression,\n\tgetValueBinding,\n\tgetVisibleExpression,\n\thasPropertyInsertRestrictions,\n\tisRetrieveTextFromValueListEnabled,\n\tisUsedInNavigationWithQuickViewFacets,\n\tsetEditStyleProperties\n} from \"sap/fe/macros/field/FieldTemplating\";\nimport additionalValueFormatter from \"sap/fe/macros/internal/valuehelp/AdditionalValueFormatter\";\nimport SituationsIndicator from \"sap/fe/macros/situations/SituationsIndicator\";\nimport FieldEditMode from \"sap/ui/mdc/enums/FieldEditMode\";\nimport type Context from \"sap/ui/model/Context\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type { EventHandler } from \"types/extension_types\";\nimport type Field from \"../../Field\";\nimport type FieldFormatOptions from \"../../field/FieldFormatOptions\";\nimport type { DisplayStyle as DisplayStyleType, EditStyle as EditStyleType, FieldProperties } from \"./FieldStyles\";\n\nexport type InputFieldBlockProperties = Omit<PropertiesOf<Field>, \"readOnly\"> & {\n\tisPublicField?: boolean; //\n\t//add events from Field - 'PropertiesOf' does not include them\n\tchange?: EventHandler;\n\tliveChange?: EventHandler;\n\tonLiveChange?: string;\n\treadOnly?: BindingToolkitExpression<boolean>;\n};\nexport type FieldBlockProperties = {\n\t_controlConfiguration: TemplateProcessorSettings;\n\t_settings: TemplateProcessorSettings;\n\tisDynamicInstantiation?: boolean;\n\tchange: string | undefined | EventHandler;\n\tmetaPath: Context;\n\tcontextPath: Context;\n\tisPublicField: boolean;\n\tvisible?: boolean | CompiledBindingToolkitExpression;\n\tliveChange: EventHandler;\n\tonLiveChange?: string | EventHandler;\n\t//-----\n\tformatOptions: FieldFormatOptions;\n\tproperty: Property;\n\tdataModelPath: DataModelObjectPath<Property>;\n\tvalueAsStringBindingExpression?: CompiledBindingToolkitExpression;\n\tunitBindingExpression?: string;\n\tdisplayVisible?: string | boolean;\n\thasValidAnalyticalCurrencyOrUnit?: CompiledBindingToolkitExpression;\n\tconvertedMetaPath: DataFieldAbstractTypes | DataPointTypeTypes;\n\tclass?: string;\n\tariaLabelledBy?: string[];\n\thasUnitOrCurrency?: boolean;\n\ttext?: BindingToolkitExpression<string> | CompiledBindingToolkitExpression;\n\temptyIndicatorMode?: string;\n\teditableExpression: string | CompiledBindingToolkitExpression;\n\tfieldGroupIds?: string[];\n\tdisplayStyleId?: string;\n\ttextFromValueList?: CompiledBindingToolkitExpression;\n\thasQuickView: boolean;\n\tidentifierTitle?: CompiledBindingToolkitExpression;\n\tidentifierText?: CompiledBindingToolkitExpression;\n\thasSituationsIndicator?: boolean;\n\tsituationsIndicatorPropertyPath: string;\n\tshowErrorIndicator: boolean;\n\tdynamicSemanticObjects?: BindingToolkitExpression<string>[];\n\tcollaborationExpression: BindingToolkitExpression<boolean>;\n\tdataSourcePath?: string;\n\teditStyleId?: string;\n\tenabledExpression: string | CompiledBindingToolkitExpression;\n\trequiredExpression?: string;\n\teditModeAsObject: CompiledBindingToolkitExpression | BindingToolkitExpression<string>;\n\tcomputedEditMode: FieldEditMode | CompiledBindingToolkitExpression;\n\tvalueBindingExpression?: CompiledBindingToolkitExpression;\n\tshowTimezone?: boolean;\n\tminDateExpression: BindingToolkitExpression<unknown> | undefined | CompiledBindingToolkitExpression;\n\tmaxDateExpression: BindingToolkitExpression<unknown> | undefined | CompiledBindingToolkitExpression;\n\teditStylePlaceholder?: string;\n\tstaticDescription?: string;\n\tvalueState?: CompiledBindingToolkitExpression;\n\tfileFilenameExpression: string;\n\tfileRelativePropertyPath: string;\n\ttextBindingExpression?: CompiledBindingToolkitExpression;\n\tratingIndicatorTooltip?: CompiledBindingToolkitExpression;\n\tratingIndicatorTargetValue?: CompiledBindingToolkitExpression;\n\tmask?: InputMaskFormatOptions | null;\n\teditStyle?: EditStyleType | null;\n\t_apiId?: string;\n\tentityType?: Context;\n\todataMetaModel: ODataMetaModel;\n\tpropertyForFieldControl: UIFormatters.PropertyOrPath<Property>;\n\tdescriptionBindingExpression?: string;\n\tquickViewType?: \"SemanticLinks\" | \"Facets\" | \"FacetsAndSemanticLinks\";\n\tdisplayStyle?: DisplayStyleType;\n\tunitEditable?: string;\n\tstaticUnit?: string;\n\tvalueInputWidth?: string;\n\tvalueInputFieldWidth?: string;\n\tunitInputVisible?: CompiledBindingToolkitExpression;\n\tdraftIndicatorVisible?: string;\n\thasPropertyInsertRestrictions?: boolean | ExpressionOrPrimitive<boolean>;\n\taddDraftIndicator: boolean | undefined;\n\tconvertedMetaPathExternalID?: Property;\n\tdataModelPathExternalID?: DataModelObjectPath<Property | PropertyPath>;\n\tvalueHelpMetaPath?: Context;\n\tid: string;\n\tvalueHelpId: string | undefined;\n\tmetaPathContext: Context | undefined;\n\tcontextPathContext: Context | undefined;\n\teventHandlers: {\n\t\tchange: EventHandler;\n\t\tliveChange: EventHandler;\n\t\tvalidateFieldGroup: EventHandler;\n\t\thandleTypeMissmatch: EventHandler;\n\t\thandleFileSizeExceed: EventHandler;\n\t\thandleUploadComplete: EventHandler;\n\t\tuploadStream: EventHandler;\n\t\tremoveStream: EventHandler;\n\t\thandleOpenUploader: EventHandler;\n\t\thandleCloseUploader: EventHandler;\n\t\topenExternalLink: EventHandler;\n\t\tonFocusOut: EventHandler;\n\t\tlinkPressed: EventHandler;\n\t\tdisplayAggregationDetails: EventHandler;\n\t\tonDataFieldWithNavigationPath: EventHandler;\n\t\tonDataFieldActionButton: EventHandler;\n\t\tonDataFieldWithIBN: EventHandler;\n\t\tshowCollaborationEditUser: EventHandler;\n\t};\n} & Omit<Field, \"metaPath\" | \"contextPath\" | \"change\" | \"visible\">;\n\nexport function setUpField(\n\tfield: InputFieldBlockProperties,\n\tcontrolConfiguration: TemplateProcessorSettings,\n\tviewDataModel: JSONModel,\n\tinternalModel: JSONModel,\n\tappComponent: AppComponent,\n\tisReadOnlyInitial?: boolean,\n\tmetaPath?: Context | undefined,\n\tcontextPath?: Context | undefined\n): FieldBlockProperties {\n\tconst resultField = { ...field } as unknown as FieldBlockProperties;\n\tObject.defineProperty(resultField, \"value\", {\n\t\tget: () => {\n\t\t\treturn field.value;\n\t\t}\n\t});\n\tObject.defineProperty(resultField, \"description\", {\n\t\tget: () => {\n\t\t\treturn field.description;\n\t\t}\n\t});\n\n\tresultField.change = field.change;\n\tresultField.metaPath = (metaPath ? metaPath : field.metaPath) as Context;\n\tresultField.contextPath = (contextPath ? contextPath : field.contextPath) as Context;\n\tresultField.visible = field.visible;\n\n\t//this currently works only for the field\n\tif (!resultField.vhIdPrefix) {\n\t\tresultField.vhIdPrefix = \"FieldValueHelp\";\n\t\tresultField._flexId = field.id;\n\t\tif (!resultField.idPrefix) {\n\t\t\tresultField.idPrefix = field.id;\n\t\t}\n\t}\n\n\tresultField.formatOptions ??= {} as FieldFormatOptions;\n\tresultField.formatOptions = getFormatOptions(resultField);\n\tresultField.formatOptions.showOnlyUnitDecimals =\n\t\tviewDataModel?.getProperty(\"/sapFeManifestConfiguration/app/showOnlyUnitDecimals\") === true;\n\n\tresultField.valueHelpMetaPath = metaPath ? metaPath : resultField.metaPath;\n\tcomputeCommonProperties(resultField, resultField.valueHelpMetaPath?.getModel());\n\tresultField.convertedMetaPath = setUpDataPointType(resultField.convertedMetaPath);\n\tsetUpVisibleProperties(resultField);\n\tcomputeIDs(resultField);\n\tresultField.dataSourcePath = getTargetObjectPath(resultField.dataModelPath);\n\n\t/* EXTERNALID */\n\tcomputeExternalID(resultField);\n\tresultField.entityType = resultField.odataMetaModel.createBindingContext(\n\t\t`/${resultField.dataModelPath.targetEntityType.fullyQualifiedName}`\n\t);\n\tif (resultField.formatOptions?.forInlineCreationRows === true) {\n\t\tresultField.hasPropertyInsertRestrictions = hasPropertyInsertRestrictions(resultField.dataModelPath);\n\t}\n\tcomputeEditMode(resultField);\n\tcomputeCollaborationProperties(resultField);\n\tcomputeEditableExpressions(resultField);\n\tresultField.formatOptions = resultField.formatOptions ? resultField.formatOptions : ({} as FieldFormatOptions);\n\tsetUpFormatOptions(\n\t\tresultField,\n\t\t(resultField.dataModelPathExternalID as DataModelObjectPath<Property>) || resultField.dataModelPath,\n\t\tcontrolConfiguration,\n\t\tviewDataModel\n\t);\n\tsetUpDisplayStyle(resultField, resultField.convertedMetaPath, resultField.dataModelPath, internalModel, appComponent);\n\tsetUpEditStyle(resultField, appComponent);\n\n\tresultField.valueState = setUpValueState(resultField);\n\tif (resultField.editStyle === \"InputWithValueHelp\") {\n\t\tresultField.editStylePlaceholder = setInputWithValuehelpPlaceholder(resultField);\n\t}\n\n\tcomputeFileUploaderProperties(resultField);\n\n\tcomputeInlineEditProperties(resultField, viewDataModel);\n\n\t// ---------------------------------------- compute bindings----------------------------------------------------\n\tconst aDisplayStylesWithoutPropText = [\"Avatar\", \"AmountWithCurrency\"];\n\tif (\n\t\tresultField.displayStyle &&\n\t\t!aDisplayStylesWithoutPropText.includes(resultField.displayStyle) &&\n\t\tresultField.dataModelPath.targetObject\n\t) {\n\t\tresultField.text =\n\t\t\tresultField.text ??\n\t\t\tresultField.value ??\n\t\t\tFieldTemplating.getTextBinding(\n\t\t\t\t(resultField.dataModelPathExternalID as DataModelObjectPath<Property>) || resultField.dataModelPath,\n\t\t\t\tresultField.formatOptions\n\t\t\t);\n\t} else {\n\t\tresultField.text = \"\";\n\t}\n\n\tif (resultField.formatOptions.showEmptyIndicator) {\n\t\tresultField.emptyIndicatorMode = String(resultField.formatOptions.showEmptyIndicator) === \"true\" ? \"On\" : undefined;\n\t} else {\n\t\tresultField.emptyIndicatorMode = undefined;\n\t}\n\n\t// If the target is a property with a DataFieldDefault, use this as data field\n\tif (isProperty(resultField.convertedMetaPath) && resultField.convertedMetaPath.annotations?.UI?.DataFieldDefault !== undefined) {\n\t\tresultField.metaPath = resultField.odataMetaModel.createBindingContext(\n\t\t\t`@${UIAnnotationTerms.DataFieldDefault}`,\n\t\t\tmetaPath ? metaPath : resultField.metaPath\n\t\t);\n\t}\n\n\tif (!isReadOnlyInitial) {\n\t\tresultField.computedEditMode = compileExpression(ifElse(equal(resultField.readOnly, true), \"Display\", \"Editable\"));\n\t}\n\n\tresultField.eventHandlers = {\n\t\tchange: (): void => {},\n\t\tliveChange: (): void => {},\n\t\tvalidateFieldGroup: (): void => {},\n\t\thandleTypeMissmatch: (): void => {},\n\t\thandleFileSizeExceed: (): void => {},\n\t\thandleUploadComplete: (): void => {},\n\t\tuploadStream: (): void => {},\n\t\tremoveStream: (): void => {},\n\t\thandleOpenUploader: (): void => {},\n\t\thandleCloseUploader: (): void => {},\n\t\topenExternalLink: (): void => {},\n\t\tonFocusOut: (): void => {},\n\t\tlinkPressed: (): void => {},\n\t\tdisplayAggregationDetails: (): void => {},\n\t\tonDataFieldWithNavigationPath: (): void => {},\n\t\tshowCollaborationEditUser: (): void => {},\n\t\tonDataFieldActionButton: (): void => {},\n\t\tonDataFieldWithIBN: (): void => {}\n\t};\n\n\treturn resultField;\n}\n\n/**\n * This helper computes the properties that are needed for the collaboration avatar.\n * @param field Reference to the current field instance\n */\nexport function computeCollaborationProperties(field: FieldBlockProperties): void {\n\tconst computedEditableExpression = UIFormatters.getEditableExpressionAsObject(\n\t\tfield.propertyForFieldControl,\n\t\tfield.convertedMetaPath,\n\t\tfield.dataModelPath\n\t);\n\tif (ModelHelper.isCollaborationDraftSupported(field.odataMetaModel) && field.editMode !== FieldEditMode.Display) {\n\t\tconst collaborationEnabled = true;\n\t\t// Expressions needed for Collaboration Visualization\n\t\tconst collaborationExpression = UIFormatters.getCollaborationExpression(\n\t\t\tfield.dataModelPath,\n\t\t\tCollaborationFormatters.hasCollaborationActivity\n\t\t);\n\t\tconst editableExpression = compileExpression(and(computedEditableExpression, not(collaborationExpression)));\n\n\t\tconst editMode = compileExpression(\n\t\t\tifElse(\n\t\t\t\tcollaborationExpression,\n\t\t\t\tconstant(\"ReadOnly\"),\n\t\t\t\tifElse(and(UI.IsInactive, !!field.hasPropertyInsertRestrictions), \"Display\", field.editModeAsObject)\n\t\t\t)\n\t\t);\n\t\tfield.collaborationEnabled = collaborationEnabled;\n\t\tfield.collaborationExpression = collaborationExpression;\n\t\tfield.editableExpression = editableExpression;\n\t\tfield.computedEditMode = editMode;\n\t} else {\n\t\tfield.editableExpression = compileExpression(computedEditableExpression);\n\t}\n}\n\n/**\n * This helper sets the common properties convertedMetaPath, dataModelPath\n * and property that can be reused in the individual templates if required.\n * @param field Reference to the current field instance\n * @param metaModel\n */\nexport function computeCommonProperties(field: FieldBlockProperties, metaModel: ODataMetaModel): void {\n\tfield.convertedMetaPath = MetaModelConverter.convertMetaModelContext(field.metaPathContext ? field.metaPathContext : field.metaPath) as\n\t\t| DataFieldAbstractTypes\n\t\t| DataPointTypeTypes;\n\n\tlet dataModelPath = MetaModelConverter.getInvolvedDataModelObjects<DataFieldAbstractTypes | DataPointTypeTypes | Property>(\n\t\tfield.metaPathContext ? field.metaPathContext : field.metaPath,\n\t\tfield.contextPath\n\t);\n\tdataModelPath =\n\t\tgetDataModelObjectPathForValue(dataModelPath as DataModelObjectPath<DataFieldAbstractTypes | DataPointTypeTypes>) || dataModelPath;\n\tfield.dataModelPath = dataModelPath as DataModelObjectPath<Property>;\n\tfield.property = dataModelPath.targetObject as Property;\n\tfield.odataMetaModel = metaModel;\n\tfield.propertyForFieldControl = (dataModelPath?.targetObject as unknown as DataFieldTypes)?.Value\n\t\t? (dataModelPath?.targetObject as unknown as DataFieldTypes).Value\n\t\t: dataModelPath?.targetObject;\n}\n\n/**\n * Helper to computes some of the expression for further processing.\n * @param field Reference to the current field instance\n */\nexport function computeEditableExpressions(field: FieldBlockProperties): void {\n\tconst requiredPropertiesFromInsertRestrictions = getRequiredPropertiesFromInsertRestrictions(\n\t\t(field.contextPathContext ? field.contextPathContext : field.contextPath)\n\t\t\t?.getPath()\n\t\t\t.replaceAll(\"/$NavigationPropertyBinding/\", \"/\"),\n\t\tfield.odataMetaModel\n\t);\n\tconst requiredPropertiesFromUpdateRestrictions = getRequiredPropertiesFromUpdateRestrictions(\n\t\t(field.contextPathContext ? field.contextPathContext : field.contextPath)\n\t\t\t?.getPath()\n\t\t\t.replaceAll(\"/$NavigationPropertyBinding/\", \"/\"),\n\t\tfield.odataMetaModel\n\t);\n\tconst oRequiredProperties = {\n\t\trequiredPropertiesFromInsertRestrictions: requiredPropertiesFromInsertRestrictions,\n\t\trequiredPropertiesFromUpdateRestrictions: requiredPropertiesFromUpdateRestrictions\n\t};\n\n\tconst enabledExpression = UIFormatters.getEnabledExpression(\n\t\tfield.propertyForFieldControl,\n\t\tfield.convertedMetaPath,\n\t\tfalse,\n\t\tfield.dataModelPath\n\t) as CompiledBindingToolkitExpression;\n\tconst requiredExpression = UIFormatters.getRequiredExpression(\n\t\tfield.propertyForFieldControl,\n\t\tfield.convertedMetaPath,\n\t\tfalse,\n\t\tfalse,\n\t\toRequiredProperties,\n\t\tfield.dataModelPath\n\t) as CompiledBindingToolkitExpression;\n\n\tfield.enabledExpression = enabledExpression;\n\tfield.requiredExpression = requiredExpression;\n}\n\nexport function computeEditMode(field: FieldBlockProperties): void {\n\tif (field.editMode !== undefined && field.editMode !== null) {\n\t\t// Even if it provided as a string it's a valid part of a binding expression that can be later combined into something else.\n\t\tfield.editModeAsObject = field.editMode;\n\t} else {\n\t\tconst measureReadOnly = field.formatOptions?.measureDisplayMode ? field.formatOptions.measureDisplayMode === \"ReadOnly\" : false;\n\n\t\tfield.editModeAsObject = UIFormatters.getEditMode(\n\t\t\tfield.propertyForFieldControl,\n\t\t\tfield.dataModelPath,\n\t\t\tmeasureReadOnly,\n\t\t\ttrue,\n\t\t\tfield.convertedMetaPath\n\t\t);\n\t\tfield.computedEditMode = compileExpression(\n\t\t\tifElse(and(UI.IsInactive, !!field.hasPropertyInsertRestrictions), \"Display\", field.editModeAsObject)\n\t\t);\n\t}\n}\n\nexport function computeExternalID(field: FieldBlockProperties): void {\n\tconst externalIDProperty = getAssociatedExternalIdProperty(field.property);\n\n\tif (externalIDProperty) {\n\t\tif (field.property) field.property.type = externalIDProperty.type;\n\t\tif (isDataField(field.convertedMetaPath)) {\n\t\t\tfield.convertedMetaPath.Value.$target.type = externalIDProperty.type;\n\t\t}\n\t\tconst externalIdPropertyPath = getAssociatedExternalIdPropertyPath(field.property);\n\t\tconst externalIdContext = field.metaPath\n\t\t\t.getModel()\n\t\t\t.createBindingContext(field.contextPath?.getPath() + \"/\" + externalIdPropertyPath, field.metaPath);\n\n\t\tfield.convertedMetaPathExternalID = MetaModelConverter.convertMetaModelContext(externalIdContext) as Property;\n\n\t\tlet dataModelPath: DataModelObjectPath<Property> = MetaModelConverter.getInvolvedDataModelObjects(\n\t\t\texternalIdContext as Context,\n\t\t\tfield.contextPath\n\t\t);\n\t\tdataModelPath = getDataModelObjectPathForValue(dataModelPath as DataModelObjectPath<DataFieldAbstractTypes>) || dataModelPath;\n\t\tfield.dataModelPathExternalID = dataModelPath;\n\t}\n}\n\n/**\n * Calculate the fieldGroupIds for an Input or other edit control.\n * @param field\n * @param appComponent\n * @returns The fieldGroupIds\n */\nfunction computeFieldGroupIds(field: FieldBlockProperties, appComponent?: AppComponent): string[] | undefined {\n\tconst typesForCollaborationFocusManagement = [\n\t\t\"InputWithValueHelp\",\n\t\t\"TextArea\",\n\t\t\"DatePicker\",\n\t\t\"TimePicker\",\n\t\t\"DateTimePicker\",\n\t\t\"InputWithUnit\",\n\t\t\"Input\",\n\t\t\"InputMask\",\n\t\t\"Masked\"\n\t];\n\n\tif (!appComponent) {\n\t\t//for ValueHelp / Mass edit Templating the appComponent is not passed to the templating\n\t\treturn;\n\t}\n\tconst sideEffectService = appComponent.getSideEffectsService();\n\tconst fieldGroupIds = sideEffectService.computeFieldGroupIds(\n\t\tfield.dataModelPath.targetEntityType?.fullyQualifiedName ?? \"\",\n\t\tfield.dataModelPath.targetObject?.fullyQualifiedName ?? \"\"\n\t);\n\n\tfield.mainPropertyRelativePath = isProperty(field.dataModelPath.targetObject)\n\t\t? getContextRelativeTargetObjectPath(field.dataModelPath)\n\t\t: undefined;\n\n\tif (field.collaborationEnabled && typesForCollaborationFocusManagement.includes(field.editStyle || \"\")) {\n\t\tconst collaborationFieldGroup = `${CollaborationFieldGroupPrefix}${field.dataSourcePath}`;\n\t\tfieldGroupIds.push(collaborationFieldGroup);\n\t}\n\n\treturn fieldGroupIds.length ? fieldGroupIds : undefined;\n}\n\n/**\n * This helper is for the ID of the field according to several different scenarios.\n *\n * displayStyleId is used for all controls inside the field wrapper in display mode. A <sap.m.text> control would get this ID. An example is: ApplicationContext::Field-display.\n * editStyleId is used for all controls inside the field wrapper in edit mode. A <sap.ui.mdc.field> control would get this ID. An example is: ApplicationContext::Field-edit.\n *\n * If no wrapper exists the wrappers ID will be propagated to the first control displayed, A <sap.m.text> control would get this ID. An example is: ApplicationContext::Field-content.\n * @param field Reference to the current field instance\n */\nexport function computeIDs(field: Partial<FieldBlockProperties>): void {\n\tif (field._flexId && !field._apiId) {\n\t\tfield._apiId = field._flexId;\n\t\tfield._flexId = getContentId(field._flexId);\n\t}\n\n\tif (field.idPrefix) {\n\t\tfield.editStyleId = generate([field.idPrefix, \"Field-edit\"]);\n\t}\n\t//NoWrapperId scenario is for the LR table.\n\tif (field.formatOptions?.fieldMode === \"nowrapper\" && field.editMode === \"Display\") {\n\t\tif (field._flexId) {\n\t\t\tfield.displayStyleId = field._flexId;\n\t\t} else {\n\t\t\tfield.displayStyleId = field.idPrefix ? generate([field.idPrefix, \"Field-content\"]) : undefined;\n\t\t}\n\t} else if (field.idPrefix) {\n\t\tfield.displayStyleId = generate([field.idPrefix, \"Field-display\"]);\n\t}\n}\n\n/**\n * Sets the internal formatOptions for the building block.\n * @param field\n * @returns A string with the internal formatOptions for the building block\n */\nexport function getFormatOptions(field: FieldBlockProperties): FieldFormatOptions {\n\treturn {\n\t\t...field.formatOptions,\n\t\ttextAlignMode: field.formatOptions.textAlignMode ?? \"Form\",\n\t\tshowEmptyIndicator: field.formatOptions.showEmptyIndicator ?? true,\n\t\tdisplayMode: field.formatOptions.displayMode as DisplayMode,\n\t\tmeasureDisplayMode: field.formatOptions.measureDisplayMode,\n\t\ttextLinesEdit: field.formatOptions.textLinesEdit,\n\t\ttextMaxLines: field.formatOptions.textMaxLines,\n\t\ttextMaxCharactersDisplay: field.formatOptions.textMaxCharactersDisplay,\n\t\ttextExpandBehaviorDisplay: field.formatOptions.textExpandBehaviorDisplay,\n\t\ttextMaxLength: field.formatOptions.textMaxLength,\n\t\tfieldEditStyle: field.formatOptions.fieldEditStyle,\n\t\tradioButtonsHorizontalLayout: field.formatOptions.radioButtonsHorizontalLayout,\n\t\tshowTime: field.formatOptions.showTime,\n\t\tshowTimezone: field.formatOptions.showTimezone,\n\t\tshowDate: field.formatOptions.showDate\n\t} as FieldFormatOptions;\n}\n\nfunction getObjectIdentifierText(\n\tfieldFormatOptions: FieldFormatOptions,\n\tpropertyDataModelObjectPath: DataModelObjectPath<Property | PropertyPath>\n): CompiledBindingToolkitExpression {\n\tlet propertyBindingExpression: BindingToolkitExpression<string> = pathInModel(\n\t\tgetContextRelativeTargetObjectPath(propertyDataModelObjectPath)\n\t);\n\tconst targetDisplayMode = fieldFormatOptions?.displayMode;\n\tconst propertyDefinition = isPropertyPathExpression(propertyDataModelObjectPath.targetObject)\n\t\t? (propertyDataModelObjectPath.targetObject.$target as Property)\n\t\t: (propertyDataModelObjectPath.targetObject as Property);\n\n\tconst commonText = propertyDefinition.annotations?.Common?.Text;\n\tif (commonText === undefined) {\n\t\treturn undefined;\n\t}\n\tpropertyBindingExpression = formatWithTypeInformation(propertyDefinition, propertyBindingExpression);\n\n\tswitch (targetDisplayMode) {\n\t\tcase \"ValueDescription\":\n\t\t\tconst relativeLocation = getRelativePaths(propertyDataModelObjectPath);\n\t\t\treturn compileExpression(getExpressionFromAnnotation(commonText, relativeLocation));\n\t\tcase \"DescriptionValue\":\n\t\t\treturn compileExpression(formatResult([propertyBindingExpression], valueFormatters.formatToKeepWhitespace));\n\t\tdefault:\n\t\t\treturn undefined;\n\t}\n}\n\nfunction getOverrides(controlConfiguration: TemplateProcessorSettings, id: string): FieldProperties {\n\t/*\n\t\tQualms: We need to use this TemplateProcessorSettings type to be able to iterate\n\t\tover the properties later on and cast it afterwards as a field property type\n\t*/\n\tconst props = {} as TemplateProcessorSettings;\n\n\tif (controlConfiguration) {\n\t\tconst controlConfig = controlConfiguration[id] as TemplateProcessorSettings;\n\t\tif (controlConfig) {\n\t\t\tObject.keys(controlConfig).forEach(function (configKey) {\n\t\t\t\tprops[configKey] = controlConfig[configKey];\n\t\t\t});\n\t\t}\n\t}\n\treturn props as unknown as FieldProperties;\n}\n\n/**\n * Prepare the display style of the field in case of semantic objects or quickview facets.\n * @param field The field\n * @param internalModel\n * @param dataModelPath The DataModelObjectPath of the property\n * @param hasSemanticObjects\n * @param hasQuickView\n */\nfunction manageQuickViewForDisplayStyle(\n\tfield: FieldBlockProperties,\n\tinternalModel: JSONModel,\n\tdataModelPath: DataModelObjectPath<Property>,\n\thasSemanticObjects: boolean,\n\thasQuickView: boolean\n): void {\n\tif (hasQuickView) {\n\t\tfield.hasQuickView = true;\n\t\tfield.quickViewType = \"Facets\";\n\t}\n\tif (hasSemanticObjects) {\n\t\tconst foundSemanticObjects = manageSemanticObjectsForCurrentUser(field.semanticObject, dataModelPath, internalModel);\n\t\tif (foundSemanticObjects.hasReachableStaticSemanticObject || foundSemanticObjects.dynamicSemanticObjects.length) {\n\t\t\tfield.hasQuickView = true;\n\t\t\tfield.quickViewType = hasQuickView ? \"FacetsAndSemanticLinks\" : \"SemanticLinks\";\n\t\t\tfield.dynamicSemanticObjects =\n\t\t\t\tfoundSemanticObjects.hasReachableStaticSemanticObject !== true ? foundSemanticObjects.dynamicSemanticObjects : undefined;\n\t\t}\n\t}\n}\n\n/**\n * Check field to know if it has a semantic object.\n * @param field The field\n * @param dataModelPath The DataModelObjectPath of the property\n * @returns True if field has a semantic object\n */\nfunction propertyOrNavigationPropertyHasSemanticObject(field: FieldBlockProperties, dataModelPath: DataModelObjectPath<Property>): boolean {\n\treturn !!getPropertyWithSemanticObject(dataModelPath) || (field.semanticObject !== undefined && field.semanticObject !== \"\");\n}\n\nexport function setInputWithValuehelpPlaceholder(field: FieldBlockProperties): CompiledBindingToolkitExpression {\n\tlet targetEntityType;\n\tconst editStylePlaceholder = field.editStylePlaceholder;\n\tconst fieldContainerType = field.formatOptions.textAlignMode;\n\tif (fieldContainerType === \"Table\") {\n\t\ttargetEntityType = field.dataModelPath.targetEntityType;\n\t}\n\tconst propertyPath = field.dataModelPath.targetObject?.name;\n\tconst recommendationValue = pathInModel(`${propertyPath}@$ui5.fe.recommendations.placeholderValue`);\n\tconst recommendationDescription = pathInModel(`${propertyPath}@$ui5.fe.recommendations.placeholderDescription`);\n\tconst placeholderExp = formatResult(\n\t\t[\n\t\t\trecommendationValue,\n\t\t\trecommendationDescription,\n\t\t\tpathInModel(`/recommendationsData`, \"internal\"),\n\t\t\tpathInModel(`/currentCtxt`, \"internal\"),\n\t\t\tpathInModel(`${propertyPath}@$ui5.fe.messageType`),\n\t\t\teditStylePlaceholder,\n\t\t\tfield.formatOptions.displayMode\n\t\t],\n\t\tadditionalValueFormatter.formatPlaceholder,\n\t\ttargetEntityType\n\t);\n\n\treturn compileExpression(placeholderExp);\n}\n\nexport function setUpDataPointType(dataField: DataFieldAbstractTypes | DataPointTypeTypes): DataFieldAbstractTypes | DataPointTypeTypes {\n\t// data point annotations need not have $Type defined, so add it if missing\n\tconst dataPointType = { ...dataField };\n\tif ((dataField as unknown as DataPoint)?.term === \"com.sap.vocabularies.UI.v1.DataPoint\") {\n\t\tdataPointType.$Type = dataField.$Type || UIAnnotationTypes.DataPointType;\n\t}\n\treturn dataPointType;\n}\n\nexport function getDecimalPadding(appComponent: AppComponent | undefined, property: Property): number | undefined {\n\tconst manifest = appComponent?.getManifestEntry(\"sap.fe\");\n\treturn property?.annotations?.Measures?.ISOCurrency\n\t\t? manifest?.macros?.table?.currency?.decimalPadding ?? 3\n\t\t: manifest?.macros?.table?.unitOfMeasure?.decimalPadding ?? 3;\n}\n\nexport function setUpDisplayStyle(\n\tfield: FieldBlockProperties,\n\tdataField: DataFieldAbstractTypes | DataPointTypeTypes,\n\tdataModelPath: DataModelObjectPath<DataFieldAbstractTypes | DataPointTypeTypes | Property>,\n\tinternalModel: JSONModel,\n\tappComponent: AppComponent\n): FieldBlockProperties {\n\tconst resultField: FieldBlockProperties = field;\n\tconst property: Property = dataModelPath.targetObject as Property;\n\tif (!dataModelPath.targetObject) {\n\t\tresultField.displayStyle = \"Text\";\n\t\treturn resultField;\n\t}\n\n\tresultField.hasUnitOrCurrency =\n\t\tproperty.annotations?.Measures?.Unit !== undefined || property.annotations?.Measures?.ISOCurrency !== undefined;\n\tresultField.hasValidAnalyticalCurrencyOrUnit = UIFormatters.hasValidAnalyticalCurrencyOrUnit(\n\t\tdataModelPath as DataModelObjectPath<Property>\n\t);\n\tresultField.textFromValueList = compileExpression(\n\t\tformatResult(\n\t\t\t[\n\t\t\t\tpathInModel(getContextRelativeTargetObjectPath(dataModelPath)),\n\t\t\t\t`/${property.fullyQualifiedName}`,\n\t\t\t\tresultField.formatOptions.displayMode\n\t\t\t],\n\t\t\t\"sap.fe.macros.field.FieldRuntime.retrieveTextFromValueList\"\n\t\t)\n\t);\n\n\tif (property.annotations?.UI?.IsImage) {\n\t\tresultField.displayStyle = \"File\";\n\t\treturn resultField;\n\t}\n\tif (property.annotations?.UI?.IsImageURL) {\n\t\tresultField.displayStyle = \"Avatar\";\n\t\treturn resultField;\n\t}\n\tif (property.annotations?.UI?.InputMask) {\n\t\tresultField.displayStyle = \"Text\";\n\t\treturn resultField;\n\t}\n\tif (property.annotations?.Common?.Masked) {\n\t\tresultField.displayStyle = \"Masked\";\n\t\treturn resultField;\n\t}\n\t// For compatibility reasons, Stream will be shown within an entity instance as circle if the entity is annotated as IsNaturalPerson\n\t// and neither IsImage nor IsImageURL annotation has been used.\n\tif (property.type === \"Edm.Stream\") {\n\t\tresultField.displayStyle = \"File\";\n\t\treturn resultField;\n\t}\n\tsetUpDraftIndicator(dataModelPath as DataModelObjectPath<Property>, resultField);\n\tswitch (dataField.$Type as string) {\n\t\tcase UIAnnotationTypes.DataPointType:\n\t\t\tresultField.displayStyle = \"DataPoint\";\n\t\t\treturn resultField;\n\t\tcase UIAnnotationTypes.DataFieldForAnnotation:\n\t\t\tif ((dataField as unknown as DataFieldForAnnotation).Target?.$target?.$Type === UIAnnotationTypes.DataPointType) {\n\t\t\t\tresultField.displayStyle = \"DataPoint\";\n\t\t\t\treturn resultField;\n\t\t\t} else if (\n\t\t\t\t(dataField as unknown as DataFieldForAnnotation).Target?.$target?.$Type ===\n\t\t\t\t\"com.sap.vocabularies.Communication.v1.ContactType\"\n\t\t\t) {\n\t\t\t\tresultField.displayStyle = \"Contact\";\n\t\t\t\treturn resultField;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UIAnnotationTypes.DataFieldForAction:\n\t\tcase UIAnnotationTypes.DataFieldForIntentBasedNavigation:\n\t\t\tresultField.displayStyle = \"Button\";\n\t\t\treturn resultField;\n\t\tcase UIAnnotationTypes.DataFieldWithIntentBasedNavigation:\n\t\tcase UIAnnotationTypes.DataFieldWithNavigationPath:\n\t\tcase UIAnnotationTypes.DataFieldWithAction:\n\t\t\tresultField.displayStyle = \"Link\";\n\t\t\treturn resultField;\n\t}\n\tconst hasQuickView = isUsedInNavigationWithQuickViewFacets(dataModelPath, property);\n\tconst hasSemanticObjects = propertyOrNavigationPropertyHasSemanticObject(resultField, dataModelPath as DataModelObjectPath<Property>);\n\n\tif (isSemanticKey(property, dataModelPath) && resultField.formatOptions.semanticKeyStyle) {\n\t\tmanageQuickViewForDisplayStyle(\n\t\t\tresultField,\n\t\t\tinternalModel,\n\t\t\tdataModelPath as DataModelObjectPath<Property>,\n\t\t\thasSemanticObjects,\n\t\t\thasQuickView\n\t\t);\n\t\tsetUpObjectIdentifierTitleAndText(resultField, dataModelPath as DataModelObjectPath<Property>);\n\t\tresultField.showErrorIndicator =\n\t\t\t(dataModelPath.contextLocation as unknown as DataModelObjectPath<ServiceObject>)?.targetObject?._type ===\n\t\t\t\t\"NavigationProperty\" && !resultField.formatOptions.fieldGroupDraftIndicatorPropertyPath;\n\t\tresultField.situationsIndicatorPropertyPath = (dataModelPath.targetObject as Property).name;\n\t\tresultField.displayStyle =\n\t\t\tresultField.formatOptions.semanticKeyStyle === \"ObjectIdentifier\" ? \"ObjectIdentifier\" : \"LabelSemanticKey\";\n\t\treturn resultField;\n\t}\n\tif (dataField.Criticality) {\n\t\tmanageQuickViewForDisplayStyle(\n\t\t\tresultField,\n\t\t\tinternalModel,\n\t\t\tdataModelPath as DataModelObjectPath<Property>,\n\t\t\thasSemanticObjects,\n\t\t\thasQuickView\n\t\t);\n\t\tresultField.displayStyle = \"ObjectStatus\";\n\t\treturn resultField;\n\t}\n\tif (\n\t\t(property.annotations?.Measures?.ISOCurrency || property.annotations?.Measures?.Unit) &&\n\t\tString(resultField.formatOptions.isCurrencyOrUnitAligned) === \"true\" &&\n\t\tresultField.formatOptions.measureDisplayMode !== \"Hidden\"\n\t) {\n\t\tconst decimalPadding = FieldStructureHelper.getDecimalPadding(appComponent, property);\n\t\tresultField.valueAsStringBindingExpression = resultField.value\n\t\t\t? resultField.value\n\t\t\t: getValueBinding(\n\t\t\t\t\tdataModelPath as DataModelObjectPath<Property>,\n\t\t\t\t\tresultField.formatOptions,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue,\n\t\t\t\t\tundefined,\n\t\t\t\t\ttrue,\n\t\t\t\t\tfalse,\n\t\t\t\t\tdecimalPadding,\n\t\t\t\t\ttrue\n\t\t\t  );\n\n\t\tresultField.unitBindingExpression = compileExpression(\n\t\t\tUIFormatters.getBindingForUnitOrCurrency(\n\t\t\t\tdataModelPath as DataModelObjectPath<Property>,\n\t\t\t\ttrue,\n\t\t\t\t!!field.formatOptions.showOnlyUnitDecimals\n\t\t\t)\n\t\t);\n\t\tresultField.displayStyle = \"NumberWithUnitOrCurrencyAligned\";\n\n\t\treturn resultField;\n\t}\n\tif (property.annotations?.Communication?.IsEmailAddress || property.annotations?.Communication?.IsPhoneNumber) {\n\t\tresultField.displayStyle = \"Link\";\n\t\treturn resultField;\n\t}\n\tif (property.annotations?.UI?.MultiLineText) {\n\t\tresultField.displayStyle = \"ExpandableText\";\n\t\treturn resultField;\n\t}\n\n\tif (dataField.$Type === UIAnnotationTypes.DataFieldWithUrl) {\n\t\tresultField.displayStyle = \"Link\";\n\t\treturn resultField;\n\t}\n\n\tresultField.displayStyle = \"Text\";\n\tmanageQuickViewForDisplayStyle(\n\t\tresultField,\n\t\tinternalModel,\n\t\tdataModelPath as DataModelObjectPath<Property>,\n\t\thasSemanticObjects,\n\t\thasQuickView\n\t);\n\tif (resultField.hasQuickView) {\n\t\tresultField.displayStyle = \"LinkWithQuickView\";\n\t}\n\treturn resultField;\n}\n\n/**\n * This determines whether we should add a draft indicator within the field template.\n * @param dataModelPath DataModelObjectPath pointing to the main property for the field\n * @param field\n */\nfunction setUpDraftIndicator(dataModelPath: DataModelObjectPath<Property>, field: FieldBlockProperties): void {\n\tif (isSemanticKey(dataModelPath.targetObject as Property, dataModelPath)) {\n\t\tfield.hasSituationsIndicator = SituationsIndicator.getSituationsNavigationProperty(dataModelPath.targetEntityType) !== undefined;\n\t\tif (\n\t\t\t(dataModelPath.contextLocation?.targetEntitySet as EntitySet | undefined)?.annotations?.Common?.DraftRoot &&\n\t\t\t(dataModelPath.targetEntitySet as EntitySet | undefined)?.annotations?.Common?.DraftRoot &&\n\t\t\tfield.formatOptions?.hasDraftIndicator === true\n\t\t) {\n\t\t\t// In case of a grid table or tree table hasDraftIndicator will be false since the draft\n\t\t\t// indicator needs to be rendered into a separate column\n\t\t\t// Hence we then fall back to display styles ObjectIdentifier or LabelSemanticKey instead\n\t\t\t// of the combined ID and draft indicator style\n\t\t\tfield.draftIndicatorVisible = getDraftIndicatorVisibleBinding(dataModelPath.targetObject?.name) as string;\n\t\t\tfield.addDraftIndicator = true;\n\t\t}\n\t}\n}\n\nexport function setUpEditStyle(field: FieldBlockProperties, appComponent?: AppComponent): FieldBlockProperties {\n\tconst resultField = field;\n\tsetEditStyleProperties(resultField, resultField.convertedMetaPath, resultField.dataModelPath);\n\tresultField.fieldGroupIds = computeFieldGroupIds(resultField, appComponent);\n\treturn resultField;\n}\n\nexport function setUpObjectIdentifierTitleAndText(\n\tfield: FieldBlockProperties,\n\tpropertyDataModelObjectPath: DataModelObjectPath<Property>\n): void {\n\tconst semanticStyle = field.formatOptions?.semanticKeyStyle;\n\tconst displayMode = field.formatOptions.displayMode;\n\tfield.identifierTitle = getTitleBindingExpression(\n\t\tpropertyDataModelObjectPath,\n\t\tgetTextBindingExpression,\n\t\t{ displayMode, splitTitleOnTwoLines: field.formatOptions.semanticKeyStyle === \"ObjectIdentifier\" },\n\t\tundefined,\n\t\tundefined\n\t);\n\tfield.identifierText =\n\t\tsemanticStyle === \"ObjectIdentifier\" ? getObjectIdentifierText(field.formatOptions, propertyDataModelObjectPath) : undefined;\n}\n\nexport function setUpFormatOptions(\n\tfield: FieldBlockProperties,\n\tdataModelPath: DataModelObjectPath<Property>,\n\tcontrolConfiguration: TemplateProcessorSettings,\n\tviewDataModel: JSONModel\n): void {\n\tconst overrideProps = getOverrides(controlConfiguration, (field.metaPathContext ? field.metaPathContext : field.metaPath).getPath());\n\n\tif (!field.formatOptions.displayMode) {\n\t\tfield.formatOptions.displayMode = UIFormatters.getDisplayMode(dataModelPath);\n\t}\n\tif (field.formatOptions.displayMode === \"Description\") {\n\t\tfield.valueAsStringBindingExpression = field.value\n\t\t\t? field.value\n\t\t\t: getValueBinding(dataModelPath, field.formatOptions, true, true, undefined, true);\n\t}\n\tfield.formatOptions.textLinesEdit =\n\t\t(overrideProps as unknown as FieldFormatOptions).textLinesEdit ||\n\t\t(overrideProps.formatOptions && overrideProps.formatOptions.textLinesEdit) ||\n\t\tfield.formatOptions.textLinesEdit ||\n\t\t4;\n\tfield.formatOptions.textMaxLines =\n\t\t(overrideProps as unknown as FieldFormatOptions).textMaxLines ||\n\t\t(overrideProps.formatOptions && overrideProps.formatOptions.textMaxLines) ||\n\t\tfield.formatOptions.textMaxLines;\n\n\t// Retrieve text from value list as fallback feature for missing text annotation on the property\n\tif (viewDataModel?.getProperty(\"/retrieveTextFromValueList\")) {\n\t\tfield.formatOptions.retrieveTextFromValueList = isRetrieveTextFromValueListEnabled(\n\t\t\tdataModelPath.targetObject!,\n\t\t\tfield.formatOptions\n\t\t);\n\t\tif (field.formatOptions.retrieveTextFromValueList) {\n\t\t\t// Consider TextArrangement at EntityType otherwise set default display format 'DescriptionValue'\n\t\t\tconst hasEntityTextArrangement = !!dataModelPath?.targetEntityType?.annotations?.UI?.TextArrangement;\n\t\t\tfield.formatOptions.displayMode = hasEntityTextArrangement ? field.formatOptions.displayMode : \"DescriptionValue\";\n\t\t}\n\t}\n}\n\nexport function setUpValueState(field: FieldBlockProperties): CompiledBindingToolkitExpression {\n\tlet valueStateExp;\n\tconst fieldContainerType = field.formatOptions?.textAlignMode ? field.formatOptions?.textAlignMode : \"Form\";\n\tconst propertyPathInModel = pathInModel(getContextRelativeTargetObjectPath(field.dataModelPath)) as PathInModelExpression<Property>;\n\tconst relativeLocation = getRelativePaths(field.dataModelPath);\n\tconst textPath = getExpressionFromAnnotation(field.dataModelPath?.targetObject?.annotations?.Common?.Text, relativeLocation);\n\tconst propertyPath = field.dataModelPath.targetObject?.name;\n\tconst recommendationValue = pathInModel(`${propertyPath}@$ui5.fe.recommendations.placeholderValue`);\n\tconst recommendationDescription = pathInModel(`${propertyPath}@$ui5.fe.recommendations.placeholderDescription`);\n\tif (fieldContainerType === \"Table\") {\n\t\tvalueStateExp = formatResult(\n\t\t\t[\n\t\t\t\trecommendationValue,\n\t\t\t\trecommendationDescription,\n\t\t\t\tpathInModel(`/recommendationsData`, \"internal\"),\n\t\t\t\tpathInModel(`/isEditable`, \"ui\"),\n\t\t\t\tfield.dataSourcePath,\n\t\t\t\tpropertyPathInModel,\n\t\t\t\ttextPath\n\t\t\t],\n\t\t\tadditionalValueFormatter.formatValueState,\n\t\t\tfield.dataModelPath.targetEntityType\n\t\t);\n\t} else {\n\t\tvalueStateExp = formatResult(\n\t\t\t[\n\t\t\t\trecommendationValue,\n\t\t\t\trecommendationDescription,\n\t\t\t\tpathInModel(`/recommendationsData`, \"internal\"),\n\t\t\t\tpathInModel(`/isEditable`, \"ui\"),\n\t\t\t\tfield.dataSourcePath,\n\t\t\t\tpropertyPathInModel,\n\t\t\t\ttextPath\n\t\t\t],\n\t\t\tadditionalValueFormatter.formatValueState\n\t\t);\n\t}\n\n\tfield.valueState = compileExpression(valueStateExp);\n\treturn field.valueState;\n}\n\nexport function setUpVisibleProperties(field: FieldBlockProperties): void {\n\t// we do this before enhancing the dataModelPath so that it still points at the DataField\n\t// const visibleProperties: Partial<fieldBlock> = {};\n\tconst propertyDataModelObjectPath = MetaModelConverter.getInvolvedDataModelObjects<DataFieldAbstractTypes>(\n\t\tfield.metaPathContext ? field.metaPathContext : field.metaPath,\n\t\tfield.contextPath\n\t);\n\n\tfield.visible ??= getVisibleExpression(propertyDataModelObjectPath, field.formatOptions);\n\tfield.displayVisible = field.formatOptions?.fieldMode === \"nowrapper\" ? field.visible : undefined;\n}\n\nfunction getContentId(macroId: string): string {\n\treturn `${macroId}-content`;\n}\n\n/**\n * Computes properties for the file templating.\n * @param field The field\n */\nfunction computeFileUploaderProperties(field: FieldBlockProperties): void {\n\tif (field.displayStyle === \"File\") {\n\t\tfield.fileRelativePropertyPath = getContextRelativeTargetObjectPath(field.dataModelPath) || \"\";\n\t\tconst fileNameAnnotation = field.property.annotations.Core?.ContentDisposition?.Filename;\n\t\tif (isPathAnnotationExpression(fileNameAnnotation)) {\n\t\t\tconst fileNameDataModelPath = enhanceDataModelPath(field.dataModelPath, fileNameAnnotation.path);\n\t\t\tfield.fileFilenameExpression = getContextRelativeTargetObjectPath(fileNameDataModelPath) ?? \"\";\n\t\t}\n\t}\n}\n\n/**\n * Computes properties for the inline edit templating.\n * @param field The field\n * @param viewDataModel\n */\nfunction computeInlineEditProperties(field: FieldBlockProperties, viewDataModel: JSONModel): void {\n\tif (field.displayStyle === \"File\" || field.displayStyle === \"Avatar\") {\n\t\tfield.inlineEditEnabled = undefined;\n\t\treturn;\n\t}\n\tfield.inlineEditEnabled =\n\t\tfield.inlineEditEnabled === true || viewDataModel?.getProperty(\"/isInlineEditEnabled\") === true ? true : undefined;\n\tif (field.inlineEditEnabled && field.editModeAsObject !== \"Display\") {\n\t\tconst computedEditableExpression = UIFormatters.getEditableExpressionAsObject(\n\t\t\tfield.propertyForFieldControl,\n\t\t\tfield.convertedMetaPath,\n\t\t\tfield.dataModelPath\n\t\t);\n\n\t\tfield.hasInlineEdit = transformRecursively(\n\t\t\tcomputedEditableExpression,\n\t\t\t\"PathInModel\",\n\t\t\t(expr) => {\n\t\t\t\tif (expr.path === \"isEditable\" && expr.modelName === \"ui\") {\n\t\t\t\t\treturn constant(true);\n\t\t\t\t}\n\t\t\t\treturn expr;\n\t\t\t},\n\t\t\ttrue\n\t\t) as unknown as boolean;\n\t}\n}\n\nconst FieldStructureHelper = {\n\tgetDecimalPadding,\n\tsetUpField,\n\tcomputeExternalID,\n\tsetUpDisplayStyle,\n\tsetUpObjectIdentifierTitleAndText,\n\tsetUpValueState\n};\nexport default FieldStructureHelper;\n"],"mappings":"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","ignoreList":[],"file":"FieldStructureHelper-dbg.js"}