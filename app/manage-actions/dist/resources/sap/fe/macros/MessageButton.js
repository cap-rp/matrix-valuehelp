/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/m/Button","sap/m/MessageItem","sap/m/MessagePopover","sap/m/library","sap/ui/core/Element","sap/ui/core/Messaging","sap/ui/core/message/MessageType","sap/fe/base/jsx-runtime/jsx"],function(e,t,s,i,n,a,o,r,l,g,c){"use strict";var u,p,f,h,_;var m={};var E=o.ButtonType;var d=t.event;var M=t.defineUI5Class;function v(e,t,s,i){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(i):void 0})}function b(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,P(e,t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function S(e,t,s,i,n){var a={};return Object.keys(i).forEach(function(e){a[e]=i[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=s.slice().reverse().reduce(function(s,i){return i(e,t,s)||s},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(e,t,a),null):a}function T(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let C=(u=M("sap.fe.macros.MessageButton"),p=d(),u(f=(h=function(t){function s(e,s){var i;i=t.call(this,e,s)||this;v(i,"visibilityChange",_,i);i._messageItemMessageDetailMap={};return i}m=s;b(s,t);var o=s.prototype;o.onMetadataAvailable=function e(){if(!this.content){this.content=this.createContent()}this._messageModel=l.getMessageModel();this._messageModel.bindProperty("/").attachChange(this.processMessages,this);this.processMessages()};o.processMessages=async function e(){const t=this._messageModel?.getData();const s=t.reduce((e,t)=>{const s=t.getTargets().length>0;const i=t.getTechnical();if(s&&!i){e.push({message:t})}return e},[]);if(s&&s.length>0){await this.getPageController().messageHandler.beforeShowMessageButton(s)}this.adjustMessageButtonProperties(s)};o.adjustMessageButtonProperties=function e(t){this._messageItemMessageDetailMap={};if(t&&t.length>0){const e={Error:0,Warning:1,Success:2,Information:3,None:4};let s=e.None;let i=0;const n=[];for(const a of t){const t=a.message;const o=t.getType();const r=e[o];if(r<s){s=r}if(o===g.Error){i++}n.push(this.createMessageItem(a))}this.getContent()?.setText(t.length.toString());const a=[E.Negative,E.Critical,E.Success,E.Neutral,E.Default];this.getContent()?.setType(a[s]);const o=["C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR","C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_WARNING_TOOLTIP","C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_SUCCESS","C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_INFO",""];const r=i>1?"C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_MULTIPLE_ERROR_TOOLTIP":o[s];let l=this.getTranslatedText(r);if(i>1){l=`${i}  ${l}`}this.getContent()?.setTooltip(l);if(!this.getContent()?.getVisible()){this.getContent()?.setVisible(true);this.fireEvent("visibilityChange",{visible:this.getContent()?.getVisible()})}this.createMessagePopover(n)}if(t.length===0){if(this.getContent()?.getVisible()){this.getContent()?.setVisible(false);this.fireEvent("visibilityChange",{visible:this.getContent()?.getVisible()})}}};o.createMessageItem=function e(t){const s=t.message;const i=c(n,{title:s.getMessage(),description:s.getDescription(),type:s.getType(),markupDescription:true,longtextUrl:s.getDescriptionUrl(),subtitle:s.getAdditionalText(),groupName:t.groupName||this.getTranslatedText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_GENERAL"),activeTitle:s.getControlIds().length>0||typeof t.activeTitleHandler==="function"});this._messageItemMessageDetailMap[i.getId()]=t;return i};o.createMessagePopover=function e(t){this._messagePopover?.destroy();this._messagePopover=c(a,{groupItems:true,activeTitlePress:e=>{const t=e.getParameter("item");this.handleActiveTitlePress(t)},children:{items:t}});this.getContent()?.addDependent(this._messagePopover);setTimeout(()=>{this._messagePopover.openBy(this.getContent())},0)};o.handleActiveTitlePress=function t(s){if(s){const e=this._messageItemMessageDetailMap[s?.getId()];if(e.activeTitleHandler){e.activeTitleHandler(e.message)}else{const t=e.message.getControlId();const s=r.getElementById(t);if(s){s.focus()}}}else{e.error("message item not found!")}};o.toggleMessagePopover=function e(){this._messagePopover.toggle(this.content)};o.createContent=function e(){return c(i,{visible:"false",press:this.toggleMessagePopover.bind(this)})};return s}(s),_=S(h.prototype,"visibilityChange",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),h))||f);m=C;return m},false);
//# sourceMappingURL=MessageButton.js.map