{"version":3,"file":"ShareAPI.js","names":["ShareAPI","_dec","defineUI5Class","interfaces","_dec2","property","type","_dec3","defaultValue","_class","_class2","_MacroAPI","_this","_len","arguments","length","args","Array","_key","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_inheritsLoose","_proto","prototype","getOverflowToolbarConfig","canOverflow","onBeforeEnterOverflow","oControl","getContent","getText","resourceModel","getResourceModel","onAfterExitOverflow","priority","setVisibility","async","visibility","default","CollaborationHelper","__ui5_require_async","isTeamsModeActive","content","setVisible","visible","Log","info","Promise","resolve","addStyleClass","style","menuButton","getAggregation","MacroAPI","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./ShareAPI.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport { defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport type MenuButton from \"sap/m/MenuButton\";\n\nimport type { EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport type FormElementWrapper from \"sap/fe/core/controls/FormElementWrapper\";\nimport { getResourceModel } from \"sap/fe/core/helpers/ResourceModelHelper\";\nimport type OverflowToolbarMenuButton from \"sap/m/OverflowToolbarMenuButton\";\nimport type Control from \"sap/ui/core/Control\";\nimport MacroAPI from \"../MacroAPI\";\n/**\n * Building block used to create the ‘Share’ functionality.\n * {@link demo:sap/fe/core/fpmExplorer/index.html#/buildingBlocks/features/shareDefault Overview of Building Blocks}\n * <br>\n * Please note that the 'Share in SAP Jam' option is only available on platforms that are integrated with SAP Jam.\n * <br>\n * If you are consuming this building block in an environment where the SAP Fiori launchpad is not available, then the 'Save as Tile' option is not visible.\n *\n *\n * Usage example:\n * <pre>\n * &lt;macros:Share\n * id=\"someID\"\n * visible=\"true\"\n * /&gt;\n * </pre>\n * @alias sap.fe.macros.ShareAPI\n * @since 1.108.0\n */\n@defineUI5Class(\"sap.fe.macros.share.ShareAPI\", {\n\tinterfaces: [\"sap.m.IOverflowToolbarContent\"]\n})\nclass ShareAPI extends MacroAPI {\n\t/**\n\t * The identifier of the 'Share' building block\n\t *\n\t */\n\t@property({ type: \"string\" })\n\tid!: string;\n\n\t/**\n\t * Whether the 'Share' building block is visible or not.\n\t *\n\t */\n\t@property({ type: \"boolean\", defaultValue: true })\n\tvisible!: boolean;\n\n\t/**\n\t * Returns properties for the interface IOverflowToolbarContent.\n\t * @returns Returns the configuration of IOverflowToolbarContent\n\t */\n\tgetOverflowToolbarConfig(): object {\n\t\treturn {\n\t\t\tcanOverflow: true,\n\t\t\tonBeforeEnterOverflow: function (oControl: Object): void {\n\t\t\t\t((oControl as EnhanceWithUI5<FormElementWrapper>)?.getContent() as OverflowToolbarMenuButton).getText =\n\t\t\t\t\tfunction (): string {\n\t\t\t\t\t\tconst resourceModel = getResourceModel(oControl as Control);\n\t\t\t\t\t\treturn resourceModel.getText(\"M_COMMON_SAPFE_ACTION_SHARE\");\n\t\t\t\t\t};\n\t\t\t},\n\t\t\tonAfterExitOverflow: function (oControl: Object): void {\n\t\t\t\t((oControl as EnhanceWithUI5<FormElementWrapper>)?.getContent() as OverflowToolbarMenuButton).getText =\n\t\t\t\t\tfunction (): string {\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\t};\n\t\t\t},\n\t\t\tpriority: \"High\"\n\t\t};\n\t}\n\n\t/**\n\t * Sets the visibility of the 'Share' building block based on the value.\n\t * If the 'Share' building block is used in an application that's running in Microsoft Teams,\n\t * this function does not have any effect,\n\t * since the 'Share' building block handles the visibility on it's own in that case.\n\t * @param visibility The desired visibility to be set\n\t * @returns Promise which resolves with the instance of ShareAPI\n\t */\n\tasync setVisibility(visibility: boolean): Promise<this> {\n\t\tconst { default: CollaborationHelper } = await import(\"sap/suite/ui/commons/collaboration/CollaborationHelper\");\n\t\tconst isTeamsModeActive = await CollaborationHelper.isTeamsModeActive();\n\t\t// In case of teams mode share should not be visible\n\t\t// so we do not do anything\n\t\tif (!isTeamsModeActive) {\n\t\t\tthis.content.setVisible(visibility);\n\t\t\tthis.visible = visibility;\n\t\t} else {\n\t\t\tLog.info(\"Share Building Block: visibility not changed since application is running in teams mode!\");\n\t\t}\n\t\treturn Promise.resolve(this);\n\t}\n\n\t/**\n\t * Adds style class to MenuButton. Requested by the toolbars that contain the Share Button.\n\t * @param style\n\t * @returns Returns the reference to the MenuButton\n\t */\n\taddStyleClass(style: string): this {\n\t\tconst menuButton = this.getAggregation(\"content\") as MenuButton;\n\t\tmenuButton.addStyleClass(style);\n\t\treturn this;\n\t}\n}\nexport default ShareAPI;\n"],"mappings":";;;;84CAUA,IAsBMA,GAAQC,EAHbC,EAAe,+BAAgC,CAC/CC,WAAY,CAAC,mCACZC,EAMAC,EAAS,CAAEC,KAAM,WAAWC,EAO5BF,EAAS,CAAEC,KAAM,UAAWE,aAAc,OAAOP,EAAAQ,GAAAC,EAAA,SAAAC,GAAA,SAAAX,IAAA,IAAAY,EAAA,QAAAC,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAA,CAAAF,EAAAE,GAAAJ,UAAAI,EAAA,CAAAN,EAAAD,EAAAQ,KAAAC,QAAAJ,IAAAI,KAXlDC,EAAAT,EAAA,KAAAU,EAAAV,GAOAS,EAAAT,EAAA,UAAAW,EAAAX,GAAA,OAAAA,CAAA,CAAAY,EAAAxB,EAAAW,GAAA,IAAAc,EAAAzB,EAAA0B,UAOAD,EAIAE,yBAAA,SAAAA,IACC,MAAO,CACNC,YAAa,KACbC,sBAAuB,SAAUC,IAC9BA,GAAiDC,cAA2CC,QAC7F,WACC,MAAMC,EAAgBC,EAAiBJ,GACvC,OAAOG,EAAcD,QAAQ,8BAC9B,CACF,EACAG,oBAAqB,SAAUL,IAC5BA,GAAiDC,cAA2CC,QAC7F,WACC,MAAO,EACR,CACF,EACAI,SAAU,OAEZ,EAEAX,EAQMY,cAANC,eAAMD,EAAcE,GACnB,MAAQC,QAASC,SAA8BC,EAAO,0DACtD,MAAMC,QAA0BF,EAAoBE,oBAGpD,IAAKA,EAAmB,CACvBvB,KAAKwB,QAAQC,WAAWN,GACxBnB,KAAK0B,QAAUP,CAChB,KAAO,CACNQ,EAAIC,KAAK,2FACV,CACA,OAAOC,QAAQC,QAAQ9B,KACxB,EAEAK,EAKA0B,cAAA,SAAAA,EAAcC,GACb,MAAMC,EAAajC,KAAKkC,eAAe,WACvCD,EAAWF,cAAcC,GACzB,OAAOhC,IACR,EAAC,OAAApB,CAAA,CA1DiD,CAZ5BuD,GAAQjC,EAAAkC,EAAA9C,EAAAgB,UAAA,MAAAtB,GAAA,CAAAqD,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAArC,EAAAiC,EAAA9C,EAAAgB,UAAA,WAAAnB,GAAA,CAAAkD,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAlD,KAAAD,GAAA,OAwEhBT,CAAQ","ignoreList":[]}