/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/TitleHelper","sap/fe/macros/CommonHelper","sap/fe/macros/field/FieldTemplating","sap/m/library","sap/ui/base/ManagedObject","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,o,i,r,a,s,c,u,l){"use strict";var d={};var f=u.bindingParser;var g=s.getTextBindingExpression;var p=s.formatValueRecursively;var b=s.addTextArrangementToBindingExpression;var m=r.getTitleBindingExpression;var v=o.UI;var y=o.Draft;var S=n.getInvolvedDataModelObjects;var E=t.ActionType;var C=e.resolveBindingString;var A=e.pathInModel;var h=e.or;var O=e.not;var I=e.ifElse;var x=e.getExpressionFromAnnotation;var F=e.equal;var T=e.constant;var D=e.compileExpression;var $=e.and;const V=c.ButtonType;const P=function(e,t,n){return m(e,g,undefined,n,t)};d.getExpressionForTitle=P;const B=function(e,t){let n=x(t?.Description?.Value);if(t?.Description?.Value?.$target?.annotations?.Common?.Text?.annotations?.UI?.TextArrangement){n=b(n,e)}const o=D(p(n,e));return o==="undefined"?"":o};d.getExpressionForDescription=B;const M=function(e,t){const n=e.resourceModel.getText("T_OP_OBJECT_PAGE_SAVE");const o=e.resourceModel.getText("T_OP_OBJECT_PAGE_CREATE");let i;if(t.startingEntitySet.annotations.Session?.StickySessionSupported){i=I(v.IsCreateMode,o,n)}else{i=I(y.IsNewObject,o,n)}return D(i)};d.getExpressionForSaveButton=M;const w=function(e,t){return t.resourceModel.getText("HEADER_FORM_LABEL",[e])};d.getExpressionForLabelOnHeaderForm=w;const H=function(e){const t=["Primary","DefaultApply","Secondary","ForAction","ForNavigation","SwitchToActiveObject","SwitchToDraftObject","DraftActions","Copy","Standard"];return!t.includes(e.type??"")};d.isManifestAction=H;const j=function(e){const t=e.targetEntityType?.annotations?.UI?.Identification;const n=t?.filter(e=>e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.Criticality)||[];const o=n.length?n.map(e=>{const t=x(e.Criticality);return $(O(F(x(e.annotations?.UI?.Hidden),true)),h(F(t,"UI.CriticalityType/Negative"),F(t,"1"),F(t,1),F(t,"UI.CriticalityType/Positive"),F(t,"3"),F(t,3)))}):[T(false)];return D(I(h(...o),V.Ghost,V.Emphasized))};d.buildEmphasizedButtonExpression=j;const G=function(e){const t=l.getNavigationPath(e);if(t){return"{path:'"+t+"'}"}else{return"{path: ''}"}};d.getElementBinding=G;const N=function(e){if(e.annotations?.Common?.DraftRoot?.EditAction){return true}else{return false}};d.checkDraftState=N;const R=function(e){if(e.annotations?.Common?.DraftRoot?.ShareAction){return true}else{return false}};d.checkCollaborationDraftRoot=R;const U=function(e){if(N(e)){if(R(e)){return D($(A("HasActiveEntity"),v.IsEditable))}else{return D($(F(A("DraftAdministrativeData/DraftIsCreatedByMe"),true),v.IsEditable,O(v.IsCreateMode)))}}else{return false}};d.getSwitchToActiveVisibility=U;const Q=function(e){if(N(e)){if(R(e)){return D($(A("HasDraftEntity"),O(v.IsEditable)))}else{return D($(F(A("DraftAdministrativeData/DraftIsCreatedByMe"),true),O(v.IsEditable),O(v.IsCreateMode),A("HasDraftEntity")))}}else{return false}};d.getSwitchToDraftVisibility=Q;const _=function(e){if(N(e)){if(R(e)){return D(I(A("IsActiveEntity"),A("HasDraftEntity"),A("HasActiveEntity")))}else{return D($(F(A("DraftAdministrativeData/DraftIsCreatedByMe"),true),O(v.IsCreateMode)))}}else{return false}};d.getSwitchDraftAndActiveVisibility=_;const L=function(e,t){let n;if(e&&e.length){n=e.find(function(e){return e.type===t})}return n};d._findAction=L;const k=function(e){const t=L(e,"Secondary");return t?t.enabled:"false"};d.getDeleteCommandExecutionEnabled=k;const z=function(e){const t=L(e,"Secondary");return t?t.visible:"false"};d.getDeleteCommandExecutionVisible=z;const q=function(e){const t=L(e,"Primary");return t?t.visible:"false"};d.getEditCommandExecutionVisible=q;const J=function(e){const t=L(e,"Primary");return t?t.enabled:"false"};d.getEditCommandExecutionEnabled=J;const W=function(e){const t=e.getPath();const n=t.split("/");const o="/"+n[1];const i=e.getObject(o+"@");const r=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftRoot");const a=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftNode");const s=i.hasOwnProperty("@com.sap.vocabularies.Session.v1.StickySessionSupported");let c;if(r){c=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftRoot/EditAction`)}else if(a){c=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftNode/EditAction`)}else if(s){c=e.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`)}return!c?c:`${o}/${c}`};d.getEditAction=W;const K=function(e,t){let n,o,i;if(e&&e["@Org.OData.Core.V1.Computed"]){n=e["@Org.OData.Core.V1.Computed"].Bool?e["@Org.OData.Core.V1.Computed"].Bool=="true":true}if(e&&e["@Org.OData.Core.V1.Immutable"]){o=e["@Org.OData.Core.V1.Immutable"].Bool?e["@Org.OData.Core.V1.Immutable"].Bool=="true":true}i=n||o;if(t){i=i||t=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"}if(i){return true}else{return false}};d.isReadOnlyFromStaticAnnotations=K;const X=function(e){let t;if(e){if(f(e)){t="%"+e+" === 1 "}}if(t){return"{= "+t+"? false : true }"}else{return undefined}};d.readOnlyExpressionFromDynamicAnnotations=X;const Y=function(e,t,n,o,i){t=ee(t,n,i);const r=e?.[t]?.["navigation"];if(r){if(r["targetOutbound"]&&r["targetOutbound"]["outbound"]||r["targetOutbound"]&&r["targetOutbound"]["outbound"]&&r["targetSections"]){return".handlers.onDataPointTitlePressed($controller, ${$source>/},'"+JSON.stringify(o)+"','"+r["targetOutbound"]["outbound"]+"','"+i+"' )"}else if(r["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(r["targetSections"])+"')"}else{return undefined}}};d.getExpressionForMicroChartTitlePress=Y;const Z=function(e,t,n,o){t=ee(t,n,o);const i=e?.[t]?.["navigation"];if(i&&(i["targetOutbound"]||i["targetOutbound"]&&i["targetSections"])){return"External"}else if(i&&i["targetSections"]){return"InPage"}else{return"None"}};d.getMicroChartTitleAsLink=Z;const ee=function(e,t,n){if(t?.targetObject?.$Type==="com.sap.vocabularies.UI.v1.PresentationVariantType"){e=t.targetObject?.Visualizations[0]?.value;e=n?`${n}/${e}`:e}return e};d.getMicroChartControlConfigurationPath=ee;const te=function(e,t,n){const o=e[t],i=["Heroes","Decoration","Workers","LongRunners"];let r=n;if(o&&o.requestGroupId&&i.some(function(e){return e===o.requestGroupId})){r="$auto."+o.requestGroupId}return r};d.getGroupIdFromConfig=te;const ne=function(e,t,n,o,i){t=ee(t,n,o);return te(e,t,i)};d.getGroupIdFromConfigForMicroChart=ne;const oe=function(e,t){const n=te(e,t);let o;if(n){o="{ path : '', parameters : { $$groupId : '"+n+"' } }"}return o};d.getBindingWithGroupIdFromConfig=oe;const ie=function(e){let t;const n=i.getAlternateAndSecondaryKeys(e?.targetEntityType,e?.targetEntitySet);if(n?.length){t={path:""};t.parameters={$select:n.join(",")||""}}return JSON.stringify(t)};d.createBindingForAlternateAndSecondaryKeys=ie;const re=function(e){return e&&e.length===1&&!!e[0].isValueMultilineText};d.doesFieldGroupContainOnlyOneMultiLineDataField=re;const ae=function(e){return e.showBreadCrumbs&&e.fclEnabled!==undefined?"{fclhelper>/breadCrumbIsVisible}":e.showBreadCrumbs};d.getVisibleExpressionForBreadcrumbs=ae;const se=function(e){if(e.isShareButtonVisibleForMyInbox===false){return"false"}const t=e.fclEnabled?$(A("/showShareIcon","fclhelper"),O(v.IsCreateMode)):O(v.IsCreateMode);return D(t)};d.getShareButtonVisibility=se;const ce=function(e,t,n,o){const i=e?K(e,n):true;const r=X(n);if(!i&&!r){return true}const a=t?K(t,o):true;const s=X(o);if(!a&&!s){return true}if(i&&a&&!r&&!s){return false}if(r&&!s){return r}else if(!r&&s){return s}else{return ue(n,o)}};d.getVisiblityOfHeaderInfo=ce;const ue=function(e,t){return"{= %"+e+" === 1 ? ( %"+t+" === 1 ? false : true ) : true }"};d.combineTitleAndDescriptionExpression=ue;const le=function(){const e="${$view>/}.getBindingContext()",t="${$view>/}.byId('fe::ObjectPage').data('ObjectPageSubtitle')",n="${$view>/}.byId('fe::ObjectPage').data('ObjectPageDescription')";const o={title:t,description:n};return a.generateFunction(".editFlow.deleteDocument",e,a.objectToString(o))};d.getPressExpressionForDelete=le;const de=function(e,t,n){const o=a.addSingleQuotes(e&&e.Action),i=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],r=i==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const s={contexts:"${$view>/}.getBindingContext()",entitySetName:a.addSingleQuotes(t),invocationGrouping:a.addSingleQuotes(r),model:"${$source>/}.getModel()",label:a.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return a.generateFunction(".handlers.onCallAction","${$view>/}",o,a.objectToString(s))};d.getPressExpressionForEdit=de;const fe=function(e,t,n){const o=e.targetObject;const i=a.addSingleQuotes(o.Action);const r={contexts:"${$view>/}.getBindingContext()",entitySetName:a.addSingleQuotes(t),invocationGrouping:a.addSingleQuotes(o.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated"),model:"${$source>/}.getModel()",label:a.addSingleQuotes(o.Label,true),isNavigable:n.isNavigable,defaultValuesExtensionFunction:n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return a.generateFunction(".handlers.onCallAction","${$view>/}",i,a.objectToString(r))};d.getPressExpressionForFooterAnnotationAction=fe;const ge=function(e,t,n,o,i,r,s){const c=a.addSingleQuotes(e?.Action.toString()??""),u=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],l=u==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const d={contexts:"${$view>/}.getBindingContext()",entitySetName:t?a.addSingleQuotes(t):"",invocationGrouping:a.addSingleQuotes(l),model:"${$source>/}.getModel()",label:a.addSingleQuotes(e?.Label?.toString()??"",true),isNavigable:n?.isNavigable,defaultValuesExtensionFunction:n?.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};const f={positiveActionVisible:o,positiveActionEnabled:i,editActionVisible:r,editActionEnabled:s};return a.generateFunction(".handlers.onPrimaryAction","$controller","${$view>/}","${$view>/}.getBindingContext()",c,a.objectToString(d),a.objectToString(f))};d.getPressExpressionForPrimaryAction=ge;const pe=function(e,t){if(t&&t.Facet&&t.Facet.targetAnnotationType==="DataPoint"){return oe(e,t.Facet.targetAnnotationValue)}};d.getStashableHBoxBinding=pe;const be=function(e){if(e?.targetObject?.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return undefined}return"Bare"};d.getHeaderFormHboxRenderType=be;function me(e,t,n,o){if(t.defaultAction){const e=t.defaultAction;try{switch(e.type){case"ForAction":{return de(n,o,t.defaultAction)}case"ForNavigation":{if(e.command){return"cmd:"+e.command}else{return e.press}}default:{if(e.command){return"cmd:"+e.command}if(e.noWrap){return e.press}else{return a.buildActionWrapper(e,{id:"forTheObjectPage"})}}}}catch(e){return"binding for the default action is not working as expected"}}return undefined}d.getDefaultActionHandler=me;function ve(e){return e.isPartOfPreview===true||e.presentation.visualizations[0].type!=="Table"}d.isVisualizationIsPartOfPreview=ve;const ye=function(e,t){const n=e.getInterface(1).getModel();const o=e=>{if(e.length){return e.map(e=>C(e.visible??true,"boolean"))}return[T(false)]};const i=e=>{const t=e.annotationPath;if(t){const e=n.getContext(t);return S(e)}return undefined};const r=t.filter(e=>e.type===E.DataFieldForAction);const a=o(t.filter(e=>H(e)));const s=o(r);const c=!!r.find(e=>{const t=i(e);return!t?.targetObject?.annotations?.UI?.Hidden});return D(h(c,h(...a),$(h(v.IsEditable,h(...s)),O(A("isCreateDialogOpen","internal")))))};d.getFooterVisibilityExpression=ye;function Se(e,t){if(t){if(!e.showSubSectionTitle){return"H4"}else if(e.level===2&&e.dataVisualizationTitleVisible==="true"){return"H6"}else{return"H5"}}else if(!e.showSubSectionTitle){return"H3"}else if(e.level===2&&e.dataVisualizationTitleVisible==="true"){return"H5"}else{return"H4"}}d.getHeaderLevel=Se;ye.requiresIContext=true;return d},false);
//# sourceMappingURL=ObjectPageTemplating.js.map