/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/helpers/KeepAliveHelper","sap/fe/core/library","sap/fe/navigation/library","sap/ui/Device","sap/ui/mdc/p13n/StateUtil"],function(e,t,i,n,r,a){"use strict";const o=n.NavType,s=i.VariantManagement,l=i.TemplateContentView;const g={_bSearchTriggered:false,applyInitialStateOnly:function(){return true},onBeforeStateApplied:function(e,t){const i=this.getView(),n=i.getController(),r=n._getFilterBarControl(),a=n._getControls("table");if(r){r.setSuspendSelection(true);e.push(r.waitForInitialization());if(t===o.hybrid){this._clearFilterConditions(r)}}a.forEach(function(t){e.push(t.initialized())});delete this._bSearchTriggered},adaptBindingRefreshControls:function(e){const i=this.base.getView(),n=i.getController(),r=n._getControls(),a=t.getControlsForRefresh(i,r);Array.prototype.push.apply(e,a)},adaptStateControls:function(e){const t=this.base.getView(),i=t.getController();const n=this._getFilterBarVM(t);if(n){e.push(n)}if(i._isMultiMode()){e.push(i._getMultiModeControl())}if(i._hasMultiVisualizations()){e.push(i._getSegmentedButton(l.Chart));e.push(i._getSegmentedButton(l.Table))}e.push(t.byId("fe::ListReport"))},retrieveAdditionalStates:function(e){const t=this.getView(),i=t.getController(),n=t.getBindingContext("internal").getProperty("hasPendingFilters");e.dataLoaded=!n||!!this._bSearchTriggered;if(i._hasMultiVisualizations()){const i=t.getBindingContext("internal").getProperty("alpContentView");e.alpContentView=i}delete this._bSearchTriggered},applyAdditionalStates:function(e){const t=this.getView(),i=t.getController(),n=i._getFilterBarControl();if(e){if(n){const t=n.getParent();if(n.getLiveMode()||e.dataLoaded===true){t.triggerSearch();this._bSearchTriggered=true}else if(e.dataLoaded===false){n._bSearchTriggered=false}}if(i._hasMultiVisualizations()){const i=t.getBindingContext("internal");if(!r.system.desktop&&e.alpContentView==l.Hybrid){e.alpContentView=l.Chart}i.getModel().setProperty(`${i.getPath()}/alpContentView`,e.alpContentView)}}},_getFilterBarVM:e=>{let t;const i=e.getViewData();switch(i.variantManagement){case s.Page:t=e.byId("fe::PageVariantManagement");break;case s.Control:t=e.getController()._getFilterBarVariantControl();break;case s.None:default:break}return t},_fnClearStateBeforexAppNav:async function(t){return a.retrieveExternalState(t).then(e=>{const t=e.filter;for(const e in t){if(e!=="$editState"&&e!=="$search"&&t[e]){t[e].forEach(e=>{e["filtered"]=false})}}return t}).catch(function(t){e.error("Error while retrieving the external state",t)})},_clearFilterConditions:async function(e){const t=[];return e.waitForInitialization().then(async()=>{const i=await this._fnClearStateBeforexAppNav(e);return a.applyExternalState(e,{filter:i,items:t})})}};return g},false);
//# sourceMappingURL=ViewState.js.map