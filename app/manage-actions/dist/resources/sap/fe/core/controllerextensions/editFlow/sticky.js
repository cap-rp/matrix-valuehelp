/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/helpers/ResourceModelHelper","sap/fe/core/library","sap/m/MessageBox","sap/ui/core/Lib","../../converters/MetaModelConverter","./operations/Operation"],function(e,t,o,n,r,i,s,a){"use strict";var c=s.convertTypes;var d=o.getResourceModel;const g=n.ProgrammingModel;function f(e,t){const o=u(e,t);const n=e.getModel().getMetaModel(),r=`${n.getMetaPath(e.getPath())}/${o}`,i=n.createBindingContext(r);return c(n).resolvePath(i.getPath()).target}function u(e,t){const o=e.getModel(),n=o.getMetaModel(),r=n.getMetaPath(e.getPath());return n.getObject(`${r}@com.sap.vocabularies.Session.v1.StickySessionSupported/${t}`)}async function l(e,t,o){const n="EditAction";const r=f(e,n);if(r){const i=await new a(t,e.getModel(),r,{messageHandler:o,contexts:[e],label:d(t).getText("C_COMMON_OBJECT_PAGE_EDIT"),skipMessages:true,oDataProperties:{disableSideEffects:true,ignoreETag:e.getObject()===undefined,groupId:"direct",replaceWithRVC:e.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"),deferredSubmit:false},bindingParameters:{$$inheritExpandSelect:true}}).execute();if(i[0].status==="rejected"){throw new Error(i[0].reason)}else{const o=i[0].value.returnedContext;if(o){const r=t.getSideEffectsService().getODataActionSideEffects(u(e,n),o);if(r?.triggerActions&&r.triggerActions.length){await t.getSideEffectsService().requestSideEffectsForODataAction(r,o)}}return o}}else{throw new Error(`Edit Action for Sticky Session not found for ${n}`)}}async function S(t,o,n){const r="SaveAction";const i=t.getModel(),s=i.getMetaModel(),c=s.getMetaPath(t.getPath());const g=f(t,r);if(g){const r=await new a(o,t.getModel(),g,{messageHandler:n,contexts:[t],label:d(o).getText("C_OP_OBJECT_PAGE_SAVE"),skipMessages:true,oDataProperties:{disableSideEffects:true,ignoreETag:t.getObject()===undefined,groupId:"direct",replaceWithRVC:t.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"),deferredSubmit:false}}).execute();if(r[0].status==="rejected"){const n=s.getObject(`${c}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`);if(n){try{await o.getSideEffectsService().requestSideEffects([n],t)}catch(t){e.error("Error while requesting side effects",t)}}throw new Error(r[0].reason)}else if(r[0].value.returnedContext===undefined){throw new Error(`Save Action for Sticky Session doesn't return a context for ${c}`)}return r[0].value.returnedContext}else{throw new Error(`Save Action for Sticky Session not found for ${c}`)}}async function M(e){const t=e.getModel(),o=t.getMetaModel(),n=o.getMetaPath(e.getPath()),r=o.getObject(`${n}@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction`);if(!r){throw new Error(`Discard Action for Sticky Session not found for ${n}`)}const i=t.bindContext(`/${r}(...)`);return i.execute("$single").then(function(){return e})}function p(o,n,s){const a=t.getIsEditable(n),c=i.getResourceBundleFor("sap.fe.templates"),d=c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),f=c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),u=c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(s===g.Sticky&&a){return r.warning(d,{actions:[f,u],emphasizedAction:f,onClose:function(t){if(t===f){e.info("Navigation confirmed.");o()}else{e.info("Navigation rejected.")}}})}return o()}const A={editDocumentInStickySession:l,activateDocument:S,discardDocument:M,processDataLossConfirmation:p};return A},false);
//# sourceMappingURL=sticky.js.map