/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/CommonUtils","sap/fe/core/controls/DataWatcher","sap/ui/base/Object","sap/ui/core/Component","sap/ui/model/json/JSONModel"],function(e,t,n,i,r,o,a,l){"use strict";var s,c,u,p,d,f,g,v,w;var h=n.property;var b=n.defineUI5Class;var m=t.pathInModel;var y=t.compileExpression;function _(e,t,n,i){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(i):void 0})}function x(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,P(e,t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function C(e,t,n,i,r){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce(function(n,i){return i(e,t,n)||n},o),r&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(r):void 0,o.initializer=void 0),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}function A(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let I=(s=b("sap.fe.core.ExtensionAPI"),c=h({type:"sap.fe.core.controllerextensions.EditFlow"}),u=h({type:"sap.fe.core.controllerextensions.Routing"}),p=h({type:"sap.fe.core.controllerextensions.IntentBasedNavigation"}),s(d=(f=function(t){function n(e,n){var i;i=t.call(this)||this;_(i,"editFlow",g,i);_(i,"routing",v,i);_(i,"intentBasedNavigation",w,i);i._controller=e;i._view=e.getView();i.extension=i._controller.extension;i.editFlow=i._controller.editFlow;i.routing=i._controller.routing;i._routing=i._controller._routing;i.intentBasedNavigation=i._controller.intentBasedNavigation;i._prefix=n;return i}x(n,t);var o=n.prototype;o.getEditFlow=function e(){return this.editFlow};o.getRouting=function e(){return this.routing};o.getIntentBasedNavigation=function e(){return this.intentBasedNavigation};o.byId=function e(t){let n=this._view.byId(t);if(!n&&this._prefix){n=this._view.byId(`${this._prefix}--${t}`)}if(!n){return undefined}if(!n.isA("sap.fe.macros.MacroAPI")){let e=n.getParent();while(e){if(e.isA("sap.fe.macros.form.FormAPI")){break}if(e.isA("sap.fe.macros.MacroAPI")){throw new Error(`You attempted to access an internal control. This is risky and might change later. Instead access its stable API by using ID ${e.getId()}`)}e=e.getParent()}}return n};o.getModel=function e(t){let n;if(t&&t!=="ui"){n=i.getAppComponent(this._view);if(!n.getManifestEntry("sap.ui5").models[t]){return undefined}}return this._view.getModel(t)};o.addDependent=function e(t){this._view.addDependent(t)};o.removeDependent=function e(t){this._view.removeDependent(t)};o.navigateToTarget=function e(t,n){this._controller._routing.navigateToTarget(n,t)};o.loadFragment=async function t(n){var r=this;const o=a.getOwnerComponentFor(this._view);await o.getService("templatedViewService");const s=this._view.getModel("_pageModel");const c=this._view.getModel("sap.fe.i18n");const u=o.getMetaModel();const p=o.getViewData();const d=o.getEntitySet()?`/${o.getEntitySet()}`:o.getContextPath();const f=new l(p),g={bindingContexts:{contextPath:u?.createBindingContext(n.contextPath||d),converterContext:s.createBindingContext("/",undefined,{noResolve:true}),viewData:p?f.createBindingContext("/"):null},models:{contextPath:u,converterContext:s,metaModel:u,viewData:f,"sap.fe.i18n":c},appComponent:i.getAppComponent(this._view)};let v;if(n.controller&&!n.controller?.isA?.("sap.fe.core.ExtensionAPI")){const e=this.getMetadata().getClass().extend(n.id+"-controller",{});for(const t in n.controller){const i=n.controller[t];if(i?.bind){const a=i.bind(n.controller);if(o){e.prototype[t]=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++){t[n]=arguments[n]}return o.runAsOwner(()=>a.apply(r,t))}}else{e.prototype[t]=a}}else{Object.defineProperty(e.prototype,t,{get(){return n.controller?.[t]},set(e){if(n.controller){n.controller[t]=e}}})}}v=new e(this._controller);const t=v.isA;v.isA=e=>t.bind(v)(e)||this.isA(e)}else{v=n.controller??this}return o.runAsOwner(async()=>{const t=i.templateControlFragment(n.name,g,{controller:v,isXML:false,id:n.id,containingView:this._view,contextPath:n.contextPath??d});try{const e=await t;if(n.initialBindingContext!==undefined){e.setBindingContext(n.initialBindingContext)}this.addDependent(e);return e}catch(t){e.error(t)}})};o.updateAppState=async function e(){const t=this._controller.getView();const n=this._controller.getAppComponent();const i=await n.getAppStateHandler().createAppState({viewId:t.getId()});return i?.appStateData};o.runWithFPMContext=function e(t){const n=a.getOwnerComponentFor(this._view);return n.runAsOwner(t)};o.watchProperty=function e(t,n){this._view.addDependent(new r({propertyBinding:y(m(t)),valueChanged:e=>{n(e.getParameter("value"),e.getParameter("oldValue"),e.getParameter("isInitial"),e.getParameter("context"))}}))};return n}(o),g=C(f.prototype,"editFlow",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),v=C(f.prototype,"routing",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),w=C(f.prototype,"intentBasedNavigation",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),f))||d);return I},false);
//# sourceMappingURL=ExtensionAPI.js.map