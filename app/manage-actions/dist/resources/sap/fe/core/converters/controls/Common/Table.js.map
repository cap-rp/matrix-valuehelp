{"version":3,"file":"Table.js","names":["getTableActions","lineItemAnnotation","visualizationPath","converterContext","standardActions","navigationSettings","isCollaborationEnabled","ModelHelper","isCollaborationDraftSupportedFromConverterContext","tableActions","getTableAnnotationActions","manifestActions","getActionsFromManifest","getManifestControlConfiguration","actions","copyActions","filter","a","type","ActionType","Copy","annotationActions","annotationAndStandardActions","create","delete","massEdit","insights","creationRow","cut","copy","paste","moveUp","moveDown","action","undefined","manifestAction","Object","values","Default","Menu","position","anchor","StandardActionKeys","Create","placement","Placement","Before","manifestActionEntries","entries","standardManifestActions","fromEntries","_ref","key","startsWith","nonStandardManifestActions","_ref2","actionOverwriteConfig","isNavigable","OverrideType","overwrite","enableOnSelect","enableAutoScroll","enabled","visible","visibleForContextMenu","defaultValuesExtensionFunction","command","menu","annotationMenuActionItems","getAnnotationMenuActionItems","matchingManifestActions","getMatchingManifestAction","overwrittenMenuActionItems","insertCustomElements","prepareMenuActions","removeDuplicateActions","getVisibilityEnablementMenuActions","addCollaborationCondition","commandActions","_exports","getContextDefiningPropertiesFromAggregationAnnotation","aggregationHelper","customAggregateAnnotations","getCustomAggregateDefinitions","customAggregatedefinitions","forEach","annotation","aggregatedProperty","_entityType","entityProperties","find","property","name","qualifier","contextDefiningProperties","annotations","Aggregation","ContextDefiningProperties","map","ctxDefProperty","value","getExtensionInfoFromEntityType","entityType","tableColumns","AggregationHelper","isAnalyticsSupported","currencyOrUnitProperties","Set","column","tableColumn","unit","targetUnitProperty","prop","add","relativePath","contextDefiningPropertiesFromAggregation","result","propertyInfos","rawContextDefiningProperties","fromGroupableProperty","isPropertyGroupable","has","contextDefiningPropertyName","foundColumn","findColumnByPath","push","length","additionalProperties","updateTableVisualizationForType","tableVisualization","presentationVariantAnnotation","control","aggregationData","columns","enableAnalytics","enable$select","enable$$getKeepAliveContext","analyticsExtensions","_updatePropertyInfosWithAggregatesDefinitions","allowedTransformations","getAllowedTransformations","enableBasicSearch","includes","groupConditions","getGroupConditions","aggregateConditions","getAggregateConditions","Log","error","changeSiblingForRootsSupported","Hierarchy","hierarchyQualifier","ChangeSiblingForRootsSupported","allowDropBetweenNodes","ChangeNextSiblingAction","isObjectPathDraftSupported","getDataModelObjectPath","requestAtLeast","analyticalConfiguration","aggregationOnLeafLevel","isDraftRoot","getEntitySet","getManifestWrapper","isFclEnabled","enableUploadPlugin","streamProperty","getAnnotationEntityType","UI","MediaResource","Stream","$target","uploadAction","uploadTable","stream","fileName","Core","ContentDisposition","Filename","path","fileNameMaxLength","maxLength","acceptableMediaTypes","AcceptableMediaTypes","createRequestedProperties","lineItem","operationAvailable","selectedFields","pushField","fieldName","origin","indexOf","pushFieldList","fields","field","operationAvailableProperties","split","validProperties","propName","resolvePath","semanticKeys","Common","SemanticKey","semanticKey","capabilitiesAnnotation","Capabilities","alternateAndSecondaryKeys","getAlternateAndSecondaryKeys","RequestAtLeast","propertyPath","getNavigationAvailableFieldsFromLineItem","DeleteRestrictions","Deletable","UpdateRestrictions","Updatable","record","$Type","Inline","Determining","isPathAnnotationExpression","NavigationAvailable","getNavigationTargetPath","navigationPropertyPath","manifestWrapper","getNavigationConfiguration","navConfig","keys","dataModelPath","contextPath","getContextPath","navConfigForContextPath","targetEntitySet","startingEntitySet","getSemanticKeysAndTitleInfo","headerInfoTitlePath","HeaderInfo","Title","Value","semanticKeyAnnotations","headerInfoTypeName","TypeName","semanticKeyColumns","oColumn","createTableVisualization","params","isCondensedTableLayoutCompliant","selectionVariantAnnotation","tableManifestConfig","getTableManifestConfiguration","splitPath","navigationTargetPath","getTableColumns","operationAvailableMap","getOperationAvailableMap","semanticKeysAndHeaderInfoTitle","standardActionsConfiguration","getStandardActionsConfiguration","tableAnnotation","getTableAnnotationConfiguration","getOperationAvailableProperties","header","title","oVisualization","VisualizationType","Table","JSON","stringify","headerInfoTitle","headerVisible","handlePatchSent","getTemplateType","TemplateType","ListReport","updateLinkedProperties","createDefaultTableVisualization","isBlankTable","getColumnsFromEntityType","getEntityType","creationMode","ActionHelper","getCurrentEntitySetUpdatablePath","restrictions","getRestrictions","entitySet","updatable","isUpdatable","isOnlyDynamicOnCurrentEntity","isConstant","expression","navigationExpression","_type","updatableExpression","updatablePropertyPath","properties","actionName","propertyName","size","titleProperty","Array","from","join","getUIHiddenExpForActionsRequiringContext","currentEntityType","contextDataModelObjectPath","aUiHiddenPathExpressions","dataField","ActionTarget","isBound","sourceEntityType","RequiresContext","valueOf","Hidden","equal","getHiddenExpressionAtTableLevel","getPathFromActionAnnotation","source","constant","substring","splitPathForNavigationProperty","navigationPath","isNavigationProperty","targetObject","partner","pathInModel","slice","updateManifestActionAndTagIt","dataFieldId","some","actionKey","requiresSelection","hasBoundActionsAlwaysVisibleInToolBar","manifestActionId","generate","Action","SemanticObject","Actions","hasCustomActionsAlwaysVisibleInToolBar","customActions","reduce","menuAction","toString","getVisibleExpForCustomActionsRequiringContext","aVisiblePathExpressions","resolveBindingString","getCapabilityRestriction","isDeletable","isPathDeletable","isPathUpdatable","getSelectionMode","isEntitySet","targetCapabilities","deleteButtonVisibilityExpression","massEditVisibilityExpression","arguments","cutButtonVisibilityExpression","tableManifestSettings","tableType","tableSettings","selectionMode","SelectionMode","Multi","None","compileExpression","ifElse","ForceMulti","ForceSingle","Single","aHiddenBindingExpressions","aVisibleBindingExpressions","isParentDeletable","parentEntitySetDeletable","ObjectPage","bMassEditEnabled","Auto","buttonVisibilityExpression","or","and","IsEditable","editModebuttonVisibilityExpression","concat","copyDataField","getCopyAction","dataFieldIsCopyAction","annotationPath","getEntitySetBasedAnnotationPath","fullyQualifiedName","KeyHelper","generateKeyFromDataField","visibleExpression","visibleForContextMenuExpression","text","Label","Library","getResourceBundleFor","getText","isDataFieldForActionAbstract","tableAction","getDataFieldAnnotationAction","isDataFieldForActionGroup","dataFieldGroup","DataFieldForAction","isAIOperation","isActionAIOperation","_useEnabledExpression","getEnabledForAnnotationAction","DataFieldForIntentBasedNavigation","id","isMenuAIOperation","getHighlightRowBinding","criticalityAnnotation","isDraftRootOrNode","targetEntityType","defaultHighlightRowDefinition","MessageType","getExpressionFromAnnotation","getMessageTypeFromCriticalityType","formatResult","Entity","HasActive","IsActive","IsInactive","tableFormatters","rowHighlighting","getExternalCreationBehavior","tableManifestConfiguration","creationDetails","outboundKey","outboundCreation","outbound","outboundDetail","getOutboundNavigationEntries","mode","CreationMode","External","warning","NewPage","_getCreationBehaviour","externalBehavior","originalTableSettings","navigationDetails","detail","CreationDialog","newAction","targetAnnotations","targetAnnotationsCommon","targetAnnotationsSession","Session","DraftRoot","NewAction","StickySessionSupported","CreationRow","Error","route","append","createAtEnd","navigateToTarget","info","_getRowConfigurationProperty","targetPath","aggregationOnLeafLevelenabled","navigationInfo","criticalityProperty","Criticality","navigationTarget","display","target","getDraftRoot","getDraftNode","checkEditable","routePath","recreateContext","rowNavigatedExpression","navigatedRow","actionType","rowNavigated","rowCriticalityForInsights","criticalityExpressionForIntegrationCards","not","isNodeLevelNavigable","createTechnicalProperty","relatedAdditionalPropertyNameMap","columnExists","additionalProperty","technicalColumn","ColumnType","Annotation","label","dataType","availability","sortable","isGroupable","isKey","exportSettings","caseSensitive","aggregatable","filterable","extension","technicallyGroupable","technicallyAggregatable","getP13nMode","variantManagement","getVariantManagement","modes","isAnalyticalTable","isResponsiveTable","personalization","sort","group","aggregate","VariantManagementType","Control","_isFilterBarHidden","isFilterBarHidden","hasMultipleVisualizations","AnalyticalListPage","getSortConditions","nonSortableProperties","getRestrictionsOnProperties","sortConditions","sorters","SortOrder","condition","conditionProperty","Property","infoName","convertPropertyPathsToInfoNames","descending","Descending","getInitialExpansionLevel","level","InitialExpansionLevel","paths","infoNames","propertyInfo","annotationColumn","currentPath","groupLevels","GroupBy","aGroupBy","propertyNameFromAnalyticsInfo","_getPropertyNameFromAnalyticsInfo","aggregatablePropertyDefinition","additionalPropertyInfos","additionalPropertyInfo","_updateForTextOnlyPropertiesWithCDP","textArrangement","textProperty","analyticsInfoPropertyNameForDesc","columnWithTextOnly","textOnlyColumn","extensionInfoMap","Total","aTotals","creationBehaviour","standardActionsContext","generateStandardActionsContext","getCutVisibility","getDeleteVisibility","massEditButtonVisibilityExpression","getMassEditVisibility","isInsertUpdateActionsTemplated","getInsertUpdateActionsTemplating","isDraftOrStickySupported","getStandardActionCut","getStandardActionCopy","getStandardActionCreate","getStandardActionDelete","getStandardActionPaste","getStandardActionMassEdit","getStandardActionInsights","getCreationRow","configuration","getStandardActionMoveUpDown","typeNamePlural","TypeNamePlural","pageManifestSettings","hasAbsolutePath","p13nMode","getTableID","threshold","MaxItems","isSearchable","isPathSearchable","apiId","entityName","entityTypeName","collection","getTargetObjectPath","row","displayMode","isInDisplayMode","searchable","initialExpansionLevel","requiredProperties","getRequiredProperties","targetNavigationPropertyPath","lastIndexOf","getSelectionVariantConfiguration","selectionVariantPath","resolvedTarget","getEntityTypeAnnotation","selection","propertyNames","SelectOptions","selectOption","PropertyName","Text","_getFullScreenBasedOnDevice","isIphone","enableFullScreen","getDiagnostics","addIssue","IssueCategory","Manifest","IssueSeverity","Low","IssueType","FULLSCREENMODE_NOT_ON_LISTREPORT","_getMultiSelectMode","multiSelectMode","selectAll","useIconTabBar","_getTableMode","isTemplateListReport","rowCountMode","rowCount","_getCondensedTableLayout","_tableType","_tableSettings","condensedTableLayout","_getTableSelectionLimit","selectionLimit","_getTableInlineCreationRowCount","inlineCreationRowCount","_getEnableExport","enablePaste","enableExport","_getFrozenColumnCount","frozenColumnCount","_getWidthIncludingColumnHeader","widthIncludingColumnHeader","getFilterConfiguration","hideTableTitle","filters","quickVariantSelection","quickFilterPaths","filterPaths","quickFilters","showCounts","hiddenFilters","sEntityType","useEnabledExpression","OperationAvailable","overloadAction","sourceType","staticAction","parameters","isCollection","updateTreeTableManifestConfiguration","tableConfiguration","dataModelObjectPath","hierarchyParentNavigationPropertyPath","getHierarchyParentNavigationPropertyPath","nonUpdatableNavigationProperties","getNonUpdatableNavigationProperties","isHierarchyParentNodeUpdatable","isNodeMovable","getCustomFunctionInfo","isNodeCopyable","isMoveToPositionAllowed","isCopyToPositionAllowed","createEnablement","isCreateEnabled","nodeType","nodeTypeInfo","creationDialogFields","getFieldList","creationFields","createInPlace","lastDotIndex","moduleName","replace","methodName","additionalRequiredModules","getOptimisticBatchSettingsFromManifest","disableRequestCache","getMassEditSettings","defaultFieldConfiguration","visibleFields","ignoredFields","operationGroupingMode","OperationGroupingMode","Isolated","ChangeSet","enableMassEdit","customFragment","fromInline","fieldGroup","isAnnotationOfType","Data","isDataField","trim","checkCondensedLayout","_manifestWrapper","globalFEManifestSettings","getSapFeManifestConfiguration","defaultCreationMode","macros","table","InlineCreationRows","enableAutoColumnWidth","isPhone","disableCopyToClipboard","templateType","isCondensedLayoutCompliant","oFilterConfiguration","customValidationFunction","exportRequestSize","getTableType","tableRowMode","defaultScrollThreshold","inlineCreationRowsHiddenInEditMode","useTextForNoDataMessages","getUseTextForNoDataMessages","oConfiguration","hasDataStateIndicatorFilter","disableAddRowButtonForEmptyData","enablePastingOfComputedProperties","readOnly","enableAddCardToInsights","showRowCount","getViewConfiguration","useCondensedTableLayout","isCompactType","modeForNoDataMessage","scrollThreshold","beforeRebindTable","selectionChange","rowPress"],"sources":["./Table.ts"],"sourcesContent":["import type { EntitySet, EntityType, PathAnnotationExpression, PropertyAnnotationValue, PropertyPath } from \"@sap-ux/vocabularies-types\";\nimport type { EntitySetAnnotations_Common } from \"@sap-ux/vocabularies-types/vocabularies/Common_Edm\";\nimport type { EntitySetAnnotations_Session } from \"@sap-ux/vocabularies-types/vocabularies/Session_Edm\";\nimport type {\n\tCriticality,\n\tDataFieldAbstractTypes,\n\tDataFieldForAction,\n\tDataFieldForActionAbstractTypes,\n\tDataFieldForActionGroup,\n\tDataFieldForActionTypes,\n\tDataFieldForIntentBasedNavigation,\n\tDataFieldTypes,\n\tFieldGroup,\n\tLineItem,\n\tPresentationVariantType,\n\tSelectOptionType,\n\tSelectionVariant,\n\tSelectionVariantType\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { UIAnnotationTerms, UIAnnotationTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport type { BindingToolkitExpression, CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport {\n\tand,\n\tcompileExpression,\n\tconstant,\n\tequal,\n\tformatResult,\n\tgetExpressionFromAnnotation,\n\tifElse,\n\tisConstant,\n\tnot,\n\tor,\n\tpathInModel,\n\tresolveBindingString\n} from \"sap/fe/base/BindingToolkit\";\nimport type { PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport {\n\tisDataField,\n\tisDataFieldForActionAbstract,\n\tisDataFieldForActionGroup,\n\tvisibleExpression\n} from \"sap/fe/core/converters/annotations/DataField\";\nimport type {\n\tAnnotationAction,\n\tAnnotationActionGroup,\n\tBaseAction,\n\tCombinedAction,\n\tCustomAction,\n\tOverrideTypeAction\n} from \"sap/fe/core/converters/controls/Common/Action\";\nimport {\n\taddCollaborationCondition,\n\tdataFieldIsCopyAction,\n\tgetActionsFromManifest,\n\tgetAnnotationMenuActionItems,\n\tgetCopyAction,\n\tgetEnabledForAnnotationAction,\n\tgetMatchingManifestAction,\n\tgetVisibilityEnablementMenuActions,\n\tisActionAIOperation,\n\tisMenuAIOperation,\n\tprepareMenuActions,\n\tremoveDuplicateActions\n} from \"sap/fe/core/converters/controls/Common/Action\";\nimport { OverrideType, Placement, insertCustomElements } from \"sap/fe/core/converters/helpers/ConfigurableObject\";\nimport { IssueCategory, IssueSeverity, IssueType } from \"sap/fe/core/converters/helpers/IssueManager\";\nimport { KeyHelper } from \"sap/fe/core/converters/helpers/Key\";\nimport { Entity, UI } from \"sap/fe/core/helpers/BindingHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { isAnnotationOfType, isNavigationProperty, isPathAnnotationExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport { criticalityExpressionForIntegrationCards } from \"sap/fe/core/templating/CriticalityFormatters\";\nimport {\n\tgetHierarchyParentNavigationPropertyPath,\n\tgetNonUpdatableNavigationProperties,\n\tgetTargetObjectPath,\n\tisPathDeletable,\n\tisPathSearchable,\n\tisPathUpdatable,\n\ttype DataModelObjectPath\n} from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { getRestrictionsOnProperties } from \"sap/fe/core/templating/EntitySetHelper\";\n// eslint-disable-next-line @typescript-eslint/no-restricted-imports\nimport tableFormatters from \"sap/fe/macros/formatters/TableFormatter\";\n// eslint-disable-next-line @typescript-eslint/no-restricted-imports\nimport ActionHelper from \"sap/fe/macros/internal/helpers/ActionHelper\";\nimport Library from \"sap/ui/core/Lib\";\nimport MessageType from \"sap/ui/core/message/MessageType\";\nimport type FormContainer from \"sap/ui/layout/form/FormContainer\";\nimport type ConverterContext from \"../../ConverterContext\";\nimport type {\n\tManifestAction,\n\tNavigationSettingsConfiguration,\n\tNavigationTargetConfiguration,\n\tTableManifestConfiguration,\n\tTableManifestSettingsConfiguration\n} from \"../../ManifestSettings\";\nimport {\n\tActionType,\n\tCreationMode,\n\tOperationGroupingMode,\n\tSelectionMode,\n\tTemplateType,\n\tVariantManagementType,\n\tVisualizationType\n} from \"../../ManifestSettings\";\nimport type ManifestWrapper from \"../../ManifestWrapper\";\nimport { AggregationHelper } from \"../../helpers/Aggregation\";\nimport { getTableID } from \"../../helpers/ID\";\nimport { getMessageTypeFromCriticalityType } from \"./Criticality\";\nimport {\n\tColumnType,\n\tfindColumnByPath,\n\tgetColumnsFromEntityType,\n\tgetRequiredProperties,\n\tgetTableColumns,\n\tupdateLinkedProperties,\n\ttype AnnotationTableColumn,\n\ttype ExtensionForAnalytics,\n\ttype TableColumn\n} from \"./table/Columns\";\nimport type { StandardAction } from \"./table/StandardActions\";\nimport {\n\tStandardActionKeys,\n\tgenerateStandardActionsContext,\n\tgetCreationRow,\n\tgetCutVisibility,\n\tgetDeleteVisibility,\n\tgetInsertUpdateActionsTemplating,\n\tgetMassEditVisibility,\n\tgetRestrictions,\n\tgetStandardActionCopy,\n\tgetStandardActionCreate,\n\tgetStandardActionCut,\n\tgetStandardActionDelete,\n\tgetStandardActionInsights,\n\tgetStandardActionMassEdit,\n\tgetStandardActionMoveUpDown,\n\tgetStandardActionPaste,\n\tisDraftOrStickySupported,\n\tisInDisplayMode\n} from \"./table/StandardActions\";\n\ntype UploadTableSettings = {\n\tstream: string;\n\tfileName?: string;\n\tfileNameMaxLength?: int;\n\tacceptableMediaTypes?: string[];\n\tmaxLength?: int;\n\tuploadAction?: StandardAction;\n};\n\ntype RowNavigationInfo =\n\t| {\n\t\t\ttype: \"Outbound\";\n\t\t\tnavigationTarget: string;\n\t\t\tnavigationInEditMode?: boolean;\n\t  }\n\t| {\n\t\t\ttype: \"Navigation\";\n\t\t\ttargetPath: string;\n\t\t\tcheckEditable: boolean;\n\t\t\trecreateContext: boolean;\n\t\t\troutePath: string;\n\t\t\tnavigationInEditMode?: boolean;\n\t  };\n\ntype RowConfiguration = {\n\tactionType?: string;\n\tnavigationInfo?: RowNavigationInfo;\n\trowHighlighting: CompiledBindingToolkitExpression;\n\trowNavigated: CompiledBindingToolkitExpression;\n\trowCriticalityForInsights?: CompiledBindingToolkitExpression;\n\tvisible?: CompiledBindingToolkitExpression;\n};\n\nexport type MassEditTableConfiguration = {\n\tenabled: boolean;\n\tvisibleFields: string[];\n\tignoredFields: string[];\n\toperationGroupingMode: OperationGroupingMode;\n\tcustomFragment?: string | FormContainer;\n\tfromInline?: boolean;\n};\n\ntype TableSortConditions = {\n\tsorters: {\n\t\tname: string;\n\t\tdescending: boolean;\n\t}[];\n};\n\ntype TableGroupConditions = {\n\tgroupLevels: { name: string }[];\n};\n\ntype TableAggregateConditions = Record<string, object>;\n\ntype TableP13nMode = \"Aggregate\" | \"Column\" | \"Filter\" | \"Group\" | \"Sort\";\n\nexport type AnalyticalConfiguration = {\n\taggregationOnLeafLevel?: boolean;\n};\n\nexport type TableAnnotationConfiguration = {\n\tcollection: string;\n\tvariantManagement: VariantManagementType;\n\tfilterId?: string;\n\tid: string;\n\tapiId: string;\n\tnavigationPath: string;\n\tp13nMode?: TableP13nMode[];\n\trow?: RowConfiguration;\n\tselectionMode: string | undefined;\n\tisInsertUpdateActionsTemplated: boolean;\n\tupdatablePropertyPath: string;\n\tdisplayMode?: boolean;\n\tthreshold: number;\n\tentityName: string;\n\tentityTypeName: string;\n\tsortConditions?: TableSortConditions;\n\tgroupConditions?: TableGroupConditions;\n\taggregateConditions?: TableAggregateConditions;\n\tinitialExpansionLevel?: number;\n\tallowDropBetweenNodes?: boolean;\n\tchangeSiblingForRootsSupported?: boolean;\n\t/** Create new entries */\n\tcreate: CreateBehavior | CreateBehaviorExternal;\n\ttitle: string | undefined;\n\tsearchable: boolean;\n\trequiredProperties?: string[];\n\tuploadTable?: UploadTableSettings;\n};\n/**\n * New entries are created within the app (default case)\n */\nexport type CreateBehavior = {\n\tmode: CreationMode;\n\tappend: boolean;\n\tnewAction?: string;\n\tnavigateToTarget?: string;\n};\n\nexport type ExternalMethodConfig = {\n\tmoduleName: string;\n\tmethodName: string;\n};\n/**\n * New entries are created by navigating to some target\n */\nexport type CreateBehaviorExternal = {\n\tmode: \"External\";\n\toutbound: string;\n\toutboundDetail: NavigationTargetConfiguration[\"outboundDetail\"];\n};\nexport type TableCapabilityRestriction = {\n\tisDeletable: boolean;\n\tisUpdatable: boolean;\n};\nexport type TableFiltersConfiguration = {\n\tpaths: {\n\t\tannotationPath: string;\n\t}[];\n\tshowCounts?: boolean;\n};\nexport type SelectionVariantConfiguration = {\n\tpropertyNames: string[];\n\ttext?: string;\n};\n\nexport type TableControlConfiguration = {\n\tdisableRequestCache?: boolean;\n\tcreateAtEnd: boolean;\n\tcreateInPlace?: boolean;\n\tcreationMode: CreationMode;\n\toutboundCreation?: string;\n\tdisableAddRowButtonForEmptyData: boolean;\n\tcustomValidationFunction: string | undefined;\n\tuseCondensedTableLayout: boolean;\n\tenableExport: boolean;\n\tenablePastingOfComputedProperties?: boolean;\n\tfrozenColumnCount?: number;\n\twidthIncludingColumnHeader?: boolean;\n\theader?: string;\n\theaderVisible?: boolean;\n\tfilters?: Partial<Record<\"quickFilters\" | \"hiddenFilters\", TableFiltersConfiguration>>;\n\ttype: TableType;\n\trowCountMode?: TableRowCountMode;\n\trowCount?: number;\n\tscrollThreshold?: number;\n\tselectAll?: boolean;\n\tselectionLimit: number;\n\tmultiSelectMode: string | undefined;\n\tenablePaste: boolean;\n\tignoredFields?: string;\n\treadOnly?: boolean;\n\tdisableCopyToClipboard?: boolean;\n\tenableFullScreen: boolean;\n\tshowRowCount: boolean;\n\tinlineCreationRowCount?: number;\n\tinlineCreationRowsHiddenInEditMode?: boolean;\n\tmassEdit: MassEditTableConfiguration;\n\tenableAutoColumnWidth: boolean;\n\thasDataStateIndicatorFilter: boolean;\n\tisCompactType?: boolean;\n\thierarchyQualifier?: string;\n\tisHierarchyParentNodeUpdatable?: boolean;\n\tenableAddCardToInsights?: boolean | undefined;\n\tcreationDialogFields?: string[];\n\tnodeType?: {\n\t\tpropertyName: string;\n\t\tvalues: { value: string; text: string; creationDialogFields?: string[] }[];\n\t};\n\tcreateEnablement?: ExternalMethodConfig;\n\tisNodeMovable?: ExternalMethodConfig;\n\tisNodeCopyable?: ExternalMethodConfig;\n\tisMoveToPositionAllowed?: ExternalMethodConfig;\n\tisCopyToPositionAllowed?: ExternalMethodConfig;\n\tselectionChange?: string;\n\tadditionalRequiredModules?: string[];\n\trowPress?: string;\n\tbeforeRebindTable?: string;\n\texportRequestSize?: number;\n\tenableUploadPlugin?: boolean;\n\tmodeForNoDataMessage?: string;\n\tanalyticalConfiguration?: AnalyticalConfiguration;\n};\nexport type TableType = \"GridTable\" | \"ResponsiveTable\" | \"AnalyticalTable\" | \"TreeTable\";\nexport type TableRowCountMode = \"Auto\" | \"Fixed\" | \"Interactive\";\n\nexport type InternalExtensionForAnalytics = ExtensionForAnalytics & {\n\tfromGroupableProperty: boolean;\n\trelativePath: string;\n};\nexport type TableVisualization = {\n\ttype: VisualizationType.Table;\n\tannotation: TableAnnotationConfiguration;\n\tcontrol: TableControlConfiguration;\n\tcolumns: TableColumn[];\n\tactions: BaseAction[];\n\tcommandActions?: Record<string, CustomAction>;\n\tanalyticsExtensions?: Record<string, InternalExtensionForAnalytics>;\n\trequestAtLeast: RequestAtLeast;\n\tenableAnalytics?: boolean;\n\tenableBasicSearch?: boolean;\n\toperationAvailableMap: string;\n\toperationAvailableProperties: string;\n\theaderInfoTitle: string;\n\tsemanticKeys: string[];\n\theaderInfoTypeName: PropertyAnnotationValue<String> | undefined;\n\tenable$select: boolean;\n\tenable$$getKeepAliveContext: boolean;\n\tisInsightsEnabled?: boolean;\n\theader?: string;\n\theaderVisible?: boolean;\n\thandlePatchSent: boolean;\n};\n\n/**\n * Returns an array of all standard, annotation-based, and manifest-based table actions.\n * @param lineItemAnnotation\n * @param visualizationPath\n * @param converterContext\n * @param standardActions\n * @param navigationSettings\n * @returns The complete table actions\n */\nexport function getTableActions(\n\tlineItemAnnotation: LineItem,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tstandardActions: StandardActionsConfiguration[\"standardActions\"],\n\tnavigationSettings?: NavigationSettingsConfiguration\n): CombinedAction {\n\t// 1. Get actions from annotations\n\tconst isCollaborationEnabled = ModelHelper.isCollaborationDraftSupportedFromConverterContext(converterContext);\n\n\tconst tableActions = getTableAnnotationActions(lineItemAnnotation, visualizationPath, converterContext);\n\t// 2. Get actions from manifest\n\tconst manifestActions = getActionsFromManifest(\n\t\tconverterContext.getManifestControlConfiguration<TableManifestConfiguration>(visualizationPath).actions as Record<\n\t\t\tstring,\n\t\t\tManifestAction\n\t\t>,\n\t\tconverterContext,\n\t\ttableActions.tableActions,\n\t\tnavigationSettings,\n\t\ttrue\n\t);\n\t// The \"Copy\" action always needs to be placed after the \"Create\" action, so we need to separate it\n\tconst copyActions = tableActions.tableActions.filter((a) => a.type === ActionType.Copy);\n\tconst annotationActions = tableActions.tableActions.filter((a) => a.type !== ActionType.Copy);\n\t// Combine standard, annotation, and custom actions together, respecting the fixed order of standard actions\n\tconst annotationAndStandardActions = (\n\t\t[\n\t\t\t...annotationActions,\n\t\t\tstandardActions.create,\n\t\t\t...copyActions,\n\t\t\tstandardActions.delete,\n\t\t\tstandardActions.massEdit,\n\t\t\tstandardActions.insights,\n\t\t\tstandardActions.creationRow, // Not templated as a button\n\t\t\tstandardActions.cut,\n\t\t\tstandardActions.copy,\n\t\t\tstandardActions.paste,\n\t\t\tstandardActions.moveUp,\n\t\t\tstandardActions.moveDown\n\t\t] as BaseAction[]\n\t).filter((action) => action !== undefined);\n\t// Anchor all non-anchored manifest custom actions/menus before the standard actions\n\tfor (const manifestAction of Object.values(manifestActions.actions)) {\n\t\tif ((manifestAction.type === ActionType.Default || manifestAction.type === ActionType.Menu) && !manifestAction.position?.anchor) {\n\t\t\tmanifestAction.position = {\n\t\t\t\tanchor: StandardActionKeys.Create,\n\t\t\t\tplacement: Placement.Before\n\t\t\t};\n\t\t}\n\t}\n\t// Insert twice to allow regular override for non-standard actions and positional override for standard actions\n\tconst manifestActionEntries = Object.entries(manifestActions.actions);\n\tconst standardManifestActions = Object.fromEntries(manifestActionEntries.filter(([key]) => key.startsWith(\"StandardAction::\")));\n\tconst nonStandardManifestActions = Object.fromEntries(manifestActionEntries.filter(([key]) => !standardManifestActions[key]));\n\tconst actionOverwriteConfig: OverrideTypeAction = {\n\t\tisNavigable: OverrideType.overwrite,\n\t\tenableOnSelect: OverrideType.overwrite,\n\t\tenableAutoScroll: OverrideType.overwrite,\n\t\tenabled: OverrideType.overwrite,\n\t\tvisible: OverrideType.overwrite,\n\t\tvisibleForContextMenu: OverrideType.overwrite,\n\t\tdefaultValuesExtensionFunction: OverrideType.overwrite,\n\t\tcommand: OverrideType.overwrite,\n\t\tposition: OverrideType.overwrite,\n\t\tmenu: OverrideType.overwrite\n\t};\n\t// 3. Get all annotation menu items\n\tconst annotationMenuActionItems = getAnnotationMenuActionItems(annotationActions);\n\t// 4. Find manifest actions which override any annotation menu items\n\tconst matchingManifestActions = getMatchingManifestAction(annotationMenuActionItems, manifestActions.actions);\n\t// 5. Get overridden annotation menu items\n\tconst overwrittenMenuActionItems = insertCustomElements(annotationMenuActionItems, matchingManifestActions, actionOverwriteConfig);\n\t// 6. Override all actions\n\tlet actions = insertCustomElements(annotationAndStandardActions, nonStandardManifestActions, actionOverwriteConfig) as CustomAction[];\n\tactions = insertCustomElements(actions, standardManifestActions, {\n\t\tposition: OverrideType.overwrite\n\t});\n\t// 7. Replace original menu items with their corresponding overridden menu items\n\tprepareMenuActions(actions, overwrittenMenuActionItems);\n\t// 8. Remove duplicate actions which are menu items\n\tactions = removeDuplicateActions(actions);\n\t// 9. Hide menus where all menu items are hidden\n\tactions = getVisibilityEnablementMenuActions(actions);\n\t// 10. Add the collaboration condition for actions other than navigation\n\tif (isCollaborationEnabled) {\n\t\taddCollaborationCondition(actions);\n\t}\n\n\treturn {\n\t\tactions: actions,\n\t\tcommandActions: manifestActions.commandActions\n\t};\n}\n\n//Returns the ContextDefiningProperties from the custom aggregate annotation or from the aggregation annotation on the property itself.\nfunction getContextDefiningPropertiesFromAggregationAnnotation(aggregationHelper: AggregationHelper): Record<string, string[]> {\n\tconst customAggregateAnnotations = aggregationHelper.getCustomAggregateDefinitions();\n\tconst customAggregatedefinitions: Record<string, string[]> = {};\n\tcustomAggregateAnnotations.forEach((annotation) => {\n\t\tconst aggregatedProperty = aggregationHelper._entityType.entityProperties.find((property) => {\n\t\t\treturn property.name === annotation.qualifier;\n\t\t});\n\t\tif (aggregatedProperty) {\n\t\t\tconst contextDefiningProperties =\n\t\t\t\tannotation.annotations?.Aggregation?.ContextDefiningProperties ??\n\t\t\t\taggregatedProperty.annotations.Aggregation?.ContextDefiningProperties;\n\t\t\tcustomAggregatedefinitions[aggregatedProperty.name] =\n\t\t\t\tcontextDefiningProperties?.map((ctxDefProperty) => ctxDefProperty.value) ?? [];\n\t\t}\n\t});\n\treturn customAggregatedefinitions;\n}\n\n/**\n * Retrieve the extension information for all aggregable properties .\n * @param entityType The target entity type.\n * @param tableColumns The array of columns for the entity type.\n * @param converterContext The converter context.\n * @returns The aggregate definitions from the entityType, or undefined if the entity doesn't support analytical queries.\n */\nexport const getExtensionInfoFromEntityType = function (\n\tentityType: EntityType,\n\ttableColumns: TableColumn[],\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): Record<string, InternalExtensionForAnalytics> | undefined {\n\tconst aggregationHelper = new AggregationHelper(entityType, converterContext);\n\tif (!aggregationHelper.isAnalyticsSupported()) {\n\t\treturn undefined;\n\t}\n\t// Keep a set of all currency/unit properties, as we don't want to consider them as aggregates\n\t// They are aggregates for technical reasons (to manage multi-units situations) but it doesn't make sense from a user standpoint\n\tconst currencyOrUnitProperties = new Set();\n\ttableColumns.forEach((column) => {\n\t\tconst tableColumn = column as AnnotationTableColumn;\n\t\tif (tableColumn.unit) {\n\t\t\tconst targetUnitProperty = tableColumns.find((prop) => prop.name === tableColumn.unit) as AnnotationTableColumn;\n\t\t\tcurrencyOrUnitProperties.add(targetUnitProperty.relativePath);\n\t\t}\n\t});\n\tconst contextDefiningPropertiesFromAggregation = getContextDefiningPropertiesFromAggregationAnnotation(aggregationHelper);\n\tconst result: Record<string, InternalExtensionForAnalytics> = {};\n\ttableColumns.forEach((column) => {\n\t\tconst tableColumn = column as AnnotationTableColumn;\n\t\tconst property = entityType.entityProperties.find((prop) => prop.name === tableColumn.relativePath);\n\n\t\tif (tableColumn.propertyInfos !== undefined || !tableColumn.relativePath) {\n\t\t\t// Ignore complex columns\n\t\t\treturn;\n\t\t}\n\n\t\tlet rawContextDefiningProperties = contextDefiningPropertiesFromAggregation[tableColumn.relativePath] as string[] | undefined;\n\n\t\t// if there is no custom aggregate definition, and the property is groupable, then we can use the default context defining properties\n\t\tlet fromGroupableProperty = false;\n\t\tif (!rawContextDefiningProperties && property && !!aggregationHelper.isPropertyGroupable(property)) {\n\t\t\tfromGroupableProperty = true;\n\t\t\trawContextDefiningProperties = property.annotations.Aggregation?.ContextDefiningProperties?.map(\n\t\t\t\t(ctxDefProperty) => ctxDefProperty.value\n\t\t\t);\n\t\t}\n\n\t\tif (!rawContextDefiningProperties || currencyOrUnitProperties.has(tableColumn.relativePath)) {\n\t\t\t// Ignore aggregates corresponding to currencies or units of measure\n\t\t\treturn;\n\t\t}\n\n\t\tresult[tableColumn.name] = {\n\t\t\tfromGroupableProperty: fromGroupableProperty,\n\t\t\trelativePath: tableColumn.relativePath\n\t\t};\n\t\tconst contextDefiningProperties: string[] = [];\n\t\trawContextDefiningProperties.forEach((contextDefiningPropertyName) => {\n\t\t\t// Ignore context-defining properties corresponding to currencies or units of measure of aggregatable properties\n\t\t\t// (but this is allowed for groupable properties)\n\t\t\tif (!fromGroupableProperty && currencyOrUnitProperties.has(contextDefiningPropertyName)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst foundColumn = findColumnByPath(contextDefiningPropertyName, tableColumns);\n\t\t\tif (foundColumn) {\n\t\t\t\tcontextDefiningProperties.push(foundColumn.name);\n\t\t\t}\n\t\t});\n\t\tif (contextDefiningProperties.length) {\n\t\t\tresult[tableColumn.name].additionalProperties = contextDefiningProperties;\n\t\t}\n\t});\n\treturn result;\n};\n/**\n * Updates a table visualization for analytical use cases.\n * @param tableVisualization The visualization to be updated\n * @param entityType The entity type displayed in the table\n * @param converterContext The converter context\n * @param presentationVariantAnnotation The presentationVariant annotation (if any)\n */\nexport function updateTableVisualizationForType(\n\ttableVisualization: TableVisualization,\n\tentityType: EntityType,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tpresentationVariantAnnotation?: PresentationVariantType\n): void {\n\tif (tableVisualization.control.type === \"AnalyticalTable\") {\n\t\tconst aggregationData = getExtensionInfoFromEntityType(entityType, tableVisualization.columns, converterContext),\n\t\t\taggregationHelper = new AggregationHelper(entityType, converterContext);\n\t\tif (aggregationData) {\n\t\t\ttableVisualization.enableAnalytics = true;\n\t\t\ttableVisualization.enable$select = false;\n\t\t\ttableVisualization.enable$$getKeepAliveContext = false;\n\t\t\ttableVisualization.analyticsExtensions = aggregationData;\n\t\t\t_updatePropertyInfosWithAggregatesDefinitions(tableVisualization);\n\t\t\tconst allowedTransformations = aggregationHelper.getAllowedTransformations();\n\t\t\ttableVisualization.enableBasicSearch = allowedTransformations ? allowedTransformations.includes(\"search\") : true;\n\t\t\t// Add group and sort conditions from the presentation variant\n\t\t\ttableVisualization.annotation.groupConditions = getGroupConditions(\n\t\t\t\tpresentationVariantAnnotation,\n\t\t\t\ttableVisualization.columns,\n\t\t\t\ttableVisualization.control.type\n\t\t\t);\n\t\t\ttableVisualization.annotation.aggregateConditions = getAggregateConditions(\n\t\t\t\tpresentationVariantAnnotation,\n\t\t\t\ttableVisualization.columns,\n\t\t\t\taggregationData\n\t\t\t);\n\t\t} else {\n\t\t\tLog.error(`Aggregation not supported for this entity type: ${entityType.name}`);\n\t\t}\n\t\ttableVisualization.control.type = \"GridTable\"; // AnalyticalTable isn't a real type for the MDC:Table, so we always switch back to Grid\n\t} else if (tableVisualization.control.type === \"ResponsiveTable\") {\n\t\ttableVisualization.annotation.groupConditions = getGroupConditions(\n\t\t\tpresentationVariantAnnotation,\n\t\t\ttableVisualization.columns,\n\t\t\ttableVisualization.control.type\n\t\t);\n\t} else if (tableVisualization.control.type === \"TreeTable\") {\n\t\tconst aggregationHelper = new AggregationHelper(entityType, converterContext);\n\t\tconst allowedTransformations = aggregationHelper.getAllowedTransformations();\n\t\ttableVisualization.enableBasicSearch = allowedTransformations ? allowedTransformations.includes(\"search\") : true;\n\t\ttableVisualization.enable$$getKeepAliveContext = true;\n\t\ttableVisualization.annotation.changeSiblingForRootsSupported = (entityType?.annotations.Hierarchy?.[\n\t\t\t`RecursiveHierarchyActions#${tableVisualization.control.hierarchyQualifier ?? \"\"}`\n\t\t]?.ChangeSiblingForRootsSupported ?? true) as boolean;\n\n\t\ttableVisualization.annotation.allowDropBetweenNodes =\n\t\t\t!!entityType.annotations.Hierarchy?.[`RecursiveHierarchyActions#${tableVisualization.control.hierarchyQualifier ?? \"\"}`]\n\t\t\t\t?.ChangeNextSiblingAction;\n\t}\n\n\t// Some properties are always loaded because they are needed by our internal logic\n\t// - HasActiveEntity is needed for the row criticality expression\n\t// - HasDraftEntity is needed in LR with TreeTable and Analytical Table to navigate to the draft instance if there's one when clicking on the active instance\n\t// - HasDraftEntity and DraftAdministrativeData.InProcessByUser are needed in the LR for the delete logic\n\tif (ModelHelper.isObjectPathDraftSupported(converterContext.getDataModelObjectPath())) {\n\t\ttableVisualization.requestAtLeast[\"HasActiveEntity\"] = [\"draftKeys\"];\n\t\tif (tableVisualization.control.analyticalConfiguration?.aggregationOnLeafLevel) {\n\t\t\t// IsActiveEntity key is needed for navigation to the draft instance\n\t\t\ttableVisualization.requestAtLeast[\"IsActiveEntity\"] = [\"draftKeys\"];\n\t\t}\n\n\t\tif (ModelHelper.isDraftRoot(converterContext.getEntitySet())) {\n\t\t\ttableVisualization.requestAtLeast[\"HasDraftEntity\"] = [\"draftKeys\"];\n\t\t\tif (tableVisualization.enableAnalytics !== true && tableVisualization.control.type !== \"TreeTable\") {\n\t\t\t\t// We don't load DraftAdministrativeData for Analytical and Tree tables in LR because they display active instances only\n\t\t\t\t// (therefore no DraftAdministrativeData is available)\n\t\t\t\ttableVisualization.requestAtLeast[\"DraftAdministrativeData/InProcessByUser\"] = [\"draftKeys\"];\n\t\t\t\tif (\n\t\t\t\t\tModelHelper.isCollaborationDraftSupportedFromConverterContext(converterContext) &&\n\t\t\t\t\tconverterContext.getManifestWrapper().isFclEnabled()\n\t\t\t\t) {\n\t\t\t\t\ttableVisualization.requestAtLeast[\"DraftAdministrativeData/DraftAdministrativeUser\"] = [\"draftKeys\"];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (tableVisualization.control.enableUploadPlugin) {\n\t\tconst streamProperty = converterContext.getAnnotationEntityType().annotations?.UI?.MediaResource?.Stream?.$target;\n\t\tif (!streamProperty) {\n\t\t\tthrow \"UI.MediaResource annotation with Stream property missing\";\n\t\t}\n\n\t\t// the upload action is treated as the create action\n\t\tconst uploadAction = tableVisualization.actions.find((a) => a.key === StandardActionKeys.Create) as StandardAction;\n\n\t\ttableVisualization.annotation.uploadTable = {\n\t\t\tstream: streamProperty.name,\n\t\t\tfileName: (streamProperty.annotations.Core?.ContentDisposition?.Filename as PathAnnotationExpression<string> | undefined)?.path,\n\t\t\tfileNameMaxLength: streamProperty.annotations.Core?.ContentDisposition?.Filename?.$target?.maxLength,\n\t\t\tacceptableMediaTypes: streamProperty.annotations.Core?.AcceptableMediaTypes,\n\t\t\tmaxLength: streamProperty.maxLength,\n\t\t\tuploadAction: uploadAction\n\t\t};\n\t}\n}\n\ntype fieldOrigin =\n\t| \"semanticKey\"\n\t| \"restriction\"\n\t| \"secondaryKey\"\n\t| \"presentationVariant\"\n\t| \"navigation\"\n\t| \"operation\"\n\t| \"alternateAndSecondaryKeys\"\n\t| \"draftKeys\";\nexport type RequestAtLeast = Record<string, fieldOrigin[]>;\n\n/**\n * Creates and returns a select query with the selected fields from the parameters that were passed.\n * @param lineItem The LineItem we want the requested properties from.\n * @param converterContext The converter context.\n * @param operationAvailable A string containing the available operation, which we'll take the properties to add to the select query.\n * @param presentationVariantAnnotation The presentation variant annotation which we'll take the RequestAtLeast properties from.\n * @returns The 'select' query that has the selected fields from the parameters that were passed.\n */\nexport function createRequestedProperties(\n\tlineItem: LineItem,\n\tconverterContext: ConverterContext,\n\toperationAvailable?: string,\n\tpresentationVariantAnnotation?: PresentationVariantType\n): RequestAtLeast {\n\tconst entityType = converterContext.getAnnotationEntityType(lineItem);\n\tconst selectedFields: RequestAtLeast = {};\n\tfunction pushField(fieldName: string, origin: fieldOrigin): void {\n\t\tif (fieldName && fieldName.indexOf(\"/\") !== 0) {\n\t\t\t// Do not add singleton property (with absolute path) to $select\n\t\t\tif (!selectedFields[fieldName]) {\n\t\t\t\tselectedFields[fieldName] = [origin];\n\t\t\t} else {\n\t\t\t\tselectedFields[fieldName].push(origin);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction pushFieldList(fields: string[], origin: fieldOrigin): void {\n\t\tif (fields?.length) {\n\t\t\tfields.forEach((field) => pushField(field, origin));\n\t\t}\n\t}\n\n\tconst operationAvailableProperties = (operationAvailable || \"\").split(\",\");\n\tconst validProperties = operationAvailableProperties.filter(function (propName: string) {\n\t\treturn entityType.resolvePath(propName);\n\t});\n\tconst semanticKeys: string[] = (entityType.annotations.Common?.SemanticKey || []).map((semanticKey) => semanticKey.value);\n\tconst capabilitiesAnnotation = converterContext.getEntitySet()?.annotations?.Capabilities;\n\tconst alternateAndSecondaryKeys = ModelHelper.getAlternateAndSecondaryKeys(entityType, converterContext.getEntitySet() as EntitySet);\n\tif (presentationVariantAnnotation) {\n\t\tpushFieldList(presentationVariantAnnotation.RequestAtLeast?.map((propertyPath) => propertyPath.value), \"presentationVariant\");\n\t}\n\tpushFieldList(getNavigationAvailableFieldsFromLineItem(lineItem, entityType), \"navigation\");\n\tpushFieldList(validProperties, \"operation\");\n\tpushFieldList(semanticKeys, \"semanticKey\");\n\tpushFieldList(alternateAndSecondaryKeys, \"alternateAndSecondaryKeys\");\n\tif (capabilitiesAnnotation) {\n\t\tpushField((capabilitiesAnnotation.DeleteRestrictions?.Deletable as PathAnnotationExpression<boolean>)?.path, \"restriction\");\n\t\tpushField((capabilitiesAnnotation.UpdateRestrictions?.Updatable as PathAnnotationExpression<boolean>)?.path, \"restriction\");\n\t}\n\n\treturn selectedFields;\n}\n\n/**\n * This return the property that are available from the NavigationAvailable annotation on IBN Fields.\n * @param lineItem The line item annotation.\n * @param entityType The Entity Type.\n * @returns An array containing the properties name.\n */\nfunction getNavigationAvailableFieldsFromLineItem(lineItem: LineItem, entityType: EntityType): string[] {\n\tconst selectedFields: string[] = [];\n\tlineItem.forEach(function (record) {\n\t\tif (\n\t\t\trecord.$Type === UIAnnotationTypes.DataFieldForIntentBasedNavigation &&\n\t\t\t!record.Inline &&\n\t\t\t!record.Determining &&\n\t\t\tisPathAnnotationExpression(record.NavigationAvailable)\n\t\t) {\n\t\t\tconst path = (record.NavigationAvailable as unknown as { path: string }).path;\n\t\t\tif (entityType.resolvePath(path)) {\n\t\t\t\tselectedFields.push(path);\n\t\t\t}\n\t\t}\n\t});\n\treturn selectedFields;\n}\n\n/**\n * Get the navigation target path from manifest settings.\n * @param converterContext The converter context\n * @param navigationPropertyPath The navigation path to check in the manifest settings\n * @returns Navigation path from manifest settings\n */\nexport function getNavigationTargetPath(converterContext: ConverterContext<PageContextPathTarget>, navigationPropertyPath: string): string {\n\tconst manifestWrapper = converterContext.getManifestWrapper();\n\tif (navigationPropertyPath && manifestWrapper.getNavigationConfiguration(navigationPropertyPath)) {\n\t\tconst navConfig = manifestWrapper.getNavigationConfiguration(navigationPropertyPath);\n\t\tif (Object.keys(navConfig).length > 0) {\n\t\t\treturn navigationPropertyPath;\n\t\t}\n\t}\n\tconst dataModelPath = converterContext.getDataModelObjectPath();\n\tconst contextPath = converterContext.getContextPath();\n\tconst navConfigForContextPath = manifestWrapper.getNavigationConfiguration(contextPath);\n\tif (navConfigForContextPath && Object.keys(navConfigForContextPath).length > 0) {\n\t\treturn contextPath;\n\t}\n\treturn dataModelPath.targetEntitySet ? dataModelPath.targetEntitySet.name : dataModelPath.startingEntitySet.name;\n}\n\nfunction getSemanticKeysAndTitleInfo(converterContext: ConverterContext<PageContextPathTarget>): {\n\theaderInfoTitlePath: string;\n\tsemanticKeyColumns: string[];\n\theaderInfoTypeName: PropertyAnnotationValue<String> | undefined;\n} {\n\tconst headerInfoTitlePath = (converterContext.getAnnotationEntityType()?.annotations?.UI?.HeaderInfo?.Title as DataFieldTypes)?.Value\n\t\t?.path;\n\tconst semanticKeyAnnotations = converterContext.getAnnotationEntityType()?.annotations?.Common?.SemanticKey;\n\tconst headerInfoTypeName = converterContext?.getAnnotationEntityType()?.annotations?.UI?.HeaderInfo?.TypeName;\n\tconst semanticKeyColumns: string[] = [];\n\tif (semanticKeyAnnotations) {\n\t\tsemanticKeyAnnotations.forEach(function (oColumn) {\n\t\t\tsemanticKeyColumns.push(oColumn.value);\n\t\t});\n\t}\n\treturn { headerInfoTitlePath, semanticKeyColumns, headerInfoTypeName };\n}\nexport function createTableVisualization(\n\tlineItemAnnotation: LineItem,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tparams?: Partial<{\n\t\tpresentationVariantAnnotation: PresentationVariantType;\n\t\tselectionVariantAnnotation: SelectionVariantType;\n\t\tisCondensedTableLayoutCompliant: boolean;\n\t}>\n): TableVisualization {\n\tconst { presentationVariantAnnotation, isCondensedTableLayoutCompliant, selectionVariantAnnotation } = params ?? {};\n\tconst tableManifestConfig = getTableManifestConfiguration(\n\t\tlineItemAnnotation,\n\t\tvisualizationPath,\n\t\tconverterContext,\n\t\tisCondensedTableLayoutCompliant,\n\t\tselectionVariantAnnotation\n\t);\n\tconst { navigationPropertyPath } = splitPath(visualizationPath);\n\tconst navigationTargetPath = getNavigationTargetPath(converterContext, navigationPropertyPath);\n\tconst navigationSettings = converterContext.getManifestWrapper().getNavigationConfiguration(navigationTargetPath);\n\tconst columns = getTableColumns(lineItemAnnotation, tableManifestConfig.type, visualizationPath, converterContext);\n\tconst operationAvailableMap = getOperationAvailableMap(lineItemAnnotation, converterContext);\n\tconst semanticKeysAndHeaderInfoTitle = getSemanticKeysAndTitleInfo(converterContext);\n\tconst standardActionsConfiguration = getStandardActionsConfiguration(\n\t\tlineItemAnnotation,\n\t\tvisualizationPath,\n\t\tconverterContext,\n\t\ttableManifestConfig,\n\t\tnavigationSettings\n\t);\n\tconst tableAnnotation = getTableAnnotationConfiguration(\n\t\tlineItemAnnotation,\n\t\tvisualizationPath,\n\t\tconverterContext,\n\t\ttableManifestConfig,\n\t\tcolumns,\n\t\tnavigationSettings,\n\t\tstandardActionsConfiguration,\n\t\tpresentationVariantAnnotation\n\t);\n\tconst tableActions = getTableActions(\n\t\tlineItemAnnotation,\n\t\tvisualizationPath,\n\t\tconverterContext,\n\t\tstandardActionsConfiguration.standardActions,\n\t\tnavigationSettings\n\t);\n\tconst operationAvailable = getOperationAvailableProperties(operationAvailableMap, converterContext);\n\tlet header = tableManifestConfig.header;\n\theader ??= tableAnnotation.title === \"\" ? undefined : tableAnnotation.title;\n\tconst oVisualization: TableVisualization = {\n\t\ttype: VisualizationType.Table,\n\t\tannotation: tableAnnotation,\n\t\tcontrol: tableManifestConfig,\n\t\tactions: tableActions.actions,\n\t\tcommandActions: tableActions.commandActions,\n\t\tcolumns: columns,\n\t\toperationAvailableMap: JSON.stringify(operationAvailableMap),\n\t\toperationAvailableProperties: operationAvailable,\n\t\theaderInfoTitle: semanticKeysAndHeaderInfoTitle.headerInfoTitlePath,\n\t\tsemanticKeys: semanticKeysAndHeaderInfoTitle.semanticKeyColumns,\n\t\theaderInfoTypeName: semanticKeysAndHeaderInfoTitle.headerInfoTypeName,\n\t\tenable$select: true,\n\t\tenable$$getKeepAliveContext: true,\n\t\theader: header,\n\t\theaderVisible: tableManifestConfig.headerVisible,\n\t\trequestAtLeast: createRequestedProperties(lineItemAnnotation, converterContext, operationAvailable, presentationVariantAnnotation),\n\t\thandlePatchSent: converterContext.getManifestWrapper().getTemplateType() !== TemplateType.ListReport\n\t};\n\tupdateLinkedProperties(converterContext, columns);\n\tupdateTableVisualizationForType(\n\t\toVisualization,\n\t\tconverterContext.getAnnotationEntityType(lineItemAnnotation),\n\t\tconverterContext,\n\t\tpresentationVariantAnnotation\n\t);\n\treturn oVisualization;\n}\nexport function createDefaultTableVisualization(\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tisBlankTable?: boolean\n): TableVisualization {\n\tconst tableManifestConfig = getTableManifestConfiguration(undefined, \"\", converterContext, false);\n\tconst columns = getColumnsFromEntityType(\n\t\t{},\n\t\tconverterContext.getEntityType(),\n\t\t[],\n\t\tconverterContext,\n\t\ttableManifestConfig.type,\n\t\ttableManifestConfig.creationMode,\n\t\t{}\n\t);\n\tconst operationAvailableMap = getOperationAvailableMap(undefined, converterContext);\n\tconst semanticKeysAndHeaderInfoTitle = getSemanticKeysAndTitleInfo(converterContext);\n\tconst navigationTargetPath = getNavigationTargetPath(converterContext, \"\");\n\tconst navigationSettings = converterContext.getManifestWrapper().getNavigationConfiguration(navigationTargetPath);\n\tconst standardActionsConfiguration = getStandardActionsConfiguration(\n\t\tundefined,\n\t\t\"\",\n\t\tconverterContext,\n\t\ttableManifestConfig,\n\t\tnavigationSettings\n\t);\n\tconst oVisualization: TableVisualization = {\n\t\ttype: VisualizationType.Table,\n\t\tannotation: getTableAnnotationConfiguration(\n\t\t\tundefined,\n\t\t\t\"\",\n\t\t\tconverterContext,\n\t\t\ttableManifestConfig,\n\t\t\tisBlankTable ? [] : columns,\n\t\t\tnavigationSettings,\n\t\t\tstandardActionsConfiguration\n\t\t),\n\t\tcontrol: tableManifestConfig,\n\t\tactions: [],\n\t\tcolumns: columns,\n\t\toperationAvailableMap: JSON.stringify(operationAvailableMap),\n\t\toperationAvailableProperties: getOperationAvailableProperties(operationAvailableMap, converterContext),\n\t\theaderInfoTitle: semanticKeysAndHeaderInfoTitle.headerInfoTitlePath,\n\t\tsemanticKeys: semanticKeysAndHeaderInfoTitle.semanticKeyColumns,\n\t\theaderInfoTypeName: semanticKeysAndHeaderInfoTitle.headerInfoTypeName,\n\t\tenable$select: true,\n\t\tenable$$getKeepAliveContext: true,\n\t\theader: tableManifestConfig.header,\n\t\theaderVisible: tableManifestConfig.headerVisible,\n\t\thandlePatchSent: converterContext.getManifestWrapper().getTemplateType() !== TemplateType.ListReport,\n\t\trequestAtLeast: {}\n\t};\n\tupdateLinkedProperties(converterContext, columns);\n\tupdateTableVisualizationForType(oVisualization, converterContext.getEntityType(), converterContext);\n\treturn oVisualization;\n}\n/**\n * Gets the map of Core.OperationAvailable property paths for all DataFieldForActions.\n * @param lineItemAnnotation The instance of the line item\n * @param converterContext The instance of the converter context\n * @returns The record containing all action names and their corresponding Core.OperationAvailable property paths\n */\nfunction getOperationAvailableMap(\n\tlineItemAnnotation: LineItem | undefined,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): Record<string, unknown> {\n\treturn ActionHelper.getOperationAvailableMap(lineItemAnnotation, \"table\", converterContext);\n}\n/**\n * Gets updatable propertyPath for the current entityset if valid.\n * @param converterContext The instance of the converter context\n * @returns The updatable property for the rows\n */\nfunction getCurrentEntitySetUpdatablePath(converterContext: ConverterContext<PageContextPathTarget>): string {\n\tconst restrictions = getRestrictions(converterContext);\n\tconst entitySet = converterContext.getEntitySet();\n\tconst updatable = restrictions.isUpdatable;\n\tconst isOnlyDynamicOnCurrentEntity = !isConstant(updatable.expression) && updatable.navigationExpression._type === \"Unresolvable\";\n\tconst updatableExpression = entitySet?.annotations.Capabilities?.UpdateRestrictions?.Updatable;\n\tconst updatablePropertyPath = isPathAnnotationExpression(updatableExpression) && updatableExpression.path;\n\treturn isOnlyDynamicOnCurrentEntity ? (updatablePropertyPath as string) : \"\";\n}\n/**\n * Method to retrieve all property paths assigned to the Core.OperationAvailable annotation.\n * @param operationAvailableMap The record consisting of actions and their Core.OperationAvailable property paths\n * @param converterContext The instance of the converter context\n * @returns The CSV string of all property paths associated with the Core.OperationAvailable annotation\n */\nfunction getOperationAvailableProperties(\n\toperationAvailableMap: Record<string, unknown>,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): string {\n\tconst properties = new Set();\n\tfor (const actionName in operationAvailableMap) {\n\t\tconst propertyName = operationAvailableMap[actionName];\n\t\tif (propertyName === null) {\n\t\t\t// Annotation configured with explicit 'null' (action advertisement relevant)\n\t\t\tproperties.add(actionName);\n\t\t} else if (typeof propertyName === \"string\") {\n\t\t\t// Add property paths and not Constant values.\n\t\t\tproperties.add(propertyName);\n\t\t}\n\t}\n\tif (properties.size) {\n\t\t// Some actions have an operation available based on property --> we need to load the HeaderInfo.Title property\n\t\t// so that the dialog on partial actions is displayed properly (BCP 2180271425)\n\t\tconst entityType = converterContext.getEntityType();\n\t\tconst titleProperty = (entityType.annotations?.UI?.HeaderInfo?.Title as DataFieldTypes)?.Value?.path;\n\t\tif (titleProperty) {\n\t\t\tproperties.add(titleProperty);\n\t\t}\n\t}\n\treturn Array.from(properties).join(\",\");\n}\n/**\n * Iterates over the DataFieldForAction and DataFieldForIntentBasedNavigation of a line item and\n * returns all the UI.Hidden annotation expressions.\n * @param lineItemAnnotation Collection of data fields used for representation in a table or list\n * @param currentEntityType Current entity type\n * @param contextDataModelObjectPath Object path of the data model\n * @returns All the `UI.Hidden` path expressions found in the relevant actions\n */\nfunction getUIHiddenExpForActionsRequiringContext(\n\tlineItemAnnotation: LineItem,\n\tcurrentEntityType: EntityType,\n\tcontextDataModelObjectPath: DataModelObjectPath<PageContextPathTarget>\n): BindingToolkitExpression<boolean>[] {\n\tconst aUiHiddenPathExpressions: BindingToolkitExpression<boolean>[] = [];\n\tlineItemAnnotation.forEach((dataField) => {\n\t\t// Check if the lineItem context is the same as that of the action:\n\t\tif (\n\t\t\t(dataField.$Type === UIAnnotationTypes.DataFieldForAction &&\n\t\t\t\tdataField?.ActionTarget?.isBound &&\n\t\t\t\tcurrentEntityType === dataField?.ActionTarget.sourceEntityType) ||\n\t\t\t(dataField.$Type === UIAnnotationTypes.DataFieldForIntentBasedNavigation &&\n\t\t\t\tdataField.RequiresContext &&\n\t\t\t\tdataField?.Inline?.valueOf() !== true)\n\t\t) {\n\t\t\tif (typeof dataField.annotations?.UI?.Hidden?.valueOf() === \"object\") {\n\t\t\t\taUiHiddenPathExpressions.push(equal(getHiddenExpressionAtTableLevel(dataField, contextDataModelObjectPath), false));\n\t\t\t}\n\t\t}\n\t});\n\treturn aUiHiddenPathExpressions;\n}\n/**\n * This method is used to get the binding expression of the path of a DataField.\n * @param expression CompiledBindingToolkitExpression\n * @returns The binding expression\n */\nfunction getPathFromActionAnnotation(expression: CompiledBindingToolkitExpression): CompiledBindingToolkitExpression {\n\tlet path: CompiledBindingToolkitExpression;\n\tif (isPathAnnotationExpression(expression)) {\n\t\tpath = expression.path;\n\t} else {\n\t\tpath = expression;\n\t}\n\treturn path;\n}\n/**\n * This method is used to change the context currently referenced by this binding by removing the last navigation property.\n *\n * It is used (specifically in this case), to transform a binding made for a NavProp context /MainObject/NavProp1/NavProp2,\n * into a binding on the previous context /MainObject/NavProp1.\n * @param source DataFieldForAction | DataFieldForIntentBasedNavigation | CustomAction\n * @param contextDataModelObjectPath DataModelObjectPath\n * @returns The binding expression\n */\nfunction getHiddenExpressionAtTableLevel(\n\tsource: DataFieldAbstractTypes,\n\tcontextDataModelObjectPath: DataModelObjectPath<PageContextPathTarget>\n): BindingToolkitExpression<unknown> {\n\tconst expression = source.annotations?.UI?.Hidden as CompiledBindingToolkitExpression;\n\tlet path = getPathFromActionAnnotation(expression);\n\tif (typeof path === \"object\") {\n\t\treturn constant(false);\n\t} else if (typeof path === \"string\") {\n\t\tif (\"visible\" in source) {\n\t\t\tpath = path.substring(1, path.length - 1);\n\t\t}\n\t\tif (path.indexOf(\"/\") > 0) {\n\t\t\t//check if the navigation property is correct:\n\t\t\tconst splitPathForNavigationProperty = path.split(\"/\");\n\t\t\tconst navigationPath = splitPathForNavigationProperty[0];\n\t\t\tif (\n\t\t\t\tisNavigationProperty(contextDataModelObjectPath?.targetObject) &&\n\t\t\t\tcontextDataModelObjectPath.targetObject.partner === navigationPath\n\t\t\t) {\n\t\t\t\treturn pathInModel(splitPathForNavigationProperty.slice(1).join(\"/\"));\n\t\t\t} else {\n\t\t\t\treturn constant(true);\n\t\t\t}\n\t\t} else {\n\t\t\treturn constant(false);\n\t\t}\n\t}\n\treturn constant(true);\n}\n/**\n * Loop through the manifest actions and check the following:\n *\n * If the data field is also referenced as a custom action.\n * If the underlying manifest action is either a bound action or has the 'RequiresContext' property set to true.\n *\n * If so, the 'requiresSelection' property is forced to 'true' in the manifest.\n * @param dataFieldId Id of the DataField evaluated\n * @param dataField DataField evaluated\n * @param manifestActions The actions defined in the manifest\n * @returns `true` if the DataField is found among the manifest actions\n */\nfunction updateManifestActionAndTagIt(\n\tdataFieldId: string,\n\tdataField: DataFieldForAction | DataFieldForIntentBasedNavigation,\n\tmanifestActions: Record<string, CustomAction>\n): boolean {\n\treturn Object.keys(manifestActions).some((actionKey) => {\n\t\tif (actionKey === dataFieldId) {\n\t\t\tif (\n\t\t\t\t(dataField as DataFieldForAction)?.ActionTarget?.isBound ||\n\t\t\t\t(dataField as DataFieldForIntentBasedNavigation)?.RequiresContext\n\t\t\t) {\n\t\t\t\tmanifestActions[dataFieldId].requiresSelection = true;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n}\n/**\n * Loop through the DataFieldForAction and DataFieldForIntentBasedNavigation of a line item and\n * check the following:\n * If at least one of them is always visible in the table toolbar and requires a context\n * If an action is also defined in the manifest, it is set aside and will be considered\n * when going through the manifest.\n * @param lineItemAnnotation Collection of data fields for representation in a table or list\n * @param manifestActions The actions defined in the manifest\n * @param currentEntityType Current Entity Type\n * @returns `true` if there is at least 1 action that meets the criteria\n */\nfunction hasBoundActionsAlwaysVisibleInToolBar(\n\tlineItemAnnotation: LineItem | DataFieldForActionAbstractTypes[],\n\tmanifestActions: Record<string, CustomAction>,\n\tcurrentEntityType: EntityType\n): boolean {\n\treturn lineItemAnnotation.some((dataField) => {\n\t\tif (\n\t\t\t(dataField.$Type === UIAnnotationTypes.DataFieldForAction ||\n\t\t\t\tdataField.$Type === UIAnnotationTypes.DataFieldForIntentBasedNavigation) &&\n\t\t\tdataField?.Inline?.valueOf() !== true &&\n\t\t\t(dataField.annotations?.UI?.Hidden?.valueOf() === false || dataField.annotations?.UI?.Hidden?.valueOf() === undefined)\n\t\t) {\n\t\t\tif (dataField.$Type === UIAnnotationTypes.DataFieldForAction) {\n\t\t\t\tconst manifestActionId = generate([\"DataFieldForAction\", dataField.Action as string]);\n\t\t\t\t// if the DataFieldForActon from annotation also exists in the manifest, its visibility will be evaluated later on\n\t\t\t\tif (updateManifestActionAndTagIt(manifestActionId, dataField, manifestActions)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Check if the lineItem context is the same as that of the action:\n\t\t\t\treturn dataField?.ActionTarget?.isBound && currentEntityType === dataField?.ActionTarget.sourceEntityType;\n\t\t\t} else if (dataField.$Type === UIAnnotationTypes.DataFieldForIntentBasedNavigation) {\n\t\t\t\t// if the DataFieldForIntentBasedNavigation from annotation also exists in the manifest, its visibility will be evaluated later on\n\t\t\t\tif (\n\t\t\t\t\tupdateManifestActionAndTagIt(\n\t\t\t\t\t\t`DataFieldForIntentBasedNavigation::${dataField.SemanticObject}::${dataField.Action}`,\n\t\t\t\t\t\tdataField,\n\t\t\t\t\t\tmanifestActions\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn dataField.RequiresContext;\n\t\t\t}\n\t\t} else if (\n\t\t\tdataField.$Type === UIAnnotationTypes.DataFieldForActionGroup &&\n\t\t\t(dataField.annotations?.UI?.Hidden?.valueOf() === false || dataField.annotations?.UI?.Hidden?.valueOf() === undefined)\n\t\t) {\n\t\t\treturn hasBoundActionsAlwaysVisibleInToolBar(dataField.Actions, manifestActions, currentEntityType);\n\t\t}\n\t\treturn false;\n\t});\n}\n/**\n * Checks if a custom action that requires a context is always visible in the toolbar.\n * @param manifestActions The actions defined in the manifest\n * @returns `true` if there is at least 1 action that meets the criteria\n */\nfunction hasCustomActionsAlwaysVisibleInToolBar(manifestActions: Record<string, CustomAction>): boolean {\n\tconst customActions = Object.keys(manifestActions).reduce((actions: CustomAction[], actionKey) => {\n\t\tconst action = manifestActions[actionKey];\n\t\tif (!action.menu) {\n\t\t\t//simple custom action\n\t\t\tactions.push(action);\n\t\t} else {\n\t\t\t// grouped actions\n\t\t\tactions = [...actions, ...(action.menu.filter((menuAction) => typeof menuAction !== \"string\") as CustomAction[])];\n\t\t}\n\t\treturn actions;\n\t}, []);\n\treturn !!customActions.find(\n\t\t(action) => action.requiresSelection && (action.visible === undefined || action.visible?.toString() === \"true\")\n\t);\n}\n/**\n * Iterates over the custom actions (with key requiresSelection) declared in the manifest for the current line item and returns all the\n * visible key values as an expression.\n * @param manifestActions The actions defined in the manifest\n * @returns Array<Expression<boolean>> All the visible path expressions of the actions that meet the criteria\n */\nfunction getVisibleExpForCustomActionsRequiringContext(manifestActions: Record<string, CustomAction>): BindingToolkitExpression<boolean>[] {\n\tconst aVisiblePathExpressions: BindingToolkitExpression<boolean>[] = [];\n\tif (manifestActions) {\n\t\tObject.keys(manifestActions).forEach((actionKey) => {\n\t\t\tconst action = manifestActions[actionKey];\n\t\t\tif (action.requiresSelection === true && action.visible !== undefined) {\n\t\t\t\tif (typeof action.visible === \"string\") {\n\t\t\t\t\t/*The final aim would be to check if the path expression depends on the parent context\n\t\t\t\t\tand considers only those expressions for the expression evaluation,\n\t\t\t\t\tbut currently not possible from the manifest as the visible key is bound on the parent entity.\n\t\t\t\t\tTricky to differentiate the path as it's done for the Hidden annotation.\n\t\t\t\t\tFor the time being we consider all the paths of the manifest*/\n\t\t\t\t\taVisiblePathExpressions.push(resolveBindingString(action?.visible?.valueOf(), \"boolean\"));\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn aVisiblePathExpressions;\n}\n/**\n * Evaluate if the path is statically deletable or updatable.\n * @param converterContext\n * @returns The table capabilities\n */\nexport function getCapabilityRestriction(converterContext: ConverterContext<PageContextPathTarget>): TableCapabilityRestriction {\n\tconst isDeletable = isPathDeletable(converterContext.getDataModelObjectPath());\n\tconst isUpdatable = isPathUpdatable(converterContext.getDataModelObjectPath());\n\treturn {\n\t\tisDeletable: !(isConstant(isDeletable) && isDeletable.value === false),\n\t\tisUpdatable: !(isConstant(isUpdatable) && isUpdatable.value === false)\n\t};\n}\nexport function getSelectionMode(\n\tlineItemAnnotation: LineItem | undefined,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tisEntitySet: boolean,\n\ttargetCapabilities: TableCapabilityRestriction,\n\tdeleteButtonVisibilityExpression?: BindingToolkitExpression<boolean>,\n\tmassEditVisibilityExpression: BindingToolkitExpression<boolean> = constant(false),\n\tcutButtonVisibilityExpression: BindingToolkitExpression<boolean> = constant(false)\n): string | undefined {\n\tconst tableManifestSettings = converterContext.getManifestControlConfiguration<TableManifestConfiguration>(visualizationPath);\n\tconst tableType = tableManifestSettings.tableSettings?.type;\n\tlet selectionMode = tableManifestSettings.tableSettings?.selectionMode;\n\n\t// The collapse/Expand action of a tree table is a bound action, as a result, a tree table should always have a selection mode to \"Multi\" when no selectionMode has been set in the manifest\n\tif (tableType === \"TreeTable\" && !selectionMode) {\n\t\treturn SelectionMode.Multi;\n\t}\n\n\t// If the selection mode is forced to 'None' in the manifest/macro table parameters, we keep it unless here is a delete button\n\tif (!lineItemAnnotation || selectionMode === SelectionMode.None) {\n\t\tif (targetCapabilities.isDeletable && deleteButtonVisibilityExpression) {\n\t\t\treturn compileExpression(ifElse(deleteButtonVisibilityExpression, constant(SelectionMode.Multi), constant(SelectionMode.None)));\n\t\t}\n\t\treturn SelectionMode.None;\n\t}\n\tif (selectionMode === SelectionMode.ForceMulti) {\n\t\treturn SelectionMode.Multi;\n\t} else if (selectionMode === SelectionMode.ForceSingle) {\n\t\treturn SelectionMode.Single;\n\t}\n\tlet aHiddenBindingExpressions: BindingToolkitExpression<boolean>[] = [],\n\t\taVisibleBindingExpressions: BindingToolkitExpression<boolean>[] = [];\n\tconst manifestActions = getActionsFromManifest(\n\t\tconverterContext.getManifestControlConfiguration<TableManifestConfiguration>(visualizationPath).actions,\n\t\tconverterContext,\n\t\t[],\n\t\tundefined,\n\t\tfalse\n\t);\n\tlet isParentDeletable, parentEntitySetDeletable;\n\tif (converterContext.getTemplateType() === TemplateType.ObjectPage) {\n\t\tisParentDeletable = isPathDeletable(converterContext.getDataModelObjectPath());\n\t\tparentEntitySetDeletable = isParentDeletable ? compileExpression(isParentDeletable, true) : isParentDeletable;\n\t}\n\tconst bMassEditEnabled: boolean = !isConstant(massEditVisibilityExpression) || massEditVisibilityExpression.value !== false;\n\tif (!selectionMode || selectionMode === SelectionMode.Auto) {\n\t\tselectionMode = SelectionMode.Multi;\n\t}\n\tif (bMassEditEnabled) {\n\t\t// Override default selection mode when mass edit is visible\n\t\tselectionMode = selectionMode === SelectionMode.Single ? SelectionMode.Single : SelectionMode.Multi;\n\t}\n\tif (\n\t\thasBoundActionsAlwaysVisibleInToolBar(lineItemAnnotation, manifestActions.actions, converterContext.getEntityType()) ||\n\t\thasCustomActionsAlwaysVisibleInToolBar(manifestActions.actions)\n\t) {\n\t\treturn selectionMode;\n\t}\n\taHiddenBindingExpressions = getUIHiddenExpForActionsRequiringContext(\n\t\tlineItemAnnotation,\n\t\tconverterContext.getEntityType(),\n\t\tconverterContext.getDataModelObjectPath()\n\t);\n\taVisibleBindingExpressions = getVisibleExpForCustomActionsRequiringContext(manifestActions.actions);\n\t// No action requiring a context:\n\tif (\n\t\taHiddenBindingExpressions.length === 0 &&\n\t\taVisibleBindingExpressions.length === 0 &&\n\t\t(cutButtonVisibilityExpression || deleteButtonVisibilityExpression || bMassEditEnabled)\n\t) {\n\t\tif (!isEntitySet) {\n\t\t\t// Example: OP case\n\t\t\tif (targetCapabilities.isDeletable || parentEntitySetDeletable !== \"false\" || bMassEditEnabled) {\n\t\t\t\t// Building expression for delete and mass edit\n\t\t\t\tconst buttonVisibilityExpression = or(\n\t\t\t\t\tcutButtonVisibilityExpression || true,\n\t\t\t\t\tdeleteButtonVisibilityExpression || true, // default delete visibility as true\n\t\t\t\t\tmassEditVisibilityExpression\n\t\t\t\t);\n\t\t\t\treturn compileExpression(\n\t\t\t\t\tifElse(and(UI.IsEditable, buttonVisibilityExpression), constant(selectionMode), constant(SelectionMode.None))\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn compileExpression(\n\t\t\t\t\tifElse(cutButtonVisibilityExpression, constant(SelectionMode.Single), constant(SelectionMode.None))\n\t\t\t\t);\n\t\t\t}\n\t\t\t// EntitySet deletable:\n\t\t} else if (bMassEditEnabled) {\n\t\t\t// example: LR scenario\n\t\t\treturn selectionMode;\n\t\t} else if (targetCapabilities.isDeletable && deleteButtonVisibilityExpression) {\n\t\t\treturn compileExpression(ifElse(deleteButtonVisibilityExpression, constant(selectionMode), constant(SelectionMode.None)));\n\t\t\t// EntitySet not deletable:\n\t\t} else {\n\t\t\treturn SelectionMode.None;\n\t\t}\n\t\t// There are actions requiring a context:\n\t} else if (!isEntitySet) {\n\t\t// Example: OP case\n\t\tif (targetCapabilities.isDeletable || parentEntitySetDeletable !== \"false\" || bMassEditEnabled) {\n\t\t\t// Use selectionMode in edit mode if delete is enabled or mass edit is visible\n\t\t\tconst editModebuttonVisibilityExpression = ifElse(\n\t\t\t\tbMassEditEnabled && !targetCapabilities.isDeletable,\n\t\t\t\tmassEditVisibilityExpression,\n\t\t\t\tconstant(true)\n\t\t\t);\n\t\t\treturn compileExpression(\n\t\t\t\tifElse(\n\t\t\t\t\tand(UI.IsEditable, editModebuttonVisibilityExpression),\n\t\t\t\t\tconstant(selectionMode),\n\t\t\t\t\tifElse(\n\t\t\t\t\t\tor(...aHiddenBindingExpressions.concat(aVisibleBindingExpressions)),\n\t\t\t\t\t\tconstant(selectionMode),\n\t\t\t\t\t\tconstant(SelectionMode.None)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\treturn compileExpression(\n\t\t\t\tifElse(\n\t\t\t\t\tor(...aHiddenBindingExpressions.concat(aVisibleBindingExpressions)),\n\t\t\t\t\tconstant(selectionMode),\n\t\t\t\t\tconstant(SelectionMode.None)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\t//EntitySet deletable:\n\t} else if (targetCapabilities.isDeletable || bMassEditEnabled) {\n\t\t// Example: LR scenario\n\t\treturn selectionMode;\n\t\t//EntitySet not deletable:\n\t} else {\n\t\treturn compileExpression(\n\t\t\tifElse(\n\t\t\t\tor(...aHiddenBindingExpressions.concat(aVisibleBindingExpressions), massEditVisibilityExpression),\n\t\t\t\tconstant(selectionMode),\n\t\t\t\tconstant(SelectionMode.None)\n\t\t\t)\n\t\t);\n\t}\n}\n\n/**\n * Method to retrieve all table actions from annotations.\n * @param lineItemAnnotation\n * @param visualizationPath\n * @param converterContext\n * @returns The table annotation actions\n */\nfunction getTableAnnotationActions(\n\tlineItemAnnotation: LineItem,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): { tableActions: Array<AnnotationAction | AnnotationActionGroup> } {\n\tconst tableActions: Array<AnnotationAction | AnnotationActionGroup> = [];\n\tconst copyDataField = getCopyAction(\n\t\tlineItemAnnotation.filter((dataField) => {\n\t\t\treturn dataFieldIsCopyAction(dataField as DataFieldForActionTypes);\n\t\t}) as DataFieldForActionTypes[]\n\t);\n\tif (copyDataField) {\n\t\ttableActions.push({\n\t\t\ttype: ActionType.Copy,\n\t\t\tannotationPath: converterContext.getEntitySetBasedAnnotationPath(copyDataField.fullyQualifiedName),\n\t\t\tkey: KeyHelper.generateKeyFromDataField(copyDataField),\n\t\t\tvisible: compileExpression(visibleExpression(copyDataField, converterContext)),\n\t\t\tvisibleForContextMenu: compileExpression(visibleForContextMenuExpression(copyDataField, converterContext)),\n\t\t\ttext: copyDataField.Label?.toString() ?? Library.getResourceBundleFor(\"sap.fe.core\")!.getText(\"C_COMMON_COPY\"),\n\t\t\tisNavigable: true\n\t\t});\n\t}\n\tlineItemAnnotation\n\t\t.filter((dataField) => {\n\t\t\treturn !dataFieldIsCopyAction(dataField as DataFieldForAction);\n\t\t})\n\t\t.forEach((dataField: DataFieldAbstractTypes) => {\n\t\t\tif (\n\t\t\t\tisDataFieldForActionAbstract(dataField) &&\n\t\t\t\tdataField.Inline?.valueOf() !== true &&\n\t\t\t\tdataField.Determining?.valueOf() !== true\n\t\t\t) {\n\t\t\t\tconst tableAction = getDataFieldAnnotationAction(dataField, converterContext);\n\t\t\t\tif (tableAction) {\n\t\t\t\t\ttableActions.push(tableAction);\n\t\t\t\t}\n\t\t\t} else if (isDataFieldForActionGroup(dataField)) {\n\t\t\t\tconst dataFieldGroup = getDataFieldAnnotationAction(dataField, converterContext);\n\t\t\t\tif (dataFieldGroup) {\n\t\t\t\t\ttableActions.push(dataFieldGroup);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\ttableActions\n\t};\n}\n\n// For the context menu, the visibility should also consider the 'inactiveContext' property:\n// only when at least one selected context is active (i.e. \"contextmenu/inactiveContext\" is false), the action should be visible in the context menu\n// This is only relevant when the table manifest setting \"creationMode\" is \"InlineCreationRows\"\nfunction visibleForContextMenuExpression(\n\tdataField: DataFieldForAction | DataFieldForIntentBasedNavigation | DataFieldForActionGroup | undefined,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): BindingToolkitExpression<boolean> {\n\treturn and(visibleExpression(dataField, converterContext), equal(pathInModel(\"contextmenu/inactiveContext\", \"internal\"), false));\n}\n\nfunction getDataFieldAnnotationAction(\n\tdataField: DataFieldAbstractTypes,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): AnnotationAction | AnnotationActionGroup | void {\n\tlet tableAction: AnnotationAction;\n\tlet entityType;\n\tswitch (dataField.$Type) {\n\t\tcase UIAnnotationTypes.DataFieldForAction:\n\t\t\ttableAction = {\n\t\t\t\ttype: ActionType.DataFieldForAction,\n\t\t\t\tannotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),\n\t\t\t\tkey: KeyHelper.generateKeyFromDataField(dataField),\n\t\t\t\tvisible: compileExpression(visibleExpression(dataField, converterContext)),\n\t\t\t\tvisibleForContextMenu: compileExpression(visibleForContextMenuExpression(dataField, converterContext)),\n\t\t\t\tisNavigable: true,\n\t\t\t\tisAIOperation: isActionAIOperation(dataField) === true || undefined\n\t\t\t};\n\t\t\tentityType = converterContext.getEntityType().fullyQualifiedName;\n\t\t\tif (_useEnabledExpression(dataField, entityType)) {\n\t\t\t\ttableAction.enabled = getEnabledForAnnotationAction(converterContext, dataField.ActionTarget, true);\n\t\t\t}\n\t\t\treturn tableAction;\n\t\tcase UIAnnotationTypes.DataFieldForIntentBasedNavigation:\n\t\t\treturn {\n\t\t\t\ttype: ActionType.DataFieldForIntentBasedNavigation,\n\t\t\t\tannotationPath: converterContext.getEntitySetBasedAnnotationPath(dataField.fullyQualifiedName),\n\t\t\t\tkey: KeyHelper.generateKeyFromDataField(dataField),\n\t\t\t\tvisible: compileExpression(visibleExpression(dataField, converterContext)),\n\t\t\t\tvisibleForContextMenu: compileExpression(visibleForContextMenuExpression(dataField, converterContext))\n\t\t\t};\n\t\tcase UIAnnotationTypes.DataFieldForActionGroup:\n\t\t\treturn {\n\t\t\t\ttype: ActionType.Menu,\n\t\t\t\tkey: KeyHelper.generateKeyFromDataField(dataField),\n\t\t\t\tid: KeyHelper.generateKeyFromDataField(dataField),\n\t\t\t\ttext: dataField.Label?.toString(),\n\t\t\t\tvisible: compileExpression(visibleExpression(dataField, converterContext)),\n\t\t\t\tvisibleForContextMenu: compileExpression(visibleForContextMenuExpression(dataField, converterContext)),\n\t\t\t\tisAIOperation: isMenuAIOperation(dataField.Actions) === true || undefined,\n\t\t\t\tmenu: dataField.Actions.map((action) => getDataFieldAnnotationAction(action, converterContext))\n\t\t\t} as AnnotationActionGroup;\n\t\tdefault:\n\t\t\treturn;\n\t}\n}\n\n/**\n * Generate the bindingExpression for the highlight rowSetting parameter.\n * @param criticalityAnnotation Path or value of the criticality\n * @param isDraftRootOrNode  Is the current entitySet an Draft root or a node\n * @param targetEntityType The targeted entityType\n * @returns An expressionBinding\n */\nfunction getHighlightRowBinding(\n\tcriticalityAnnotation: Criticality | undefined,\n\tisDraftRootOrNode: boolean,\n\ttargetEntityType?: EntityType\n): BindingToolkitExpression<MessageType> {\n\tlet defaultHighlightRowDefinition: MessageType | BindingToolkitExpression<MessageType> = MessageType.None;\n\tif (criticalityAnnotation) {\n\t\tif (typeof criticalityAnnotation === \"object\") {\n\t\t\tdefaultHighlightRowDefinition = getExpressionFromAnnotation(criticalityAnnotation) as BindingToolkitExpression<MessageType>;\n\t\t} else {\n\t\t\t// Enum Value so we get the corresponding static part\n\t\t\tdefaultHighlightRowDefinition = getMessageTypeFromCriticalityType(criticalityAnnotation);\n\t\t}\n\t}\n\treturn formatResult(\n\t\t[\n\t\t\tdefaultHighlightRowDefinition,\n\t\t\tpathInModel(`filteredMessages`, \"internal\"),\n\t\t\tisDraftRootOrNode && Entity.HasActive,\n\t\t\tisDraftRootOrNode && Entity.IsActive,\n\t\t\t`${isDraftRootOrNode}`,\n\t\t\tpathInModel(\"@$ui5.fe.contextPath\"),\n\t\t\tUI.IsInactive\n\t\t],\n\t\ttableFormatters.rowHighlighting,\n\t\ttargetEntityType\n\t);\n}\n\n/**\n * Gets the external creation behavior if there's one.\n * @param tableManifestConfiguration\n * @param converterContext\n * @param navigationSettings\n * @returns The external creation behavior, or undefined if there's none.\n */\nfunction getExternalCreationBehavior(\n\ttableManifestConfiguration: TableControlConfiguration,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tnavigationSettings: NavigationSettingsConfiguration\n): CreateBehaviorExternal | undefined {\n\t// Legacy settings: the outbound is specified in navigation/create\n\t// New settings: the outbound is specified in tableSettings/creationMode\n\tconst creationDetails = navigationSettings?.create;\n\tconst outboundKey = tableManifestConfiguration.outboundCreation ?? creationDetails?.outbound;\n\tconst outboundDetail = outboundKey ? converterContext.getManifestWrapper().getOutboundNavigationEntries()?.[outboundKey] : undefined;\n\tif (outboundKey && outboundDetail) {\n\t\treturn {\n\t\t\tmode: \"External\",\n\t\t\toutbound: outboundKey,\n\t\t\toutboundDetail\n\t\t};\n\t} else {\n\t\tif (tableManifestConfiguration.creationMode === CreationMode.External) {\n\t\t\t// Outbound configuration incorrect --> fallback to NewPage\n\t\t\tLog.warning(`Cannot find outbound parameters for \"External\" creation mode. Instead, the default mode \"NewPage\" is used.`);\n\t\t\ttableManifestConfiguration.creationMode = CreationMode.NewPage;\n\t\t\tdelete tableManifestConfiguration.outboundCreation;\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n\nfunction _getCreationBehaviour(\n\tlineItemAnnotation: LineItem | undefined,\n\ttableManifestConfiguration: TableControlConfiguration,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tnavigationSettings: NavigationSettingsConfiguration,\n\tvisualizationPath: string\n): CreateBehavior | CreateBehaviorExternal {\n\tconst externalBehavior = getExternalCreationBehavior(tableManifestConfiguration, converterContext, navigationSettings);\n\tif (externalBehavior) {\n\t\ttableManifestConfiguration.creationMode = CreationMode.External;\n\t\ttableManifestConfiguration.outboundCreation = externalBehavior.outbound;\n\t\treturn externalBehavior;\n\t}\n\n\tconst tableManifestSettings: TableManifestConfiguration = converterContext.getManifestControlConfiguration(visualizationPath);\n\tconst originalTableSettings = tableManifestSettings?.tableSettings ?? {};\n\tconst navigationDetails = navigationSettings?.detail;\n\tif (\n\t\tconverterContext.getTemplateType() === TemplateType.ListReport &&\n\t\t![CreationMode.NewPage, CreationMode.External, CreationMode.CreationDialog].includes(tableManifestConfiguration.creationMode)\n\t) {\n\t\t// Fallback to \"NewPage\"\n\t\tLog.warning(\n\t\t\t`Creation mode '${tableManifestConfiguration.creationMode}' can not be used within the List Report. Instead, the default mode \"NewPage\" is used.`\n\t\t);\n\t\ttableManifestConfiguration.creationMode = CreationMode.NewPage;\n\t} else if (\n\t\tconverterContext.getTemplateType() !== TemplateType.ListReport &&\n\t\ttableManifestConfiguration.type === \"TreeTable\" &&\n\t\t![CreationMode.NewPage, CreationMode.Inline, CreationMode.CreationDialog].includes(tableManifestConfiguration.creationMode)\n\t) {\n\t\t// Fallback to \"NewPage\" in case of a non-supported mode for a TreeTable\n\t\tLog.warning(\n\t\t\t`Creation mode '${tableManifestConfiguration.creationMode}' can not be used with a Tree Table. Instead, the default mode \"NewPage\" is used.`\n\t\t);\n\t\ttableManifestConfiguration.creationMode = CreationMode.NewPage;\n\t}\n\n\tlet newAction;\n\tif (lineItemAnnotation) {\n\t\t// in-app\n\t\tconst targetAnnotations = converterContext.getEntitySet()?.annotations;\n\t\tconst targetAnnotationsCommon = targetAnnotations?.Common as EntitySetAnnotations_Common,\n\t\t\ttargetAnnotationsSession = targetAnnotations?.Session as EntitySetAnnotations_Session;\n\t\tnewAction = targetAnnotationsCommon?.DraftRoot?.NewAction || targetAnnotationsSession?.StickySessionSupported?.NewAction;\n\t\tif (tableManifestConfiguration.creationMode === CreationMode.CreationRow && newAction) {\n\t\t\t// A combination of 'CreationRow' and 'NewAction' does not make sense\n\t\t\tthrow Error(`Creation mode '${CreationMode.CreationRow}' can not be used with a custom 'new' action (${newAction})`);\n\t\t}\n\t\tif (navigationDetails?.route) {\n\t\t\t// route specified\n\t\t\treturn {\n\t\t\t\tmode: tableManifestConfiguration.creationMode,\n\t\t\t\tappend: tableManifestConfiguration.createAtEnd,\n\t\t\t\tnewAction: newAction?.toString(),\n\t\t\t\tnavigateToTarget: tableManifestConfiguration.creationMode === CreationMode.NewPage ? navigationDetails.route : undefined // navigate only in NewPage mode\n\t\t\t};\n\t\t}\n\t}\n\t// no navigation or no route specified - fallback to inline create if original creation mode was 'NewPage'\n\tif (tableManifestConfiguration.creationMode === CreationMode.NewPage) {\n\t\tif (converterContext.getTemplateType() === TemplateType.ListReport) {\n\t\t\tLog.error(\"The creation mode 'NewPage' is used but the navigation configuration to the sub page is missing.\");\n\t\t} else {\n\t\t\ttableManifestConfiguration.creationMode = CreationMode.Inline;\n\t\t\t// In case there was no specific configuration for the createAtEnd we force it to false\n\t\t\tif (originalTableSettings.creationMode?.createAtEnd === undefined) {\n\t\t\t\ttableManifestConfiguration.createAtEnd = false;\n\t\t\t}\n\t\t\tLog.info(\"The creation mode was changed from 'NewPage' to 'Inline' due to missing navigation configuration to the sub page.\");\n\t\t}\n\t}\n\treturn {\n\t\tmode: tableManifestConfiguration.creationMode,\n\t\tappend: tableManifestConfiguration.createAtEnd,\n\t\tnewAction: newAction?.toString()\n\t};\n}\nconst _getRowConfigurationProperty = function (\n\tlineItemAnnotation: LineItem | undefined,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tnavigationSettings: NavigationSettingsConfiguration,\n\ttargetPath: string,\n\ttableType: TableType,\n\taggregationOnLeafLevelenabled?: boolean\n): RowConfiguration {\n\tlet navigationInfo: RowNavigationInfo | undefined;\n\tlet criticalityProperty: BindingToolkitExpression<MessageType> = constant(MessageType.None);\n\tconst targetEntityType = converterContext.getEntityType();\n\tconst criticalityAnnotation = lineItemAnnotation?.annotations?.UI?.Criticality;\n\tif (navigationSettings && lineItemAnnotation) {\n\t\tconst navigationTarget = navigationSettings.display?.target || navigationSettings.detail?.outbound;\n\t\tconst targetEntitySet = converterContext.getEntitySet();\n\t\tcriticalityProperty = getHighlightRowBinding(\n\t\t\tcriticalityAnnotation,\n\t\t\t!!ModelHelper.getDraftRoot(targetEntitySet) || !!ModelHelper.getDraftNode(targetEntitySet),\n\t\t\ttargetEntityType\n\t\t);\n\t\tif (navigationTarget) {\n\t\t\tnavigationInfo = { type: \"Outbound\", navigationTarget };\n\t\t}\n\t\tif (!navigationTarget && navigationSettings.detail?.route) {\n\t\t\tconst checkEditable =\n\t\t\t\tModelHelper.getDraftRoot(targetEntitySet) !== undefined || ModelHelper.getDraftNode(targetEntitySet) !== undefined;\n\t\t\tnavigationInfo = {\n\t\t\t\ttype: \"Navigation\",\n\t\t\t\troutePath: navigationSettings.detail.route,\n\t\t\t\ttargetPath,\n\t\t\t\tcheckEditable,\n\t\t\t\trecreateContext: tableType === \"AnalyticalTable\"\n\t\t\t};\n\t\t}\n\t}\n\tconst rowNavigatedExpression: BindingToolkitExpression<boolean> = formatResult(\n\t\t[pathInModel(\"/deepestPath\", \"internal\")],\n\t\ttableFormatters.navigatedRow,\n\t\ttargetEntityType\n\t);\n\treturn {\n\t\tnavigationInfo,\n\t\tactionType: navigationInfo ? \"Navigation\" : undefined,\n\t\trowHighlighting: compileExpression(criticalityProperty),\n\t\trowNavigated: compileExpression(rowNavigatedExpression),\n\t\trowCriticalityForInsights: criticalityAnnotation ? criticalityExpressionForIntegrationCards(criticalityAnnotation) : undefined,\n\t\tvisible: compileExpression(and(not(UI.IsInactive), aggregationOnLeafLevelenabled ? UI.isNodeLevelNavigable : true))\n\t};\n};\n\n/**\n * Creates a PropertyInfo for the identified additional property for the ALP table use-case.\n *\n * For e.g. If UI.Hidden points to a property, include this technical property in the additionalProperties of ComplexPropertyInfo object.\n * @param name The name of the property to be created.\n * @param columns The list of columns created for LineItems and Properties of entityType from the table visualization.\n * @param relatedAdditionalPropertyNameMap\n */\nconst createTechnicalProperty = function (\n\tname: string,\n\tcolumns: TableColumn[],\n\trelatedAdditionalPropertyNameMap: Record<string, string>\n): void {\n\tconst key = `Property_Technical::${name}`;\n\t// Validate if the technical property hasn't yet been created on previous iterations.\n\tconst columnExists = columns.find((column) => column.key === key);\n\t// Retrieve the simple property used by the hidden annotation, it will be used as a base for the mandatory attributes of newly created technical property. For e.g. relativePath\n\tconst additionalProperty =\n\t\t!columnExists && (columns.find((column) => column.name === name && !column.propertyInfos) as AnnotationTableColumn)!;\n\tif (additionalProperty) {\n\t\tconst technicalColumn: AnnotationTableColumn = {\n\t\t\tkey: key,\n\t\t\ttype: ColumnType.Annotation,\n\t\t\tlabel: additionalProperty.label,\n\t\t\tannotationPath: additionalProperty.annotationPath,\n\t\t\tdataType: \"Edm.String\",\n\t\t\tavailability: \"Hidden\",\n\t\t\tname: key,\n\t\t\trelativePath: additionalProperty.relativePath,\n\t\t\tsortable: false,\n\t\t\tisGroupable: false,\n\t\t\tisKey: false,\n\t\t\texportSettings: null,\n\t\t\tcaseSensitive: false,\n\t\t\taggregatable: false,\n\t\t\tfilterable: false,\n\t\t\textension: {\n\t\t\t\ttechnicallyGroupable: true,\n\t\t\t\ttechnicallyAggregatable: true\n\t\t\t}\n\t\t};\n\t\tcolumns.push(technicalColumn);\n\t\trelatedAdditionalPropertyNameMap[name] = technicalColumn.name;\n\t}\n};\n\nexport function getP13nMode(\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\ttableManifestConfiguration: TableControlConfiguration\n): TableP13nMode[] | undefined {\n\tconst manifestWrapper: ManifestWrapper = converterContext.getManifestWrapper();\n\tconst tableManifestSettings: TableManifestConfiguration = converterContext.getManifestControlConfiguration(visualizationPath);\n\tconst variantManagement: VariantManagementType = manifestWrapper.getVariantManagement();\n\tconst modes: TableP13nMode[] = [];\n\tconst isAnalyticalTable = tableManifestConfiguration.type === \"AnalyticalTable\";\n\tconst isResponsiveTable = tableManifestConfiguration.type === \"ResponsiveTable\";\n\tif (tableManifestSettings?.tableSettings?.personalization !== undefined) {\n\t\t// Personalization configured in manifest.\n\t\tconst personalization = tableManifestSettings.tableSettings.personalization;\n\t\tif (personalization === true) {\n\t\t\t// Table personalization fully enabled.\n\t\t\tswitch (tableManifestConfiguration.type) {\n\t\t\t\tcase \"AnalyticalTable\":\n\t\t\t\t\treturn [\"Sort\", \"Column\", \"Filter\", \"Group\", \"Aggregate\"];\n\t\t\t\tcase \"ResponsiveTable\":\n\t\t\t\t\treturn [\"Sort\", \"Column\", \"Filter\", \"Group\"];\n\t\t\t\tdefault:\n\t\t\t\t\treturn [\"Sort\", \"Column\", \"Filter\"];\n\t\t\t}\n\t\t} else if (typeof personalization === \"object\") {\n\t\t\t// Specific personalization options enabled in manifest. Use them as is.\n\t\t\tif (personalization.sort) {\n\t\t\t\tmodes.push(\"Sort\");\n\t\t\t}\n\t\t\tif (personalization.column) {\n\t\t\t\tmodes.push(\"Column\");\n\t\t\t}\n\t\t\tif (personalization.filter) {\n\t\t\t\tmodes.push(\"Filter\");\n\t\t\t}\n\t\t\tif (personalization.group && (isAnalyticalTable || isResponsiveTable)) {\n\t\t\t\tmodes.push(\"Group\");\n\t\t\t}\n\t\t\tif (personalization.aggregate && isAnalyticalTable) {\n\t\t\t\tmodes.push(\"Aggregate\");\n\t\t\t}\n\t\t\treturn modes.length > 0 ? modes : undefined;\n\t\t}\n\t} else {\n\t\t// No personalization configured in manifest.\n\t\tmodes.push(\"Sort\");\n\t\tmodes.push(\"Column\");\n\t\tif (converterContext.getTemplateType() === TemplateType.ListReport) {\n\t\t\tif (variantManagement === VariantManagementType.Control || _isFilterBarHidden(manifestWrapper, converterContext)) {\n\t\t\t\t// Feature parity with V2.\n\t\t\t\t// Enable table filtering by default only in case of Control level variant management.\n\t\t\t\t// Or when the LR filter bar is hidden via manifest setting\n\t\t\t\tmodes.push(\"Filter\");\n\t\t\t}\n\t\t} else {\n\t\t\tmodes.push(\"Filter\");\n\t\t}\n\t\tif (isAnalyticalTable) {\n\t\t\tmodes.push(\"Group\");\n\t\t\tmodes.push(\"Aggregate\");\n\t\t}\n\t\tif (isResponsiveTable) {\n\t\t\tmodes.push(\"Group\");\n\t\t}\n\t\treturn modes;\n\t}\n}\n/**\n * Returns a Boolean value suggesting if a filter bar is being used on the page.\n *\n * Chart has a dependency to filter bar (issue with loading data). Once resolved, the check for chart should be removed here.\n * Until then, hiding filter bar is now allowed if a chart is being used on LR.\n * @param manifestWrapper Manifest settings getter for the page\n * @param converterContext The instance of the converter context\n * @returns Boolean suggesting if a filter bar is being used on the page.\n */\nfunction _isFilterBarHidden(manifestWrapper: ManifestWrapper, converterContext: ConverterContext<PageContextPathTarget>): boolean {\n\treturn (\n\t\tmanifestWrapper.isFilterBarHidden() &&\n\t\t!converterContext.getManifestWrapper().hasMultipleVisualizations() &&\n\t\tconverterContext.getTemplateType() !== TemplateType.AnalyticalListPage\n\t);\n}\n/**\n * Returns a JSON string containing the sort conditions for the presentation variant.\n * @param converterContext The instance of the converter context\n * @param presentationVariantAnnotation Presentation variant annotation\n * @param columns Table columns processed by the converter\n * @returns Sort conditions for a presentation variant.\n */\nfunction getSortConditions(\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tpresentationVariantAnnotation: PresentationVariantType | undefined,\n\tcolumns: TableColumn[]\n): TableSortConditions | undefined {\n\t// Currently navigation property is not supported as sorter\n\tconst nonSortableProperties = getRestrictionsOnProperties(converterContext).nonSortableProperties;\n\tconst sortConditions: TableSortConditions = {\n\t\tsorters: []\n\t};\n\tif (presentationVariantAnnotation?.SortOrder) {\n\t\tpresentationVariantAnnotation.SortOrder.forEach((condition) => {\n\t\t\tconst conditionProperty = condition.Property;\n\t\t\tif (conditionProperty?.$target !== undefined && !nonSortableProperties.includes(conditionProperty.$target.name)) {\n\t\t\t\tconst infoName = convertPropertyPathsToInfoNames([conditionProperty], columns)[0];\n\t\t\t\tif (infoName) {\n\t\t\t\t\tsortConditions.sorters.push({\n\t\t\t\t\t\tname: infoName,\n\t\t\t\t\t\tdescending: !!condition.Descending\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn sortConditions.sorters.length ? sortConditions : undefined;\n}\nfunction getInitialExpansionLevel(presentationVariantAnnotation: PresentationVariantType | undefined): number | undefined {\n\tif (!presentationVariantAnnotation) {\n\t\treturn undefined;\n\t}\n\tconst level = presentationVariantAnnotation.InitialExpansionLevel?.valueOf();\n\treturn typeof level === \"number\" ? level + 1 : undefined;\n}\n/**\n * Converts an array of propertyPath to an array of propertyInfo names.\n * @param paths The array to be converted\n * @param columns The array of propertyInfos\n * @returns An array of propertyInfo names\n */\nfunction convertPropertyPathsToInfoNames(paths: PropertyPath[], columns: TableColumn[]): string[] {\n\tconst infoNames: string[] = [];\n\tlet propertyInfo: TableColumn | undefined, annotationColumn: AnnotationTableColumn;\n\tpaths.forEach((currentPath) => {\n\t\tif (currentPath?.value) {\n\t\t\tpropertyInfo = columns.find((column) => {\n\t\t\t\tannotationColumn = column as AnnotationTableColumn;\n\t\t\t\treturn !annotationColumn.propertyInfos && annotationColumn.relativePath === currentPath?.value;\n\t\t\t});\n\t\t\tif (propertyInfo) {\n\t\t\t\tinfoNames.push(propertyInfo.name);\n\t\t\t}\n\t\t}\n\t});\n\treturn infoNames;\n}\n/**\n * Returns a JSON string containing Presentation Variant group conditions.\n * @param presentationVariantAnnotation Presentation variant annotation\n * @param columns Converter processed table columns\n * @param tableType The table type.\n * @returns Group conditions for a Presentation variant.\n */\nfunction getGroupConditions(\n\tpresentationVariantAnnotation: PresentationVariantType | undefined,\n\tcolumns: TableColumn[],\n\ttableType: string\n): TableGroupConditions | undefined {\n\tconst groupConditions: TableGroupConditions = {\n\t\tgroupLevels: []\n\t};\n\tif (presentationVariantAnnotation?.GroupBy) {\n\t\tlet aGroupBy = presentationVariantAnnotation.GroupBy;\n\t\tif (tableType === \"ResponsiveTable\") {\n\t\t\taGroupBy = aGroupBy.slice(0, 1);\n\t\t}\n\t\tgroupConditions.groupLevels = convertPropertyPathsToInfoNames(aGroupBy, columns).map((infoName) => {\n\t\t\treturn { name: infoName };\n\t\t});\n\t}\n\treturn groupConditions.groupLevels.length ? groupConditions : undefined;\n}\n/**\n * Updates the column's propertyInfos of an analytical table integrating all extensions and binding-relevant property info part.\n * @param tableVisualization The visualization to be updated\n */\nfunction _updatePropertyInfosWithAggregatesDefinitions(tableVisualization: TableVisualization): void {\n\tconst relatedAdditionalPropertyNameMap: Record<string, string> = {};\n\ttableVisualization.columns.forEach((column) => {\n\t\tcolumn = column as AnnotationTableColumn;\n\t\tconst propertyNameFromAnalyticsInfo = _getPropertyNameFromAnalyticsInfo(tableVisualization, column.name);\n\t\tif (propertyNameFromAnalyticsInfo) {\n\t\t\tconst aggregatablePropertyDefinition = tableVisualization.analyticsExtensions![propertyNameFromAnalyticsInfo];\n\t\t\tcolumn.aggregatable = !aggregatablePropertyDefinition.fromGroupableProperty;\n\t\t\tcolumn.extension = aggregatablePropertyDefinition ?? {};\n\t\t\tif (!column.isGroupable && !column.aggregatable) {\n\t\t\t\t// The column is neither aggregatable nor groupable --> it's a hidden column to allow filtering in P13N\n\t\t\t\t// We need to remove additionalProperties, as it's not needed and causes an error in the MDC table code\n\t\t\t\tdelete column.extension.additionalProperties;\n\t\t\t}\n\t\t\tif (column.isGroupable && column.extension.additionalProperties && column.extension.additionalProperties.length) {\n\t\t\t\t// For the time being, properties with context-defining properties shall not be allowed for visual grouping\n\t\t\t\t// We need a UX concept to support this (as the end user would need to group on the context-defining properties before grouping\n\t\t\t\t// on the property itself).\n\t\t\t\tcolumn.isGroupable = false;\n\t\t\t\tcolumn.extension.technicallyGroupable = true;\n\t\t\t}\n\t\t}\n\t\tif (column.additionalPropertyInfos?.length) {\n\t\t\tcolumn.additionalPropertyInfos.forEach((additionalPropertyInfo) => {\n\t\t\t\t// Create propertyInfo for each additional property.\n\t\t\t\t// The new property 'name' has been prefixed with 'Property_Technical::' for uniqueness and it has been named technical property as it requires dedicated MDC attributes (technicallyGroupable and technicallyAggregatable).\n\t\t\t\tcreateTechnicalProperty(additionalPropertyInfo, tableVisualization.columns, relatedAdditionalPropertyNameMap);\n\t\t\t});\n\t\t}\n\t\t_updateForTextOnlyPropertiesWithCDP(tableVisualization, column);\n\t});\n\ttableVisualization.columns.forEach((column) => {\n\t\tcolumn = column as AnnotationTableColumn;\n\t\tif (column.additionalPropertyInfos) {\n\t\t\tcolumn.additionalPropertyInfos = column.additionalPropertyInfos.map(\n\t\t\t\t(propertyInfo) => relatedAdditionalPropertyNameMap[propertyInfo] ?? propertyInfo\n\t\t\t);\n\t\t\t// Add additional properties to the complex property using the hidden annotation.\n\t\t\tcolumn.propertyInfos = column.propertyInfos?.concat(column.additionalPropertyInfos);\n\t\t}\n\t});\n}\n\n/**\n * Provides the referenced property name from the analytics data\n * @param tableVisualization The visualization to be analyzed\n * @param name The property name\n * @returns The property name from the analytics data\n */\n\nfunction _getPropertyNameFromAnalyticsInfo(tableVisualization: TableVisualization, name: string): string | undefined {\n\treturn Object.keys(tableVisualization.analyticsExtensions!).find((aggregate) => aggregate === name);\n}\n\n/**\n * Updates the column's propertyInfos of a column annotated with text only on an analytical table.\n * The referenced text property could define context-defining properties to be included into the column's propertyInfos.\n * @param tableVisualization The visualization to be analyzed\n * @param column The column containing the \"textArrangement\" object when present\n */\nfunction _updateForTextOnlyPropertiesWithCDP(tableVisualization: TableVisualization, column: AnnotationTableColumn): void {\n\t// Currently a column referencing a text only property only contains the text property into its propertyInfos.\n\t// Properties referencing context-defining properties (CDP) aren't allowed for grouping. This need to change for text only columns, as in common cases, text properties reference their value properties into their CDPs.\n\t// So, we now include the value property into the propertyInfos of the column to allow the grouping on the property value.\n\tif (column.textArrangement?.mode === \"Description\" && column.textArrangement.textProperty) {\n\t\tconst analyticsInfoPropertyNameForDesc = _getPropertyNameFromAnalyticsInfo(tableVisualization, column.textArrangement.textProperty);\n\t\tif (analyticsInfoPropertyNameForDesc) {\n\t\t\tconst aggregatablePropertyDefinition = tableVisualization.analyticsExtensions![analyticsInfoPropertyNameForDesc];\n\t\t\t// We need to make sure the text property has CDP properties defined and the value property is part of these properties.\n\t\t\tif (\n\t\t\t\taggregatablePropertyDefinition.additionalProperties?.length &&\n\t\t\t\taggregatablePropertyDefinition.additionalProperties.includes(column.name)\n\t\t\t) {\n\t\t\t\t// The property value (single property) exists already on the list of columns from the table but it was only created for filtering purposes in P13n and not linked to the column with the text arrangement #TextOnly,\n\t\t\t\t// therefore not proposed as a default value for grouping the column menu. Now it'll be included into the propertyInfos of the column to allow the default grouping on this value property.\n\t\t\t\tconst columnWithTextOnly = (tableVisualization.columns as AnnotationTableColumn[]).find(\n\t\t\t\t\t(textOnlyColumn) => textOnlyColumn.relativePath === column.relativePath && textOnlyColumn.propertyInfos\n\t\t\t\t);\n\t\t\t\tcolumnWithTextOnly?.propertyInfos?.push(column.name);\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Returns a JSON string containing Presentation Variant aggregate conditions.\n * @param presentationVariantAnnotation Presentation variant annotation\n * @param columns Converter processed table columns\n * @param extensionInfoMap\n * @returns Group conditions for a Presentation variant.\n */\nfunction getAggregateConditions(\n\tpresentationVariantAnnotation: PresentationVariantType | undefined,\n\tcolumns: TableColumn[],\n\textensionInfoMap: Record<string, InternalExtensionForAnalytics>\n): TableAggregateConditions | undefined {\n\tconst aggregateConditions: TableAggregateConditions = {};\n\tif (presentationVariantAnnotation?.Total) {\n\t\tconst aTotals = presentationVariantAnnotation.Total;\n\t\tconvertPropertyPathsToInfoNames(aTotals, columns).forEach((infoName) => {\n\t\t\taggregateConditions[infoName] = {};\n\t\t});\n\t} else {\n\t\tfor (const key in extensionInfoMap) {\n\t\t\tif (!extensionInfoMap[key].fromGroupableProperty) {\n\t\t\t\taggregateConditions[key] = {};\n\t\t\t}\n\t\t}\n\t}\n\treturn Object.keys(aggregateConditions).length ? aggregateConditions : undefined;\n}\nexport type StandardActionsConfiguration = {\n\tcreationBehaviour: TableAnnotationConfiguration[\"create\"];\n\tcutButtonVisibilityExpression: BindingToolkitExpression<boolean>;\n\tdeleteButtonVisibilityExpression: BindingToolkitExpression<boolean>;\n\tmassEditButtonVisibilityExpression: BindingToolkitExpression<boolean>;\n\tisInsertUpdateActionsTemplated: boolean;\n\tstandardActions: {\n\t\tcreate: StandardAction;\n\t\tdelete: StandardAction;\n\t\tpaste: StandardAction;\n\t\tmassEdit: StandardAction;\n\t\tinsights: StandardAction;\n\t\tcreationRow: StandardAction;\n\t\tcut: StandardAction;\n\t\tcopy: StandardAction;\n\t\tmoveUp?: StandardAction;\n\t\tmoveDown?: StandardAction;\n\t};\n};\n/**\n * Calculates the standard actions and adjacent properties that are needed in the further conversion process.\n * @param lineItemAnnotation Collection of data fields used for representation in a table or list\n * @param visualizationPath The visualization path\n * @param converterContext The instance of the converter context\n * @param tableManifestConfiguration The table manifest configuration\n * @param navigationSettings The navigation target manifest configuration\n * @returns Standard actions and connected properties\n */\nexport function getStandardActionsConfiguration(\n\tlineItemAnnotation: LineItem | undefined,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\ttableManifestConfiguration: TableControlConfiguration,\n\tnavigationSettings: NavigationSettingsConfiguration\n): StandardActionsConfiguration {\n\tconst creationBehaviour = _getCreationBehaviour(\n\t\tlineItemAnnotation,\n\t\ttableManifestConfiguration,\n\t\tconverterContext,\n\t\tnavigationSettings,\n\t\tvisualizationPath\n\t);\n\tconst standardActionsContext = generateStandardActionsContext(\n\t\tconverterContext,\n\t\tcreationBehaviour.mode as CreationMode,\n\t\ttableManifestConfiguration\n\t);\n\tconst cutButtonVisibilityExpression = getCutVisibility(converterContext, standardActionsContext);\n\tconst deleteButtonVisibilityExpression = getDeleteVisibility(converterContext, standardActionsContext);\n\tconst massEditButtonVisibilityExpression = getMassEditVisibility(converterContext, standardActionsContext);\n\tconst isInsertUpdateActionsTemplated = getInsertUpdateActionsTemplating(\n\t\tstandardActionsContext,\n\t\tisDraftOrStickySupported(converterContext)\n\t);\n\tconst standardActions = {\n\t\tcut: getStandardActionCut(converterContext, standardActionsContext),\n\t\tcopy: getStandardActionCopy(converterContext, standardActionsContext),\n\t\tcreate: getStandardActionCreate(converterContext, standardActionsContext),\n\t\tdelete: getStandardActionDelete(converterContext, standardActionsContext),\n\t\tpaste: getStandardActionPaste(converterContext, standardActionsContext, isInsertUpdateActionsTemplated),\n\t\tmassEdit: getStandardActionMassEdit(converterContext, standardActionsContext),\n\t\tinsights: getStandardActionInsights(converterContext, standardActionsContext, visualizationPath),\n\t\tcreationRow: getCreationRow(converterContext, standardActionsContext)\n\t};\n\tconst configuration: StandardActionsConfiguration = {\n\t\tcreationBehaviour,\n\t\tcutButtonVisibilityExpression,\n\t\tdeleteButtonVisibilityExpression,\n\t\tmassEditButtonVisibilityExpression,\n\t\tisInsertUpdateActionsTemplated,\n\t\tstandardActions\n\t};\n\n\tif (standardActionsContext.tableManifestConfiguration.type === \"TreeTable\") {\n\t\tconfiguration.standardActions.moveUp = getStandardActionMoveUpDown(converterContext, standardActionsContext, true);\n\t\tconfiguration.standardActions.moveDown = getStandardActionMoveUpDown(converterContext, standardActionsContext, false);\n\t}\n\n\treturn configuration;\n}\nexport function getTableAnnotationConfiguration(\n\tlineItemAnnotation: LineItem | undefined,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\ttableManifestConfiguration: TableControlConfiguration,\n\tcolumns: TableColumn[],\n\tnavigationSettings: NavigationSettingsConfiguration,\n\tstandardActionsConfiguration: StandardActionsConfiguration,\n\tpresentationVariantAnnotation?: PresentationVariantType\n): TableAnnotationConfiguration {\n\t// Need to get the target\n\tconst tableManifestSettings: TableManifestConfiguration = converterContext.getManifestControlConfiguration(visualizationPath);\n\tconst { navigationPropertyPath } = splitPath(visualizationPath);\n\tconst typeNamePlural = converterContext.getDataModelObjectPath().targetEntityType.annotations?.UI?.HeaderInfo?.TypeNamePlural;\n\tconst title = typeNamePlural && compileExpression(getExpressionFromAnnotation(typeNamePlural));\n\tconst entitySet = converterContext.getDataModelObjectPath().targetEntitySet;\n\tconst pageManifestSettings: ManifestWrapper = converterContext.getManifestWrapper();\n\tconst hasAbsolutePath = navigationPropertyPath.length === 0;\n\tconst p13nMode = getP13nMode(visualizationPath, converterContext, tableManifestConfiguration);\n\tconst id = navigationPropertyPath ? getTableID(visualizationPath) : getTableID(converterContext.getContextPath(), \"LineItem\");\n\tconst targetCapabilities = getCapabilityRestriction(converterContext);\n\tconst navigationTargetPath = getNavigationTargetPath(converterContext, navigationPropertyPath);\n\tconst selectionMode = getSelectionMode(\n\t\tlineItemAnnotation,\n\t\tvisualizationPath,\n\t\tconverterContext,\n\t\thasAbsolutePath,\n\t\ttargetCapabilities,\n\t\tstandardActionsConfiguration.deleteButtonVisibilityExpression,\n\t\tstandardActionsConfiguration.massEditButtonVisibilityExpression,\n\t\tstandardActionsConfiguration.cutButtonVisibilityExpression\n\t);\n\tlet threshold = navigationPropertyPath ? 10 : 30;\n\tif (presentationVariantAnnotation?.MaxItems) {\n\t\tthreshold = presentationVariantAnnotation.MaxItems.valueOf();\n\t} else if (tableManifestConfiguration.type === \"TreeTable\") {\n\t\t// To make scrolling smooth, we set the threshold value higher for tree tables\n\t\tthreshold = 200;\n\t} else if (tableManifestConfiguration.type === \"GridTable\" || tableManifestConfiguration.type === \"AnalyticalTable\") {\n\t\tthreshold = 100;\n\t}\n\tconst variantManagement: VariantManagementType = pageManifestSettings.getVariantManagement();\n\tconst isSearchable = isPathSearchable(converterContext.getDataModelObjectPath());\n\treturn {\n\t\tid: id,\n\t\tapiId: generate([id, \"Table\"]),\n\t\tentityName: entitySet ? entitySet.name : \"\",\n\t\tentityTypeName: entitySet && entitySet.entityType ? entitySet.entityType.name : \"\",\n\t\tcollection: getTargetObjectPath(converterContext.getDataModelObjectPath()),\n\t\tnavigationPath: navigationPropertyPath,\n\t\trow: _getRowConfigurationProperty(\n\t\t\tlineItemAnnotation,\n\t\t\tconverterContext,\n\t\t\tnavigationSettings,\n\t\t\tnavigationTargetPath,\n\t\t\ttableManifestConfiguration.type,\n\t\t\ttableManifestConfiguration.analyticalConfiguration?.aggregationOnLeafLevel\n\t\t),\n\t\tp13nMode,\n\t\tisInsertUpdateActionsTemplated: standardActionsConfiguration.isInsertUpdateActionsTemplated,\n\t\tupdatablePropertyPath: getCurrentEntitySetUpdatablePath(converterContext),\n\t\tdisplayMode: isInDisplayMode(converterContext, true),\n\t\tcreate: standardActionsConfiguration.creationBehaviour,\n\t\tselectionMode: selectionMode,\n\t\tvariantManagement: variantManagement === \"Control\" && !p13nMode ? VariantManagementType.None : variantManagement,\n\t\tthreshold: threshold,\n\t\tsortConditions: getSortConditions(converterContext, presentationVariantAnnotation, columns),\n\t\ttitle: title,\n\t\tsearchable:\n\t\t\ttableManifestSettings.tableSettings?.isSearchable === false\n\t\t\t\t? false\n\t\t\t\t: tableManifestConfiguration.type !== \"AnalyticalTable\" && !(isConstant(isSearchable) && isSearchable.value === false),\n\t\tinitialExpansionLevel: getInitialExpansionLevel(presentationVariantAnnotation),\n\t\trequiredProperties: getRequiredProperties(converterContext)\n\t\t\t.filter((property) => property?.$target?.type !== \"Edm.Boolean\")\n\t\t\t.map((property) => property.value)\n\t};\n}\n\n/**\n * Splits the visualization path into navigation property path and annotation.\n * @param visualizationPath\n * @returns The split path\n */\nexport function splitPath(visualizationPath: string): { navigationPropertyPath: string; annotationPath: string } {\n\tconst [targetNavigationPropertyPath, annotationPath] = visualizationPath.split(\"@\");\n\tlet navigationPropertyPath = targetNavigationPropertyPath;\n\tif (navigationPropertyPath.lastIndexOf(\"/\") === navigationPropertyPath.length - 1) {\n\t\t// Drop trailing slash\n\t\tnavigationPropertyPath = navigationPropertyPath.substring(0, navigationPropertyPath.length - 1);\n\t}\n\treturn { navigationPropertyPath, annotationPath };\n}\nexport function getSelectionVariantConfiguration(\n\tselectionVariantPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): SelectionVariantConfiguration | undefined {\n\tconst resolvedTarget = converterContext.getEntityTypeAnnotation(selectionVariantPath);\n\tconst selection: SelectionVariant = resolvedTarget.annotation as SelectionVariant;\n\tif (selection) {\n\t\tconst propertyNames: string[] = [];\n\t\tselection.SelectOptions?.forEach((selectOption: SelectOptionType) => {\n\t\t\tconst propertyName = selectOption.PropertyName;\n\t\t\tconst propertyPath: string = propertyName?.value ?? \"\";\n\t\t\tif (!propertyNames.includes(propertyPath)) {\n\t\t\t\tpropertyNames.push(propertyPath);\n\t\t\t}\n\t\t});\n\t\treturn {\n\t\t\ttext: selection?.Text?.toString(),\n\t\t\tpropertyNames: propertyNames\n\t\t};\n\t}\n\treturn undefined;\n}\nfunction _getFullScreenBasedOnDevice(\n\ttableSettings: TableManifestSettingsConfiguration,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tisIphone: boolean\n): boolean {\n\t// If enableFullScreen is not set, use as default true on phone and false otherwise\n\tlet enableFullScreen = tableSettings.enableFullScreen ?? isIphone;\n\t// Make sure that enableFullScreen is not set on ListReport for desktop or tablet\n\tif (!isIphone && enableFullScreen && converterContext.getTemplateType() === TemplateType.ListReport) {\n\t\tenableFullScreen = false;\n\t\tconverterContext.getDiagnostics().addIssue(IssueCategory.Manifest, IssueSeverity.Low, IssueType.FULLSCREENMODE_NOT_ON_LISTREPORT);\n\t}\n\treturn enableFullScreen;\n}\nfunction _getMultiSelectMode(\n\ttableSettings: TableManifestSettingsConfiguration,\n\ttableType: TableType,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): string | undefined {\n\tlet multiSelectMode: string | undefined;\n\tif (tableType !== \"ResponsiveTable\") {\n\t\treturn undefined;\n\t}\n\tswitch (converterContext.getTemplateType()) {\n\t\tcase TemplateType.ListReport:\n\t\tcase TemplateType.ObjectPage:\n\t\t\tmultiSelectMode = tableSettings.selectAll === false ? \"ClearAll\" : \"Default\";\n\t\t\tif (converterContext.getTemplateType() === TemplateType.ObjectPage && converterContext.getManifestWrapper().useIconTabBar()) {\n\t\t\t\tmultiSelectMode = !tableSettings.selectAll ? \"ClearAll\" : \"Default\";\n\t\t\t}\n\t\t\tbreak;\n\t\tcase TemplateType.AnalyticalListPage:\n\t\t\tmultiSelectMode = !tableSettings.selectAll ? \"ClearAll\" : \"Default\";\n\t\t\tbreak;\n\t\tdefault:\n\t}\n\treturn multiSelectMode;\n}\nfunction _getTableMode(\n\ttableType: TableType,\n\ttableSettings: TableManifestSettingsConfiguration,\n\tisTemplateListReport: boolean\n): { rowCountMode?: TableRowCountMode; rowCount?: number } {\n\tif (tableType !== \"ResponsiveTable\") {\n\t\tif (isTemplateListReport) {\n\t\t\treturn {\n\t\t\t\trowCountMode: \"Auto\",\n\t\t\t\trowCount: 3\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\trowCountMode: tableSettings.rowCountMode ?? \"Fixed\",\n\t\t\t\trowCount: tableSettings.rowCount ?? (tableType === \"GridTable\" ? 5 : 10)\n\t\t\t};\n\t\t}\n\t} else {\n\t\treturn {};\n\t}\n}\nfunction _getCondensedTableLayout(_tableType: TableType, _tableSettings: TableManifestSettingsConfiguration): boolean {\n\treturn _tableSettings.condensedTableLayout !== undefined && _tableType !== \"ResponsiveTable\"\n\t\t? _tableSettings.condensedTableLayout\n\t\t: false;\n}\nfunction _getTableSelectionLimit(_tableSettings: TableManifestSettingsConfiguration): number {\n\treturn _tableSettings.selectAll === true || _tableSettings.selectionLimit === 0 ? 0 : _tableSettings.selectionLimit || 200;\n}\nfunction _getTableInlineCreationRowCount(_tableSettings: TableManifestSettingsConfiguration): number {\n\treturn _tableSettings.creationMode?.inlineCreationRowCount ? _tableSettings.creationMode?.inlineCreationRowCount : 1;\n}\n\nfunction _getEnableExport(\n\ttableSettings: TableManifestSettingsConfiguration,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tenablePaste: boolean\n): boolean {\n\treturn tableSettings.enableExport !== undefined\n\t\t? tableSettings.enableExport\n\t\t: converterContext.getTemplateType() !== \"ObjectPage\" || enablePaste;\n}\nfunction _getFrozenColumnCount(tableSettings: TableManifestSettingsConfiguration): number | undefined {\n\treturn tableSettings.frozenColumnCount;\n}\n\n/**\n * Get the widthIncludingColumnHeader value from the tableSettings if it exists.\n * @param tableSettings TableSettings Object\n * @returns Returns the value of widthIncludingColumnHeader or false\n */\nfunction _getWidthIncludingColumnHeader(tableSettings: TableManifestSettingsConfiguration): boolean {\n\treturn tableSettings.widthIncludingColumnHeader ?? false;\n}\n\nfunction getFilterConfiguration(\n\ttableSettings: TableManifestSettingsConfiguration,\n\tlineItemAnnotation: LineItem,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tselectionVariantAnnotation: SelectionVariantType | undefined\n): {\n\tfilters: Partial<Record<\"quickFilters\" | \"hiddenFilters\", TableFiltersConfiguration>>;\n\theaderVisible: boolean;\n} {\n\tlet hideTableTitle = false;\n\tconst filters: Partial<Record<\"quickFilters\" | \"hiddenFilters\", TableFiltersConfiguration>> = {};\n\tconst targetEntityType = converterContext.getAnnotationEntityType(lineItemAnnotation);\n\tif (tableSettings.quickVariantSelection) {\n\t\tconst quickFilterPaths = (tableSettings.quickVariantSelection.paths ?? []).reduce(\n\t\t\t(filterPaths: { annotationPath: string }[], path) => {\n\t\t\t\tif (targetEntityType.resolvePath(path.annotationPath)) {\n\t\t\t\t\tfilterPaths.push({ annotationPath: path.annotationPath });\n\t\t\t\t}\n\t\t\t\treturn filterPaths;\n\t\t\t},\n\t\t\t[]\n\t\t);\n\t\tif (quickFilterPaths.length) {\n\t\t\tfilters.quickFilters = {\n\t\t\t\tshowCounts: tableSettings.quickVariantSelection.showCounts,\n\t\t\t\tpaths: quickFilterPaths\n\t\t\t};\n\t\t}\n\t}\n\tif (selectionVariantAnnotation) {\n\t\t/**\n\t\t * Provide Selection Variant to hiddenFilters in order to set the SV filters to the table.\n\t\t * MDC Table overrides binding Filter and from SAP FE the only method where we are able to add\n\t\t * additional filter is 'rebindTable' into Table delegate.\n\t\t * To avoid implementing specific LR feature to SAP FE Macro Table, the filter(s)  not managed by the FilterBar\n\t\t * can be passed to macro table via parameter/context named filters and key hiddenFilters.\n\t\t */\n\t\tfilters.hiddenFilters = { paths: [{ annotationPath: `@${selectionVariantAnnotation.fullyQualifiedName.split(\"@\")[1]}` }] };\n\t}\n\n\thideTableTitle = !!tableSettings.quickVariantSelection?.hideTableTitle;\n\treturn {\n\t\tfilters: filters,\n\t\theaderVisible: !(filters?.quickFilters && hideTableTitle)\n\t};\n}\n\n/**\n * Determines if the action will have an expression for enablement generated.\n * @param dataField The dataField containing an action\n * @param sEntityType The current entity for templating\n * @returns Whether an expression for enablement is to be generated\n */\nfunction _useEnabledExpression(dataField: DataFieldForActionTypes, sEntityType: string): boolean {\n\t// There are three cases when a table action has an OperationAvailable that leads to an enablement expression\n\t// and is not dependent upon the table entries.\n\t// 1. An action with an overload, that is executed against a parent entity.\n\t// 2. An unbound action\n\t// 3. A static action (that is, bound to a collection)\n\tlet useEnabledExpression = false;\n\tif (dataField.ActionTarget?.annotations?.Core?.OperationAvailable !== undefined) {\n\t\t// Unbound action. Is recognised, but getExpressionFromAnnotation checks for isBound = true, so not generated.\n\t\tconst isBound = dataField.ActionTarget?.isBound;\n\t\t//overload action\n\t\tconst overloadAction = isBound && dataField.ActionTarget?.sourceType !== sEntityType;\n\t\t//static action\n\t\tconst staticAction = dataField.ActionTarget?.parameters[0]?.isCollection;\n\t\t//copy action\n\t\tif (!isBound || overloadAction || staticAction) {\n\t\t\tuseEnabledExpression = true;\n\t\t}\n\t}\n\treturn useEnabledExpression;\n}\n\n/**\n * Updates the table control configuration with Tree-Table specific information.\n * @param tableConfiguration The table configuration\n * @param tableSettings Settings from the manifest\n * @param converterContext The instance of the converter context\n */\nfunction updateTreeTableManifestConfiguration(\n\ttableConfiguration: TableControlConfiguration,\n\ttableSettings: TableManifestSettingsConfiguration,\n\tconverterContext: ConverterContext\n): void {\n\tconst dataModelObjectPath = converterContext.getDataModelObjectPath();\n\ttableConfiguration.hierarchyQualifier = tableSettings.hierarchyQualifier;\n\tconst hierarchyParentNavigationPropertyPath = getHierarchyParentNavigationPropertyPath(\n\t\tdataModelObjectPath,\n\t\ttableConfiguration.hierarchyQualifier!\n\t);\n\tconst nonUpdatableNavigationProperties = getNonUpdatableNavigationProperties(dataModelObjectPath);\n\ttableConfiguration.isHierarchyParentNodeUpdatable = !nonUpdatableNavigationProperties?.includes(hierarchyParentNavigationPropertyPath);\n\ttableConfiguration.isNodeMovable = getCustomFunctionInfo(tableSettings.isNodeMovable, tableConfiguration);\n\ttableConfiguration.isNodeCopyable = getCustomFunctionInfo(tableSettings.isNodeCopyable, tableConfiguration);\n\ttableConfiguration.isMoveToPositionAllowed = getCustomFunctionInfo(tableSettings.isMoveToPositionAllowed, tableConfiguration);\n\ttableConfiguration.isCopyToPositionAllowed = getCustomFunctionInfo(tableSettings.isCopyToPositionAllowed, tableConfiguration);\n\ttableConfiguration.createEnablement = getCustomFunctionInfo(tableSettings.creationMode?.isCreateEnabled, tableConfiguration);\n\n\tif (tableSettings.creationMode?.nodeType?.propertyName && tableSettings.creationMode?.nodeType?.values) {\n\t\tconst values = tableSettings.creationMode.nodeType.values;\n\t\ttableConfiguration.nodeType = {\n\t\t\tpropertyName: tableSettings.creationMode.nodeType.propertyName,\n\t\t\tvalues: Object.keys(values).map((value) => {\n\t\t\t\tconst nodeTypeInfo = values[value];\n\n\t\t\t\tif (typeof nodeTypeInfo === \"string\") {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\ttext: nodeTypeInfo\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\ttext: nodeTypeInfo.label,\n\t\t\t\t\t\tcreationDialogFields:\n\t\t\t\t\t\t\ttableConfiguration.creationMode === CreationMode.CreationDialog\n\t\t\t\t\t\t\t\t? getFieldList(nodeTypeInfo.creationFields, converterContext)\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\t}\n\n\t// Create in place\n\tif (tableSettings.creationMode?.createInPlace) {\n\t\ttableConfiguration.createInPlace = true;\n\t}\n}\n\nexport function getCustomFunctionInfo(\n\tvalue: string | undefined,\n\ttableConfiguration: TableControlConfiguration\n): ExternalMethodConfig | undefined {\n\tif (!value) {\n\t\treturn undefined;\n\t}\n\tconst lastDotIndex = value.lastIndexOf(\".\") || -1;\n\tconst moduleName = value.substring(0, lastDotIndex).replace(/\\./gi, \"/\");\n\tconst methodName = value.substring(lastDotIndex + 1);\n\n\t// Add the custom module in the list of required modules if necessary\n\tif (!moduleName.startsWith(\"/extension/\")) {\n\t\tif (!tableConfiguration.additionalRequiredModules) {\n\t\t\ttableConfiguration.additionalRequiredModules = [moduleName];\n\t\t} else if (!tableConfiguration.additionalRequiredModules.includes(moduleName)) {\n\t\t\ttableConfiguration.additionalRequiredModules.push(moduleName);\n\t\t}\n\t}\n\n\treturn { moduleName, methodName };\n}\n\n/**\n * Retrieve the table control configuration optimistic batch information.\n * @param tableManifestSettings The table configuration\n @returns True if Optimistic batch mode is disabled\n */\nfunction getOptimisticBatchSettingsFromManifest(tableManifestSettings: TableManifestConfiguration): boolean | undefined {\n\t// Optimistic batch is set by default\n\treturn tableManifestSettings?.tableSettings?.disableRequestCache;\n}\n\n/**\n * Gets the settings coming from the manifest related to the mass edit dialog.\n * @param tableSettings The table configuration\n * @param converterContext The instance of the converter context\n * @returns The mass edit configuration.\n */\nexport function getMassEditSettings(\n\ttableSettings: TableManifestSettingsConfiguration,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): MassEditTableConfiguration {\n\tconst defaultFieldConfiguration = {\n\t\tvisibleFields: [],\n\t\tignoredFields: [],\n\t\toperationGroupingMode:\n\t\t\tconverterContext.getTemplateType() === TemplateType.ListReport\n\t\t\t\t? OperationGroupingMode.Isolated\n\t\t\t\t: OperationGroupingMode.ChangeSet\n\t};\n\tif (!tableSettings.enableMassEdit) {\n\t\treturn { enabled: false, ...defaultFieldConfiguration };\n\t}\n\tif (tableSettings.enableMassEdit === true) {\n\t\treturn { enabled: tableSettings.enableMassEdit, ...defaultFieldConfiguration };\n\t} else if (typeof tableSettings.enableMassEdit === \"object\") {\n\t\treturn {\n\t\t\tenabled: true,\n\t\t\tvisibleFields: getFieldList(tableSettings.enableMassEdit.visibleFields, converterContext),\n\t\t\tignoredFields: getFieldList(tableSettings.enableMassEdit.ignoredFields, converterContext),\n\t\t\toperationGroupingMode:\n\t\t\t\ttableSettings.enableMassEdit.operationGroupingMode &&\n\t\t\t\tObject.values(OperationGroupingMode).includes(tableSettings.enableMassEdit.operationGroupingMode)\n\t\t\t\t\t? tableSettings.enableMassEdit.operationGroupingMode\n\t\t\t\t\t: defaultFieldConfiguration.operationGroupingMode,\n\t\t\tcustomFragment: tableSettings.enableMassEdit.customFragment,\n\t\t\tfromInline: tableSettings.enableMassEdit.fromInline\n\t\t};\n\t}\n\treturn { enabled: false, ...defaultFieldConfiguration };\n}\n\n/**\n * Gets a list of the fields coming from the manifest.\n * @param fields The fields, could be a FieldGroup or fields separated by a comma\n * @param converterContext The instance of the converter context\n * @returns The list of fields.\n */\nfunction getFieldList(fields: string | undefined, converterContext: ConverterContext<PageContextPathTarget>): string[] {\n\tif (!fields) {\n\t\treturn [];\n\t}\n\tif (fields.includes(UIAnnotationTerms.FieldGroup)) {\n\t\tfields = fields.startsWith(\"@\") ? fields : `@${fields}`;\n\t\tconst fieldGroup = converterContext.getEntityTypeAnnotation<FieldGroup>(fields);\n\t\tif (isAnnotationOfType<FieldGroup>(fieldGroup.annotation, UIAnnotationTypes.FieldGroupType)) {\n\t\t\treturn fieldGroup.annotation.Data.reduce((properties: string[], field) => {\n\t\t\t\tif (isDataField(field) && isPathAnnotationExpression(field.Value)) {\n\t\t\t\t\tproperties.push(field.Value.path);\n\t\t\t\t}\n\t\t\t\treturn properties;\n\t\t\t}, []);\n\t\t}\n\t\treturn [];\n\t}\n\treturn fields\n\t\t.replace(/\\s/g, \"\")\n\t\t.split(\",\")\n\t\t.map((name) => name.trim());\n}\n\nexport function getTableManifestConfiguration(\n\tlineItemAnnotation: LineItem | undefined,\n\tvisualizationPath: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tcheckCondensedLayout = true,\n\tselectionVariantAnnotation?: SelectionVariantType\n): TableControlConfiguration {\n\tconst _manifestWrapper = converterContext.getManifestWrapper();\n\tconst tableManifestSettings: TableManifestConfiguration = converterContext.getManifestControlConfiguration(visualizationPath);\n\tconst tableSettings = tableManifestSettings?.tableSettings ?? {};\n\tconst globalFEManifestSettings = _manifestWrapper.getSapFeManifestConfiguration();\n\tconst defaultCreationMode =\n\t\tglobalFEManifestSettings?.macros?.table?.defaultCreationMode === \"InlineCreationRows\" ? CreationMode.InlineCreationRows : undefined;\n\tconst creationMode: CreationMode = tableSettings.creationMode?.name ?? defaultCreationMode ?? CreationMode.NewPage;\n\tconst enableAutoColumnWidth = !_manifestWrapper.isPhone();\n\tconst disableCopyToClipboard = tableSettings.disableCopyToClipboard;\n\tconst templateType = converterContext.getTemplateType();\n\tconst isCondensedTableLayoutCompliant = checkCondensedLayout && _manifestWrapper.isCondensedLayoutCompliant();\n\tconst oFilterConfiguration = lineItemAnnotation\n\t\t? getFilterConfiguration(tableSettings, lineItemAnnotation, converterContext, selectionVariantAnnotation)\n\t\t: {};\n\tconst customValidationFunction = tableSettings.creationMode?.customValidationFunction;\n\tconst exportRequestSize = tableSettings.exportRequestSize;\n\tconst tableType = getTableType(converterContext, tableManifestSettings);\n\tconst analyticalConfiguration = tableSettings.analyticalConfiguration;\n\t// By default, paste is enabled on an ObjectPage and on a ListReport with a draft TreeTable\n\tconst enablePaste =\n\t\ttableSettings.enablePaste ??\n\t\t(converterContext.getTemplateType() === \"ObjectPage\" ||\n\t\t\t(tableType === \"TreeTable\" && (converterContext.getEntitySet() as EntitySet)?.annotations.Common?.DraftRoot !== undefined));\n\tconst tableRowMode = _getTableMode(tableType, tableSettings, templateType === TemplateType.ListReport);\n\tconst defaultScrollThreshold = tableType !== \"ResponsiveTable\" ? 300 : undefined;\n\tconst condensedTableLayout = _getCondensedTableLayout(tableType, tableSettings);\n\tlet inlineCreationRowsHiddenInEditMode = false;\n\tif (tableSettings.creationMode?.inlineCreationRowsHiddenInEditMode) {\n\t\tinlineCreationRowsHiddenInEditMode =\n\t\t\ttypeof tableSettings.creationMode?.inlineCreationRowsHiddenInEditMode === \"string\"\n\t\t\t\t? tableSettings.creationMode?.inlineCreationRowsHiddenInEditMode === \"true\"\n\t\t\t\t: tableSettings.creationMode?.inlineCreationRowsHiddenInEditMode;\n\t}\n\tlet useTextForNoDataMessages: string;\n\tif (converterContext.getTemplateType() === \"ListReport\") {\n\t\tuseTextForNoDataMessages = \"illustratedMessage-Auto\";\n\t} else {\n\t\tuseTextForNoDataMessages = _manifestWrapper.getUseTextForNoDataMessages() ? \"text\" : \"illustratedMessage-ExtraSmall\";\n\t}\n\tconst oConfiguration = {\n\t\t// If no createAtEnd is specified it will be false for Inline/CreationDialog create and true otherwise\n\t\tcreateAtEnd:\n\t\t\ttableSettings.creationMode?.createAtEnd !== undefined\n\t\t\t\t? tableSettings.creationMode?.createAtEnd\n\t\t\t\t: ![CreationMode.Inline, CreationMode.CreationDialog].includes(creationMode),\n\t\tcreationMode: creationMode,\n\t\tcreationDialogFields:\n\t\t\tcreationMode === CreationMode.CreationDialog\n\t\t\t\t? getFieldList(tableSettings.creationMode?.creationFields, converterContext)\n\t\t\t\t: undefined,\n\t\tcustomValidationFunction: customValidationFunction,\n\t\thasDataStateIndicatorFilter: templateType === TemplateType.ListReport,\n\t\t// if a custom validation function is provided, disableAddRowButtonForEmptyData should not be considered, i.e. set to false\n\t\tdisableAddRowButtonForEmptyData: !customValidationFunction ? !!tableSettings.creationMode?.disableAddRowButtonForEmptyData : false,\n\t\tenableAutoColumnWidth: enableAutoColumnWidth,\n\t\tenablePastingOfComputedProperties: tableSettings.enablePastingOfComputedProperties,\n\t\tignoredFields: tableSettings.ignoredFields,\n\t\treadOnly: tableSettings.readOnly,\n\t\tenableExport: _getEnableExport(tableSettings, converterContext, enablePaste),\n\t\tanalyticalConfiguration,\n\t\tfrozenColumnCount: _getFrozenColumnCount(tableSettings),\n\t\twidthIncludingColumnHeader: _getWidthIncludingColumnHeader(tableSettings),\n\t\tenableFullScreen: _getFullScreenBasedOnDevice(tableSettings, converterContext, _manifestWrapper.isPhone()),\n\t\tmassEdit: getMassEditSettings(tableSettings, converterContext),\n\t\tenableAddCardToInsights: tableSettings?.enableAddCardToInsights,\n\t\tenablePaste: enablePaste,\n\t\tdisableCopyToClipboard: disableCopyToClipboard,\n\t\theaderVisible: true,\n\t\theader: tableSettings.header,\n\t\tmultiSelectMode: _getMultiSelectMode(tableSettings, tableType, converterContext),\n\t\tselectionLimit: _getTableSelectionLimit(tableSettings),\n\t\tinlineCreationRowCount: _getTableInlineCreationRowCount(tableSettings),\n\t\tinlineCreationRowsHiddenInEditMode: inlineCreationRowsHiddenInEditMode,\n\t\tshowRowCount: tableSettings?.quickVariantSelection?.paths ? false : !_manifestWrapper.getViewConfiguration()?.showCounts,\n\t\ttype: tableType,\n\t\tdisableRequestCache: getOptimisticBatchSettingsFromManifest(tableManifestSettings),\n\t\tuseCondensedTableLayout: condensedTableLayout && isCondensedTableLayoutCompliant,\n\t\tisCompactType: _manifestWrapper.isCompactType(),\n\t\texportRequestSize: exportRequestSize,\n\t\tenableUploadPlugin: !!converterContext.getAnnotationEntityType().annotations?.UI?.MediaResource?.Stream,\n\t\tmodeForNoDataMessage: useTextForNoDataMessages,\n\t\tscrollThreshold: tableSettings.scrollThreshold ?? defaultScrollThreshold\n\t};\n\n\tconst tableConfiguration: TableControlConfiguration = { ...oConfiguration, ...tableRowMode, ...oFilterConfiguration };\n\ttableConfiguration.beforeRebindTable = tableSettings.beforeRebindTable;\n\ttableConfiguration.selectionChange = tableSettings.selectionChange;\n\ttableConfiguration.rowPress = tableSettings.rowPress;\n\tif (tableType === \"TreeTable\") {\n\t\tupdateTreeTableManifestConfiguration(tableConfiguration, tableSettings, converterContext);\n\t}\n\n\tif (tableSettings.headerVisible !== undefined) {\n\t\ttableConfiguration.headerVisible = tableSettings.headerVisible;\n\t}\n\n\tif (tableConfiguration.creationMode === CreationMode.External) {\n\t\ttableConfiguration.outboundCreation = tableSettings.creationMode?.outbound;\n\t}\n\n\treturn tableConfiguration;\n}\n\nfunction getTableType(\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\ttableManifestSettings?: TableManifestConfiguration\n): TableType {\n\tif (tableManifestSettings?.tableSettings?.type) {\n\t\t// in case the application specified a table type we will use this one\n\t\treturn tableManifestSettings.tableSettings.type;\n\t}\n\n\t// default is the ResponsiveTable\n\treturn \"ResponsiveTable\";\n}\n\nexport default {\n\tgetTableActions,\n\tcreateTableVisualization,\n\tcreateDefaultTableVisualization,\n\tgetCapabilityRestriction,\n\tgetSelectionMode,\n\tgetP13nMode,\n\tgetStandardActionsConfiguration,\n\tgetTableAnnotationConfiguration,\n\tsplitPath,\n\tgetSelectionVariantConfiguration,\n\tgetTableManifestConfiguration,\n\tupdateTableVisualizationForType,\n\tcreateRequestedProperties,\n\tgetNavigationTargetPath,\n\tgetCustomFunctionInfo\n};\n"],"mappings":"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","ignoreList":[]}