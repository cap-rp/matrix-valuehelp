/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/annotations/DataField","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","../../../helpers/StableIdHelper","../../ManifestSettings","../../helpers/ConfigurableObject","../../helpers/DataFieldHelper","../../helpers/ID","../../helpers/Key"],function(e,t,a,n,i,o,r,s,l,c){"use strict";var f={};var u=c.KeyHelper;var d=l.getFormStandardActionButtonID;var p=l.getFormID;var v=s.isReferencePropertyStaticallyHidden;var m=r.insertCustomElements;var y=r.Placement;var h=r.OverrideType;var O=o.ActionType;var P=i.createIdForAnnotation;var g=n.getTargetObjectPath;var b=n.getTargetEntitySetPath;var F=a.isSingleton;var A=a.isNavigationProperty;var T=t.getSemanticObjectPath;var I=e.pathInModel;var E=e.not;var D=e.ifElse;var C=e.getExpressionFromAnnotation;var S=e.equal;var w=e.compileExpression;let N=function(e){e["Default"]="Default";e["Slot"]="Slot";e["Annotation"]="Annotation";return e}({});f.FormElementType=N;function U(){return{textLinesEdit:4}}function M(e,t){return t?.valueOf()===false||e.annotations?.UI?.PartOfPreview===undefined||e.annotations?.UI?.PartOfPreview.valueOf()===true}function k(e,t){const a=[];const n=t.getEntityTypeAnnotation(e.Target.value);const i=n.annotation;t=n.converterContext;function o(e,n){const i=T(t,e);if(e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForActionGroup"&&!v(e)){const o={key:u.generateKeyFromDataField(e),type:N.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,semanticObjectPath:i,formatOptions:U(),isPartOfPreview:M(e,n)};if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target.$target?.$Type==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"){const a=Object.values(e.Target.$target.Data).filter(e=>e?.hasOwnProperty("Value"));o.connectedFields=a.map(e=>({semanticObjectPath:T(t,e)}))}a.push(o)}}switch(i?.term){case"com.sap.vocabularies.UI.v1.FieldGroup":i.Data.forEach(t=>o(t,e.annotations?.UI?.PartOfPreview));break;case"com.sap.vocabularies.UI.v1.Identification":i.forEach(t=>o(t,e.annotations?.UI?.PartOfPreview));break;case"com.sap.vocabularies.UI.v1.DataPoint":a.push({key:`DataPoint::${i.qualifier?i.qualifier:""}`,type:N.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.UI.v1.InputMask":a.push({key:`MaskedInput::${i.qualifier?i.qualifier:""}`,type:N.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.Common.v1.Masked":a.push({key:`Masked::${i.qualifier?i.qualifier:""}`,type:N.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.Communication.v1.Contact":a.push({key:`Contact::${i.qualifier?i.qualifier:""}`,type:N.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(i.fullyQualifiedName)}/`});break;default:break}return a}function $(e,t){const a=t.getManifestWrapper();const n=a.getFormContainer(e.Target.value);const i={};if(n?.fields){Object.keys(n?.fields).forEach(e=>{i[e]={key:e,id:`CustomFormElement::${e}`,type:n.fields[e].type||N.Default,template:n.fields[e].template,propertyPath:n.fields[e]?.property,label:t.fetchTextFromMetaModel(n.fields[e].label),position:n.fields[e].position||{placement:y.After},formatOptions:{...U(),...n.fields[e].formatOptions},...n.fields[e].readOnly!==undefined&&{readOnly:n.fields[e].readOnly},...n.fields[e].semanticObject!==undefined&&{semanticObject:n.fields[e].semanticObject}}})}return i}f.getFormElementsFromManifest=$;function j(e,t,a,n){const i=P(e);const o=t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName);const r=t.getEntityTypeAnnotation(e.Target.value);const s=w(E(S(true,C(e.annotations?.UI?.Hidden))));let l;const c=r.converterContext.getEntitySet();const f=r.converterContext.getDataModelObjectPath().targetObject;if(c&&c!==t.getEntitySet()){l=b(r.converterContext.getDataModelObjectPath())}else if(A(f)&&f?.containsTarget===true){l=g(r.converterContext.getDataModelObjectPath(),false)}else if(c&&!l&&F(c)){l=c.fullyQualifiedName}else if(!c&&A(f)&&f?.containsTarget===false){l=g(r.converterContext.getDataModelObjectPath(),false)}const u=m(k(e,t),$(e,t),{formatOptions:h.overwrite,readOnly:h.overwrite,semanticObject:h.overwrite});a=a!==undefined?a.filter(t=>t.facetName==e.fullyQualifiedName):[];if(a.length===0){a=undefined}const p={id:d(i,"ShowHideDetails"),key:"StandardAction::ShowHideDetails",text:w(D(S(I("showDetails","internal"),true),I("T_COMMON_OBJECT_PAGE_HIDE_FORM_CONTAINER_DETAILS","sap.fe.i18n"),I("T_COMMON_OBJECT_PAGE_SHOW_FORM_CONTAINER_DETAILS","sap.fe.i18n"))),type:O.ShowFormDetails,press:"FormContainerRuntime.toggleDetails"};if(e.annotations?.UI?.PartOfPreview?.valueOf()!==false&&u.some(e=>e.isPartOfPreview===false)){if(a!==undefined){a.push(p)}else{a=[p]}}return{id:i,formElements:u,annotationPath:o,isVisible:s,entitySet:l,actions:a,useSingleTextAreaFieldAsNotes:n?.useSingleTextAreaFieldAsNotes,annotationHidden:e.annotations?.UI?.Hidden?true:false}}f.getFormContainer=j;function x(e,t,a,n){const i=[];const o={useSingleTextAreaFieldAsNotes:n?.useSingleTextAreaFieldAsNotes};e.Facets?.forEach(e=>{if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return}i.push(j(e,t,a,o))});return i}function _(e){return e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"}f.isReferenceFacet=_;function H(e,t,a,n,i){switch(e?.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":return{id:p(e),useFormContainerLabels:true,hasFacetsNotPartOfPreview:e.Facets.some(e=>e.annotations?.UI?.PartOfPreview?.valueOf()===false),formContainers:x(e,a,n,i),isVisible:t};case"com.sap.vocabularies.UI.v1.ReferenceFacet":return{id:p(e),useFormContainerLabels:false,hasFacetsNotPartOfPreview:e.annotations?.UI?.PartOfPreview?.valueOf()===false,formContainers:[j(e,a,n,i)],isVisible:t};default:throw new Error("Cannot create form based on ReferenceURLFacet")}}f.createFormDefinition=H;return f},false);
//# sourceMappingURL=Form.js.map