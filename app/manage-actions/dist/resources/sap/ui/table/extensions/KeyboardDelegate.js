/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["../utils/TableUtils","../library","sap/base/i18n/Localization","sap/ui/base/Object","sap/ui/Device","sap/ui/events/KeyCodes","sap/ui/thirdparty/jquery"],function(e,t,o,i,n,s,jQuery){"use strict";const l=e.CELLTYPE;const f=t.SelectionMode;const r={CTRL:1,SHIFT:2,ALT:4};const c=5;const a="1rem";function u(e,t){e.setMarked("sapUiTableSkipItemNavigation",t!==false)}function g(t){if(e.getCellInfo(t.target).isOfType(l.ANY)){t.preventDefault();t.stopPropagation()}}const d=i.extend("sap.ui.table.extensions.KeyboardDelegate",{constructor:function(e){i.call(this)},destroy:function(){i.prototype.destroy.apply(this,arguments)},getInterface:function(){return this}});function h(t,o){if(!m(t,o)){return}const i=e.getCellInfo(e.getCell(t,o.target));if(i.isOfType(l.ANYCOLUMNHEADER)){C(t,i,o)}else if(i.isOfType(l.ANYCONTENTCELL)){p(t,i,o)}}function C(t,o,i){const n=e.getHeaderRowCount(t);if(e.isNoDataVisible(t)){const o=e.getFocusedItemInfo(t);if(o.row-n<=1){u(i)}}else if(o.isOfType(l.COLUMNROWHEADER)&&n>1){u(i);e.focusItem(t,n*(e.getVisibleColumnCount(t)+1),i)}}function p(t,o,i){const n=t._getKeyboardExtension();const s=n.isInActionMode();const l=d._isKeyCombination(i,null,r.CTRL);const f=l||s;const c=e.getParentCell(t,i.target);if(!f&&c){c.trigger("focus");return}u(i);if(e.isLastScrollableRow(t,o.cell)){const e=I(t,i);if(e){i.preventDefault();return}}if(o.rowIndex===t.getRows().length-1||e.isVariableRowHeightEnabled(t)&&o.rowIndex===t.getRows().length-2&&t.getRows()[o.rowIndex+1].getRowBindingContext()===null){if(!s&&c){c.trigger("focus")}else{const e=t.getCreationRow();if(!e||!e._takeOverKeyboardHandling(i)){n.setActionMode(false)}}return}M(t,o.type,o.rowIndex+1,o.columnIndex,f);i.preventDefault()}function T(t,o){const i=e.getCellInfo(e.getCell(t,o.target));if(!i.isOfType(l.ANYCONTENTCELL)||!m(t,o)){return}const n=d._isKeyCombination(o,null,r.CTRL);const s=t._getKeyboardExtension();const f=s.isInActionMode();const c=n||f;const a=e.getParentCell(t,o.target);if(!c&&a){a.trigger("focus");return}u(o);if(e.isFirstScrollableRow(t,i.cell)){const e=E(t,o);if(e){o.preventDefault();return}}if(i.rowIndex===0){u(o,c);if(!f&&a){a.trigger("focus")}else{s.setActionMode(false)}return}M(t,i.type,i.rowIndex-1,i.columnIndex,c);o.preventDefault()}function m(e,t){const o=d._isKeyCombination(t,null,r.CTRL);return!t.isMarked()&&(o||!(t.target instanceof window.HTMLInputElement)&&!(t.target instanceof window.HTMLTextAreaElement))}function y(e){return new Promise(function(t){e.attachEventOnce("_rowsUpdated",t)})}function R(e){if(e._isWaitingForData()){return y(e).then(function(){return R(e)})}return Promise.resolve()}function I(e,t,o,i){const n=e._getFirstRenderedRowIndex()===e._getMaxFirstRenderedRowIndex();if(n){return null}return A(e,t,true,o,i)}function E(e,t,o,i){const n=e._getFirstRenderedRowIndex()===0;if(n){return null}return A(e,t,false,o,i)}function A(t,o,i,n,s){const f=e.getCellInfo(e.getCell(t,o.target));const c=t._getKeyboardExtension().isInActionMode();const a=d._isKeyCombination(o,null,r.CTRL);const u=a||c;const g=c&&f.isOfType(l.DATACELL);if(g){t._getKeyboardExtension().setSilentFocus(t.getDomRef("focusDummy"));setTimeout(function(){t._getScrollExtension().scrollVertically(i===true,n)},0)}else{t._getScrollExtension().scrollVertically(i===true,n)}return y(t).then(function(){if(s){s()}else if(u){M(t,f.type,f.rowIndex,f.columnIndex,true)}})}function b(t,o){const i=e.getFocusedItemInfo(t);const n=t._getKeyboardExtension().getLastFocusedCellInfo();e.focusItem(t,i.cellInRow+i.columnCount*n.row,o)}function x(t,o){const i=e.getFocusedItemInfo(t);e.focusItem(t,i.cellInRow,o)}function O(e,t){e._getKeyboardExtension().setSilentFocus(e.$().find("."+t))}d._isKeyCombination=function(e,t,o){if(o==null){o=0}const i=typeof t==="string"?String.fromCharCode(e.charCode):e.keyCode;let l=0;l|=(n.os.macintosh?e.metaKey:e.ctrlKey)&&t!==s.CONTROL?r.CTRL:0;l|=e.shiftKey&&t!==s.SHIFT?r.SHIFT:0;l|=e.altKey&&t!==s.ALT?r.ALT:0;const f=t==null||i===t;const c=o===l;return f&&c};function _(t,o){const i=e.getCell(t,o);const n=e.getCellInfo(i);return t.getRows()[n.rowIndex]}function w(t,o){const i=e.getCellInfo(o.target);if(i.isOfType(l.COLUMNROWHEADER)){t._getSelectionPlugin().onHeaderSelectorPress()}else if(d._allowsToggleExpandedState(t,o.target)){_(t,o.target).toggleExpandedState()}else if(i.isOfType(l.ROWHEADER)){n()}else if(i.isOfType(l.DATACELL|l.ROWACTION)){let i=!t.hasListeners("cellClick");if(!t._findAndfireCellEvent(t.fireCellClick,o)){if(e.isRowSelectionAllowed(t)){n();i=false}}if(i){const i=e.getInteractiveElements(o.target);if(i){t._getKeyboardExtension().setActionMode(true)}}}function n(){let i=null;if(t._legacyMultiSelection){i=function(e){t._legacyMultiSelection(e.getIndex(),o)}}e.toggleRowSelection(t,o.target,null,i)}}function L(t,o){const i=t.getParent();const n=i._getVisibleColumns();const s=n.indexOf(t);let l;if(o&&s<n.length-1){l=i.indexOfColumn(n[s+1])+1}else if(!o&&s>0){l=i.indexOfColumn(n[s-1])}if(l!=null){e.Column.moveColumnTo(t,l)}}function S(e,t){const o=e.getColumns().filter(function(e){return e.getVisible()||(e.getGrouped?e.getGrouped():false)});for(let e=0;e<o.length;e++){const i=o[e];if(i===t){return e}}return-1}function N(t,o,i){if(!i){if(t._oRangeSelection.selected){e.toggleRowSelection(t,o,true)}else{e.toggleRowSelection(t,o,false)}}else{e.toggleRowSelection(t,o,false)}}d._focusElement=function(e,t,o){if(!e||!t){return}if(o==null){o=false}if(o){e._getKeyboardExtension().setSilentFocus(t)}else{t.focus()}if(t instanceof window.HTMLInputElement){t.select()}};function M(t,o,i,n,s,f){if(!t||o==null||i==null||i<0||i>=t.getRows().length){return}const r=t.getRows()[i];let c;if(o===l.ROWHEADER){t._getKeyboardExtension().setFocus(t.getDomRef("rowsel"+i));return}else if(o===l.ROWACTION){c=t.getDomRef("rowact"+i)}else if(o===l.DATACELL&&(n!=null&&n>=0)){const e=t.getColumns()[n];const o=S(t,e);if(o>=0){c=r.getDomRef("col"+o)}}if(!c){return}if(s){const o=e.getInteractiveElements(c);if(o){d._focusElement(t,o[0]);return}}if(f){t._getKeyboardExtension()._bStayInActionMode=true}c.focus()}function D(e){return e.classList.contains("sapUiTableTreeIconNodeOpen")||e.classList.contains("sapUiTableTreeIconNodeClosed")}d._allowsToggleExpandedState=function(t,o){return e.Grouping.isInGroupHeaderRow(o)||e.Grouping.isInTreeMode(t)&&o.classList.contains("sapUiTableCellFirst")&&(o.querySelector(".sapUiTableTreeIconNodeOpen")||o.querySelector(".sapUiTableTreeIconNodeClosed"))||D(o)};function K(e){const t={};const o=e._getRowCounts();const i=e.getRows();t.header=H(e);t.top=[];t.scrollable=[];t.bottom=[];for(let n=0;n<o.fixedTop;n++){t.top.push(...F(e,i[n]))}for(let n=o.fixedTop;n<i.length-o.fixedBottom;n++){t.scrollable.push(...F(e,i[n]))}for(let n=i.length-o.fixedBottom;n<i.length;n++){t.bottom.push(...F(e,i[n]))}t.all=t.header.concat(t.top,t.scrollable,t.bottom);return t}function H(t){const o=[];const i=t.$();function n(t){return`.sapUiTableHeaderRow:nth-of-type(${t+1}) .sapUiTableCell ${e.INTERACTIVE_ELEMENT_SELECTOR}`}if(e.hasSelectAll(t)){o.push(t.getDomRef("selall"))}for(let s=0;s<e.getHeaderRowCount(t);s++){o.push(...i.find(n(s)))}return o}function F(t,o){const i=[];const n=e.isRowSelectorSelectionAllowed(t);const s=!o.isEmpty()&&(n||o.isGroupHeader());const l=o.getDomRefs(true);if(s){i.push(l.rowHeaderPart[0].querySelector(".sapUiTableCell"))}let f=l.row.find(`.sapUiTableCell ${e.INTERACTIVE_ELEMENT_SELECTOR}`);if(t._getKeyboardExtension().isInActionMode()){f=f.add(l.row.find(".sapUiTableDataCell:focus"))}i.push(...f.toArray());return i}function U(t){const o=e.getRowIndexOfFocusedCell(t);const i=t.getRows()[o];const n=i.getIndex();t._oRangeSelection={startIndex:n,selected:i._isSelected()}}d.prototype.enterActionMode=function(){const t=this._getKeyboardExtension();const o=document.activeElement;const i=e.getInteractiveElements(o);const n=e.getParentCell(this,o);if(i){t.suspendItemNavigation();o.tabIndex=-1;d._focusElement(this,i[0],true);return true}else if(n){this._getKeyboardExtension().suspendItemNavigation();return true}return false};d.prototype.leaveActionMode=function(t){const o=this._getKeyboardExtension();const i=document.activeElement;const n=e.getParentCell(this,i);o.resumeItemNavigation();if(t){return}if(n){d._focusElement(this,n[0],true)}else{const e=this._getItemNavigation();if(e){const t=e.aItemDomRefs;const o=t.indexOf(i);if(o>-1){e.setFocusedIndex(o)}}o.setSilentFocus(i)}};d.prototype.onfocusout=function(e){if(this.getRows().length||this.getColumnHeaderVisible()){this.$().find(".sapUiTableCtrlBefore").attr("tabindex","0");this.$().find(".sapUiTableCtrlAfter").attr("tabindex","0")}};d.prototype.onfocusin=function(t){if(this.getDomRef("sapUiTableCnt").contains(t.target)){this.$().find(".sapUiTableCtrlBefore").attr("tabindex","-1");this.$().find(".sapUiTableCtrlAfter").attr("tabindex","-1")}if(t.isMarked("sapUiTableIgnoreFocusIn")){return}const o=this._getKeyboardExtension();const i=jQuery(t.target);if(i.hasClass("sapUiTableOuterBefore")||i.hasClass("sapUiTableOuterAfter")||t.target!==this.getDomRef("overlay")&&this.getShowOverlay()){this.$("overlay").trigger("focus")}else if(i.hasClass("sapUiTableCtrlBefore")){const i=e.isNoDataVisible(this);const n=this.getDomRef("busyIndicator");if(n){o.setSilentFocus(n)}else if(this.getColumnHeaderVisible()&&(e.getVisibleColumnCount(this)||e.hasRowHeader(this))){x(this,t)}else if(i){o.setSilentFocus(this.$("noDataCnt"))}}else if(i.hasClass("sapUiTableCtrlAfter")){const i=this.getDomRef("busyIndicator");if(i){o.setSilentFocus(i)}else if(this.getRows().length&&!e.isNoDataVisible(this)){b(this,t)}else if(this.getColumnHeaderVisible()&&(e.getVisibleColumnCount(this)||e.hasRowHeader(this))){x(this,t)}}const n=e.getCellInfo(t.target);const s=n.isOfType(l.ROWHEADER)&&e.Grouping.isInGroupHeaderRow(t.target);const f=n.isOfType(l.ROWHEADER)&&!s&&e.isRowSelectorSelectionAllowed(this);const r=n.isOfType(l.COLUMNROWHEADER)&&e.isRowSelectorSelectionAllowed(this);const c=s||f||r||o._bStayInActionMode;const a=e.getCellInfo(e.getParentCell(this,t.target)).isOfType(l.ANY);const u=jQuery(t.target).is(e.INTERACTIVE_ELEMENT_SELECTOR);const g=o.isInActionMode()&&c||u&&a;o._bStayInActionMode=false;o.setActionMode(g,true)};d.prototype.onkeydown=function(t){if(t.isMarked()){return}const o=this._getKeyboardExtension();let i=e.getCellInfo(t.target);const n=this.getSelectionMode();const c=this._getSelectionPlugin();if(d._isKeyCombination(t,s.F2)){const n=o.isInActionMode();const s=e.getCell(this,t.target);const l=e.getParentCell(this,t.target)!=null;i=e.getCellInfo(s);if(l&&!n){s.trigger("focus")}else{o.setActionMode(!n)}return}if(d._isKeyCombination(t,s.F4)&&d._allowsToggleExpandedState(this,t.target)){_(this,t.target).toggleExpandedState();return}if(d._isKeyCombination(t,s.SPACE)&&D(t.target)){t.preventDefault();return}if(this._getKeyboardExtension().isInActionMode()||!i.isOfType(l.ANY)){return}if(d._isKeyCombination(t,s.SPACE)){t.preventDefault()}if(d._isKeyCombination(t,s.SHIFT)&&n===f.MultiToggle&&(i.isOfType(l.ROWHEADER)&&e.isRowSelectorSelectionAllowed(this)||i.isOfType(l.DATACELL|l.ROWACTION))){U(this)}else if(d._isKeyCombination(t,s.A,r.CTRL)){t.preventDefault();if(i.isOfType(l.ANYCONTENTCELL|l.COLUMNROWHEADER)){c.onKeyboardShortcut("toggle",t)}}else if(d._isKeyCombination(t,s.A,r.CTRL+r.SHIFT)){if(i.isOfType(l.ANYCONTENTCELL|l.COLUMNROWHEADER)){t.preventDefault();c.onKeyboardShortcut("clear",t)}}else if(d._isKeyCombination(t,s.F4)){if(i.isOfType(l.DATACELL)){o.setActionMode(true)}}};d.prototype.onkeypress=function(t){if(t.isMarked()){return}const o=this._getKeyboardExtension();const i=e.getCellInfo(t.target);if(d._isKeyCombination(t,"+")){if(d._allowsToggleExpandedState(this,t.target)){_(this,t.target).expand()}else if(i.isOfType(l.DATACELL|l.ROWACTION)){o.setActionMode(true)}}else if(d._isKeyCombination(t,"-")){if(d._allowsToggleExpandedState(this,t.target)){_(this,t.target).collapse()}else if(i.isOfType(l.DATACELL|l.ROWACTION)){o.setActionMode(true)}}};d.prototype.oncontextmenu=function(t){if(t.isMarked("sapUiTableHandledByPointerExtension")){return}const o=e.getCellInfo(document.activeElement);if(o.isOfType(l.ANY)){e.Menu.openContextMenu(this,t)}};d.prototype.onkeyup=function(t){if(t.isMarked()){return}const o=e.getCellInfo(t.target);if(d._isKeyCombination(t,s.SHIFT)){delete this._oRangeSelection}if(o.isOfType(l.COLUMNHEADER)){if(d._isKeyCombination(t,s.SPACE)||d._isKeyCombination(t,s.ENTER)){e.Menu.openContextMenu(this,t)}}else if(d._isKeyCombination(t,s.SPACE)){w(this,t)}else if(d._isKeyCombination(t,s.SPACE,r.SHIFT)){e.toggleRowSelection(this,o.rowIndex);U(this)}else if(this._legacyMultiSelection&&!o.isOfType(l.COLUMNROWHEADER)&&(d._isKeyCombination(t,s.SPACE,r.CTRL)||d._isKeyCombination(t,s.ENTER,r.CTRL))){w(this,t)}};d.prototype.onsaptabnext=function(t){const o=this._getKeyboardExtension();const i=e.getCellInfo(t.target);if(o.isInActionMode()){v.call(this,t)}else if(i.isOfType(l.ANYCOLUMNHEADER)){if(this.getCreationRow()&&this.getCreationRow().getVisible()&&!e.hasData(this)){O(this,"sapUiTableCtrlAfter")}else if(e.isNoDataVisible(this)){this.$("noDataCnt").trigger("focus");t.preventDefault()}else if(this.getRows().length>0){b(this,t);t.preventDefault()}}else if(i.isOfType(l.ANYCONTENTCELL)){O(this,"sapUiTableCtrlAfter")}else if(t.target===this.getDomRef("overlay")){o.setSilentFocus(this.$().find(".sapUiTableOuterAfter"))}else if(!i.isOfType(l.ANY)){const o=e.getParentCell(this,t.target);if(o){t.preventDefault();o.trigger("focus")}}};function v(e){const t=K(this);e.preventDefault();if(t.top.concat(t.scrollable).at(-1)===e.target){const t=!!I(this,e,false,()=>{const e=this._getRowCounts();const t=e.fixedTop+e.scrollable-1;const o=F(this,this.getRows()[t])[0];if(o){d._focusElement(this,o)}else{const e=this._getFirstRenderedRowIndex()===this._getMaxFirstRenderedRowIndex();M(this,l.DATACELL,t,0,false,!e)}});if(t){return}}const o=t.all[t.all.indexOf(e.target)+1];if(o){d._focusElement(this,o)}else{this._getKeyboardExtension().setActionMode(false)}}d.prototype.onsaptabprevious=function(t){const o=this._getKeyboardExtension();const i=e.getCellInfo(t.target);let n;if(o.isInActionMode()){V.call(this,t)}else if(i.isOfType(l.ANYCONTENTCELL)||t.target===this.getDomRef("noDataCnt")){if(this.getColumnHeaderVisible()&&(e.getVisibleColumnCount(this)||this.getSelectionMode()!==f.None)){x(this,t);t.preventDefault()}else{O(this,"sapUiTableCtrlBefore")}}else if(t.target===this.getDomRef("overlay")){this._getKeyboardExtension().setSilentFocus(this.$().find(".sapUiTableOuterBefore"))}else if(!i.isOfType(l.ANY)){n=e.getParentCell(this,t.target);if(n){t.preventDefault();n.trigger("focus")}}};function V(e){const t=K(this);e.preventDefault();if(t.scrollable.concat(t.bottom)[0]===e.target){const t=!!E(this,e,false,()=>{const e=this._getRowCounts();const t=e.fixedTop;const o=F(this,this.getRows()[t]).at(-1);if(o){d._focusElement(this,o)}else{const e=this._getFirstRenderedRowIndex()===0;M(this,l.DATACELL,t,0,false,!e)}});if(t){return}}const o=t.all[t.all.indexOf(e.target)-1];if(o){d._focusElement(this,o)}else{this._getKeyboardExtension().setActionMode(false)}}d.prototype.onsapdown=function(e){g(e);h(this,e)};d.prototype.onsapdownmodifiers=function(t){if(t.isMarked()||d._isKeyCombination(t,null,r.CTRL+r.ALT)){u(t);return}g(t);if(d._isKeyCombination(t,null,r.CTRL)){h(this,t);return}const o=this._getKeyboardExtension();if(d._isKeyCombination(t,null,r.ALT)&&d._allowsToggleExpandedState(this,t.target)){u(t);_(this,t.target).expand();return}if(o.isInActionMode()){return}const i=e.getCellInfo(t.target);if(d._isKeyCombination(t,null,r.SHIFT)){if(i.isOfType(l.ANYCONTENTCELL)){if(!this._oRangeSelection){u(t);return}const o=e.getRowIndexOfFocusedCell(this);const i=this.getRows()[o].getIndex();const n=this._oRangeSelection.startIndex>i;let s;if(i===this._getTotalRowCount()-1){return}if(e.isLastScrollableRow(this,t.target)){if(this._oRangeSelection.pScroll){u(t);return}else{s=I(this,t);this._oRangeSelection.pScroll=s}}if(s){u(t);s.then(function(){return R(this)}.bind(this)).then(function(){N(this,o-(n?1:0),n);delete this._oRangeSelection.pScroll}.bind(this))}else{N(this,o+(n?0:1),n)}}else{u(t)}}if(d._isKeyCombination(t,null,r.ALT)){if(i.isOfType(l.DATACELL)){o.setActionMode(true)}u(t)}};d.prototype.onsapup=function(e){g(e);T(this,e)};d.prototype.onsapupmodifiers=function(t){if(t.isMarked()||d._isKeyCombination(t,null,r.CTRL+r.ALT)){u(t);return}g(t);if(d._isKeyCombination(t,null,r.CTRL)){T(this,t);return}if(d._isKeyCombination(t,null,r.ALT)&&d._allowsToggleExpandedState(this,t.target)){u(t);_(this,t.target).collapse();return}const o=this._getKeyboardExtension();if(o.isInActionMode()){return}const i=e.getCellInfo(t.target);if(d._isKeyCombination(t,null,r.SHIFT)){if(i.isOfType(l.ANYCONTENTCELL)){if(!this._oRangeSelection){u(t);return}const o=e.getRowIndexOfFocusedCell(this);const i=this.getRows()[o].getIndex();const n=this._oRangeSelection.startIndex<i;let s;if(i===0){u(t);return}if(e.isFirstScrollableRow(this,t.target)){if(this._oRangeSelection.pScroll){u(t);return}else{s=E(this,t);this._oRangeSelection.pScroll=s}}if(s){u(t);s.then(function(){return R(this)}.bind(this)).then(function(){N(this,n?1:0,n);delete this._oRangeSelection.pScroll}.bind(this))}else{N(this,o-(n?0:1),n)}}else{u(t)}}if(d._isKeyCombination(t,null,r.ALT)){if(i.isOfType(l.DATACELL)){o.setActionMode(true)}u(t)}};d.prototype.onsapleft=function(e){g(e)};d.prototype.onsapleftmodifiers=function(t){if(t.isMarked()){u(t);return}g(t);if(this._getKeyboardExtension().isInActionMode()){return}const i=e.getCellInfo(t.target);const n=o.getRTL();if(d._isKeyCombination(t,null,r.SHIFT)){if(i.isOfType(l.DATACELL)){if(!this._oRangeSelection){u(t);return}const o=e.getFocusedItemInfo(this);const i=e.hasRowHeader(this)&&o.cellInRow===1;if(i&&!e.isRowSelectorSelectionAllowed(this)){u(t)}}else if(i.isOfType(l.ROWACTION)){if(!this._oRangeSelection){u(t)}}else if(i.isOfType(l.ROWHEADER)&&n){if(!e.isRowSelectionAllowed(this)){u(t)}}else if(i.isOfType(l.COLUMNROWHEADER)&&n){u(t)}else if(i.isOfType(l.COLUMNHEADER)){let o=-e.convertCSSSizeToPixel(a);let s=0;if(n){o=o*-1}for(let t=i.columnIndex;t<i.columnIndex+i.columnSpan;t++){s+=e.Column.getColumnWidth(this,t)}const l=this.getColumns()[i.columnIndex];e.Column.resizeColumn(this,l,s+o,true,i.columnSpan);u(t)}}else if(d._isKeyCombination(t,null,r.CTRL)){if(i.isOfType(l.COLUMNHEADER)){u(t);L(this.getColumns()[i.columnIndex],n)}}else if(d._isKeyCombination(t,null,r.ALT)){u(t)}};d.prototype.onsaprightmodifiers=function(t){if(t.isMarked()){u(t);return}g(t);if(this._getKeyboardExtension().isInActionMode()){return}const i=e.getCellInfo(t.target);const n=o.getRTL();if(d._isKeyCombination(t,null,r.SHIFT)){if(i.isOfType(l.DATACELL)){if(!this._oRangeSelection){u(t)}}else if(i.isOfType(l.ROWHEADER)){if(!e.isRowSelectionAllowed(this)){u(t)}}else if(i.isOfType(l.ROWACTION)&&n){if(!this._oRangeSelection){u(t)}}else if(i.isOfType(l.COLUMNHEADER)){let o=e.convertCSSSizeToPixel(a);let s=0;if(n){o=o*-1}for(let t=i.columnIndex;t<i.columnIndex+i.columnSpan;t++){s+=e.Column.getColumnWidth(this,t)}const l=this.getColumns()[i.columnIndex];e.Column.resizeColumn(this,l,s+o,true,i.columnSpan);u(t)}else if(i.isOfType(l.COLUMNROWHEADER)){u(t)}}else if(d._isKeyCombination(t,null,r.CTRL)){if(i.isOfType(l.COLUMNHEADER)){u(t);L(this.getColumns()[i.columnIndex],!n)}}else if(d._isKeyCombination(t,null,r.ALT)){u(t)}};d.prototype.onsaphome=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(e.Grouping.isInGroupHeaderRow(t.target)){u(t);return}const o=e.getCellInfo(t.target);if(o.isOfType(l.DATACELL|l.ROWACTION|l.COLUMNHEADER|l.ROWACTIONCOLUMNHEADER)){const o=e.getFocusedItemInfo(this);const i=o.cell;const n=o.cellInRow;const s=this.getComputedFixedColumnCount();const l=e.hasRowHeader(this);const f=l?1:0;if(e.hasFixedColumns(this)&&n>s+f){u(t);e.focusItem(this,i-n+s+f,null)}else if(l&&n>1){u(t);e.focusItem(this,i-n+f,null)}}};d.prototype.onsapend=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(e.Grouping.isInGroupHeaderRow(t.target)){u(t);return}const o=e.getCellInfo(t.target);if(o.isOfType(l.ANY)){const i=e.getFocusedItemInfo(this);const n=i.cell;const s=i.columnCount;const f=this.getComputedFixedColumnCount();const r=i.cellInRow;const c=e.hasRowHeader(this);const a=c?1:0;let g=false;if(o.isOfType(l.COLUMNHEADER)&&e.hasFixedColumns(this)){const e=parseInt(o.cell.getAttribute("colspan")||1);if(e>1&&r+e-a===f){g=true}}if(c&&r===0){u(t);e.focusItem(this,n+1,null)}else if(e.hasFixedColumns(this)&&r<f-1+a&&!g){u(t);e.focusItem(this,n+f-r,null)}else if(e.hasRowActions(this)&&r<s-2){u(t);e.focusItem(this,n-r+s-2,null)}}};d.prototype.onsaphomemodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(d._isKeyCombination(t,null,r.CTRL)){const o=e.getCellInfo(t.target);if(o.isOfType(l.ANYCONTENTCELL|l.COLUMNHEADER)){u(t);const o=e.getFocusedItemInfo(this);const i=o.row;if(i>0){const n=o.cell;const s=o.columnCount;const l=e.getHeaderRowCount(this);const f=this._getRowCounts();if(i<l+f.fixedTop){e.focusItem(this,n-s*i,t)}else if(i>=l+f.fixedTop&&i<l+e.getNonEmptyRowCount(this)-f.fixedBottom){this._getScrollExtension().scrollVerticallyMax(false);if(f.fixedTop>0){e.focusItem(this,n-s*(i-l),t)}else{e.focusItem(this,n-s*i,t)}}else{this._getScrollExtension().scrollVerticallyMax(false);e.focusItem(this,n-s*(i-l-f.fixedTop),t)}}}}};d.prototype.onsapendmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(d._isKeyCombination(t,null,r.CTRL)){const o=e.getCellInfo(t.target);if(o.isOfType(l.ANY)){const o=e.getFocusedItemInfo(this);const i=o.row;const n=e.getHeaderRowCount(this);const s=e.getNonEmptyRowCount(this);const l=this._getRowCounts();u(t);if(l.fixedBottom===0||i<n+s-1||e.isNoDataVisible(this)&&i<n-1){const f=o.cell;const r=o.columnCount;if(e.isNoDataVisible(this)){e.focusItem(this,f+r*(n-i-1),t)}else if(i<n){if(l.fixedTop>0){e.focusItem(this,f+r*(n+l.fixedTop-i-1),t)}else{this._getScrollExtension().scrollVerticallyMax(true);e.focusItem(this,f+r*(n+s-l.fixedBottom-i-1),t)}}else if(i>=n&&i<n+l.fixedTop){this._getScrollExtension().scrollVerticallyMax(true);e.focusItem(this,f+r*(n+s-l.fixedBottom-i-1),t)}else if(i>=n+l.fixedTop&&i<n+s-l.fixedBottom){this._getScrollExtension().scrollVerticallyMax(true);e.focusItem(this,f+r*(n+s-i-1),t)}else{e.focusItem(this,f+r*(n+s-i-1),t)}}}}};d.prototype.onsappageup=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}const o=e.getCellInfo(t.target);if(o.isOfType(l.ANYCONTENTCELL|l.COLUMNHEADER)){const i=e.getFocusedItemInfo(this);const n=i.row;const s=e.getHeaderRowCount(this);const f=this._getRowCounts();if(f.fixedTop===0&&n>=s||f.fixedTop>0&&n>s){u(t);const r=i.cell;const c=i.columnCount;if(n<s+f.fixedTop){e.focusItem(this,r-c*(n-s),t)}else if(n===s+f.fixedTop){const i=e.getNonEmptyRowCount(this)-f.fixedTop-f.fixedBottom;const a=this.getFirstVisibleRow();E(this,t,true);if(a<i){if(f.fixedTop>0||o.isOfType(l.ROWACTION)){e.focusItem(this,r-c*(n-s),t)}else{e.focusItem(this,r-c*s,t)}}}else if(n>s+f.fixedTop&&n<s+e.getNonEmptyRowCount(this)){e.focusItem(this,r-c*(n-s-f.fixedTop),t)}else{e.focusItem(this,r-c*(n-s-e.getNonEmptyRowCount(this)+1),t)}}if(o.isOfType(l.ROWACTION)&&n===s&&f.fixedTop>0){u(t)}}};d.prototype.onsappagedown=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}const o=e.getCellInfo(t.target);if(o.isOfType(l.ANY)){const i=e.getFocusedItemInfo(this);const n=i.row;const s=e.getHeaderRowCount(this);const f=e.getNonEmptyRowCount(this);const r=this._getRowCounts();u(t);if(e.isNoDataVisible(this)&&n<s-1||r.fixedBottom===0||n<s+f-1){const c=i.cell;const a=i.columnCount;if(n<s-1&&!o.isOfType(l.COLUMNROWHEADER)){e.focusItem(this,c+a*(s-n-1),t)}else if(n<s){if(!e.isNoDataVisible(this)){e.focusItem(this,c+a*(s-n),t)}}else if(n>=s&&n<s+f-r.fixedBottom-1){e.focusItem(this,c+a*(s+f-r.fixedBottom-n-1),t)}else if(n===s+f-r.fixedBottom-1){const o=e.getNonEmptyRowCount(this)-r.fixedTop-r.fixedBottom;const i=this._getTotalRowCount()-r.fixedBottom-this.getFirstVisibleRow()-o*2;I(this,t,true);if(i<o&&r.fixedBottom>0){e.focusItem(this,c+a*(s+f-n-1),t)}}else{e.focusItem(this,c+a*(s+f-n-1),t)}}}};d.prototype.onsappageupmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(d._isKeyCombination(t,null,r.ALT)){const o=e.getCellInfo(t.target);const i=e.getFocusedItemInfo(this);if(o.isOfType(l.DATACELL|l.COLUMNHEADER)){const o=i.cell;const n=i.cellInRow;const s=e.hasRowHeader(this);const l=s?1:0;const f=c;u(t);if(s&&(e.Grouping.isInGroupHeaderRow(t.target)||n===1)){e.focusItem(this,o-n,null)}else if(n-l<f){e.focusItem(this,o-n+l,null)}else{e.focusItem(this,o-f,null)}}else if(o.isOfType(l.ROWACTION)){e.focusItem(this,i.cell-1,null)}}};d.prototype.onsappagedownmodifiers=function(t){g(t);if(this._getKeyboardExtension().isInActionMode()){return}if(d._isKeyCombination(t,null,r.ALT)){const o=e.getCellInfo(t.target);if(o.isOfType(l.DATACELL|l.ROWHEADER|l.ANYCOLUMNHEADER)){const i=e.getFocusedItemInfo(this);const n=i.cellInRow;const s=e.hasRowHeader(this);const f=s?1:0;const r=e.getVisibleColumnCount(this);const a=parseInt(o.cell.getAttribute("colspan")||1);u(t);if(n+a-f<r){const o=i.cell;const l=c;if(s&&n===0){e.focusItem(this,o+1,null)}else if(a>l){e.focusItem(this,o+a,null)}else if(n+a-f+l>r){e.focusItem(this,o+r-n-1+f,null)}else if(!e.Grouping.isInGroupHeaderRow(t.target)){e.focusItem(this,o+l,null)}}else if(o.isOfType(l.DATACELL)&&e.hasRowActions(this)&&n===i.columnCount-2){e.focusItem(this,i.cell+1,null)}}}};d.prototype.onsapenter=function(e){w(this,e)};return d});
//# sourceMappingURL=KeyboardDelegate.js.map