/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/changeHandler/Base","sap/base/util/LoaderExtensions","sap/ui/fl/changeHandler/common/revertAddedControls"],function(t,e,n){"use strict";const a={};a.applyChange=async function(n,o,r,i){const s=r.modifier;const g=i.aggregationName;const c=n.getFlexObjectMetadata().moduleName;const f=await s.findAggregation(o,g);if(!f){throw Error(`The given Aggregation is not available in the given control: ${s.getId(o)}`)}const d=await e.loadResource(c,{dataType:"text"});const h=await t.instantiateFragment(n,r);let l=0;for(const t of h){const e=await s.validateType(t,f,o,d,l);l++;if(!e){a._destroyArrayOfControls(h);throw Error(`The content of the xml fragment does not match the type of the targetAggregation: ${f.type}`)}}const m=[];let u=0;for(const t of h){await s.insertAggregation(o,g,t,i.index+u,r.view,i.skipAdjustIndex);u++;m.push({id:s.getId(t),aggregationName:g})}n.setRevertData(m);return h};a.revertChange=n;a._throwMissingAttributeError=function(t){throw new Error(`Attribute missing from the change specific content '${t}'`)};a._destroyArrayOfControls=function(t){t.forEach(function(t){if(t.destroy){t.destroy()}})};a.completeChangeContent=function(t,e,n){n||={};const o=e.content||e;if(!o.fragmentPath){a._throwMissingAttributeError("fragmentPath")}n.fragmentPath??=o.fragmentPath;t.setContent(n);let r=t.getFlexObjectMetadata().reference.replace(/\.Component/g,"").replace(/\./g,"/");r+="/changes/";r+=n.fragmentPath;const i=t.getFlexObjectMetadata();i.moduleName=r;t.setFlexObjectMetadata(i)};return a});
//# sourceMappingURL=BaseAddXml.js.map