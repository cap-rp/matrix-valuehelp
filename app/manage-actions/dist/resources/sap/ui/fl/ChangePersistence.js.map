{"version":3,"file":"ChangePersistence.js","names":["sap","ui","define","Log","CompVariant","States","DependencyHandler","FlexObjectState","FlexState","Version","Settings","Condenser","FlexObjectManager","Storage","Layer","LayerUtils","ChangePersistence","mComponent","this","_mComponent","name","error","Error","_oMessagebundle","undefined","prototype","_deleteNotSavedChanges","aChanges","aCondensedChanges","bAlreadyDeletedViaCondense","filter","oChange","some","oCondensedChange","getId","forEach","removeChange","updateStorageResponse","flexObject","convertToFileContent","type","deleteFlexObjects","reference","flexObjects","bind","checkIfOnlyOne","sFunctionName","aProperties","map","aUniqueProperties","sValue","iIndex","indexOf","length","canGivenChangesBeCondensed","oAppComponent","bCondenseAnyLayer","bCondenserEnabled","sLayer","getLayer","CUSTOMER","PUBLIC","USER","includes","oUriParameters","URLSearchParams","window","location","search","has","get","isBackendCondensingEnabled","getInstanceOrUndef","isCondensingEnabled","updateCacheAndDeleteUnsavedChanges","aAllChanges","bSkipUpdateCache","_massUpdateCacheAndDirtyState","getAllRelevantChangesForCondensing","aDirtyChanges","aDraftFilenames","sReference","aRelevantChanges","getFlexObjectsDataSelector","getFlexObjectMetadata","getState","LifecycleState","PERSISTED","compareAgainstCurrentLayer","concat","checkLayerAndSingleTransportRequest","aRequests","getRequests","bCheckLayer","hasPersoConnector","aLayers","getLayers","executeWriteAndRemoveCalls","sCurrentLayer","sRequest","sParentVersion","pRemoveCallsPromise","Promise","resolve","aDeletedChanges","DELETED","aNewChanges","saveSequenceOfDirtyChanges","then","write","layer","prepareDirtyChanges","transport","isLegacyVariant","parentVersion","oResponse","call","saveDirtyChanges","getDirtyFlexObjects","aRelevantChangesForCondensing","bIsCondensingEnabled","aAllFlexObjects","aChangesClone","slice","oCondensedChangesPromise","condense","allChanges","condensedChanges","async","oFirstNewChange","NEW","shift","oCollectedResponse","response","oDirtyChange","performSingleSaveAction","_updateCacheAndDirtyState","push","checkUpdate","oFirstChange","Number","Draft","getRequest","remove","UPDATED","setState","removeDirtyFlexObjects","_deleteChangeInMap","bRunTimeCreatedChange","sChangeKey","removeChangeFromMap","getLiveDependencyMap","removeChangeFromDependencies"],"sources":["ChangePersistence-dbg.js"],"mappings":"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","ignoreList":[]}