/*
 * ! OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Lib","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/getVariantAuthor","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Layer"],function(e,a,n,t,r,i,s){"use strict";const c={};c.variants=function(i){i.flexObjects.forEach(e=>{if(e.getFileType()==="ctrl_variant"){e.setAuthor(t(e.getSupportInformation().user,e.getLayer(),i.storageResponse.authors))}});const c=(i.storageResponse.changes.variants||[]).map(function(e){return e.fileName}).concat(i.externalData.filter(function(e){return e.getFileType()==="ctrl_variant"}).map(function(e){return e.getId()}));var l={runtimeOnlyData:{flexObjects:[]}};var f=i.storageResponse.changes.variants;var p=i.storageResponse.changes.variantDependentControlChanges.filter(function(e){var a=e.isChangeOnStandardVariant;if(a!==undefined&&a!==null){return a}return!/id_\d{13}_\d*_flVariant/.test(e.variantReference)});var u=f.concat(p);u.forEach(function(t){var i=t.fileType==="ctrl_variant"?t.variantManagementReference:t.variantReference;if(i&&!c.includes(i)){var f=e.getResourceBundleFor("sap.ui.fl");var p=n.createFlVariant({id:i,variantManagementReference:i,variantName:f.getText("STANDARD_VARIANT_TITLE"),layer:s.BASE,user:a.DEFAULT_AUTHOR,reference:t.reference});p.setState(r.LifecycleState.PERSISTED);l.runtimeOnlyData.flexObjects.push(p);c.push(i)}});return l};c.uiChanges=function(e){const a=i.createEmptyDependencyMap();e.flexObjects.forEach(n=>{if(n.isA("sap.ui.fl.apply._internal.flexObjects.UIChange")&&!n.getVariantReference()){i.addChangeAndUpdateDependencies(n,e.componentId,a)}});return{runtimeOnlyData:{liveDependencyMap:a}}};return c});
//# sourceMappingURL=InitialPrepareFunctions.js.map