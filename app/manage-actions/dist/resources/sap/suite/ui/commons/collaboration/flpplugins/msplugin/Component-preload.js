sap.ui.require.preload({"sap/suite/ui/commons/collaboration/flpplugins/msplugin/Component.js":function(){sap.ui.define(["sap/ui/core/Component","sap/base/Log","../../ServiceContainer"],function(e,t,a){var o=t.getLogger("sap.suite.ui.commons.collaboration.flpplugins.msplugin.Component");return e.extend("sap.suite.ui.commons.collaboration.flpplugins.msplugin.Component",{metadata:{manifest:"json",properties:{isShareAsLinkEnabled:{name:"isShareAsLinkEnabled",type:"string"},isShareAsTabEnabled:{name:"isShareAsTabEnabled",type:"string"},isShareAsCardEnabled:{name:"isShareAsCardEnabled",type:"string"},applicationId:{name:"applicationId",type:"string"},tenantId:{name:"tenantId",type:"string"},isDirectCommunicationEnabled:{name:"isDirectCommunicationEnabled",type:"string"}}},init:function(){var e=this._loadPluginConfigData();e?a.setCollaborationType("COLLABORATION_MSTEAMS",e):o.error("Collaboration configuration for Microsoft Teams Integration could not be loaded.")},_loadPluginConfigData:function(){var e=this.getComponentData();if(e)return e.config}})})},"sap/suite/ui/commons/collaboration/BaseHelperService.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){e=e.extend("sap.suite.ui.commons.collaboration.BaseHelperService",{constructor:function(e){this._providerConfig=e}});return e.prototype.getProviderConfig=function(){return this._providerConfig},e.prototype.getOptions=function(e){return[]},e.prototype.share=function(e,t){},e.prototype.isContactsCollaborationSupported=function(){return!1},e.prototype.enableContactsCollaboration=async function(e,t){return Promise.resolve({})},e.prototype.getTeamsContactCollabOptions=async function(){return Promise.resolve({})},e.prototype.isFeatureFlagEnabled=function(){return!1},e})},"sap/suite/ui/commons/collaboration/CollaborationCardHelper.js":function(){sap.ui.define(["sap/ui/base/Object","sap/base/Log"],function(e,t){var a=t.getLogger("sap.suite.ui.commons.collaboration.CollaborationCardHelper"),t=e.extend("sap.suite.ui.commons.collaboration.CollaborationCardHelper");return t.fetchCSRFToken=function(){return fetch("/sap/opu/odata4/sap/aps_ui_card_srv/srvd_a2x/sap/aps_ui_card/0001/",{method:"HEAD",headers:{"X-CSRF-Token":"Fetch"}}).then(function(e){var t=e.headers.get("X-CSRF-Token");if(e.ok&&t)return t})},t.postCard=function(e,t){return this.fetchCSRFToken().then(function(o){let n=JSON.stringify(t);try{n=btoa(JSON.stringify(t))}catch(o){a.error("Error while encoding the card content to base64 so original content passed to API: "+o)}var i=JSON.stringify({content:n,card_id:e});return fetch("/sap/opu/odata4/sap/aps_ui_card_srv/srvd_a2x/sap/aps_ui_card/0001/Card",{method:"POST",headers:{"X-CSRF-Token":o,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"},body:i}).then(function(e){return e.json()})})},t})},"sap/suite/ui/commons/collaboration/CollaborationContactInfoHelper.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){var t="GET",e=e.extend("sap.suite.ui.commons.collaboration.CollaborationContactInfoHelper");return e.fetchCSRFToken=function(){return fetch("/sap/opu/odata4/sap/aps_ui_contact_srv/srvd_a2x/sap/aps_ui_contact/0001/",{method:"HEAD",headers:{"X-CSRF-Token":"Fetch"}}).then(function(e){var t=e.headers.get("X-CSRF-Token");if(e.ok&&t)return t})},e.fetchContact=function(e){return this.fetchCSRFToken().then(function(a){return fetch("/sap/opu/odata4/sap/aps_ui_contact_srv/srvd_a2x/sap/aps_ui_contact/0001/APS_UI_C_CONTACT/"+e,{method:t,headers:{"X-CSRF-Token":a,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})},e.fetchContactPicture=function(e){return this.fetchCSRFToken().then(function(a){return fetch("/sap/opu/odata4/sap/aps_ui_contact_srv/srvd_a2x/sap/aps_ui_contact/0001/APS_UI_C_CONTACT/"+e+"/photo",{method:t,headers:{"X-CSRF-Token":a}}).then(function(e){return e.blob()})})},e.fetchContactStatus=function(e){return this.fetchCSRFToken().then(function(a){return fetch("/sap/opu/odata4/sap/aps_ui_contact_srv/srvd_a2x/sap/aps_ui_contact/0001/APS_UI_C_PRESENCE?$filter=id eq '"+e+"'",{method:t,headers:{"X-CSRF-Token":a,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})},e.fetchServiceStatus=function(){return this.fetchCSRFToken().then(function(e){return fetch("/sap/opu/odata4/sap/aps_ui_contact_srv/srvd_a2x/sap/aps_ui_contact/0001/APS_UI_C_CHECK_SERVICE",{method:t,headers:{"X-CSRF-Token":e,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})},e})},"sap/suite/ui/commons/collaboration/CollaborationHelper.js":function(){sap.ui.define(["sap/base/Log","sap/ui/base/Object","sap/ui/core/Element"],function(e,t,a){var o="sap-url-hash",n="&sap-ui-cardTitle",i="&sap-stageview-hash",r="&sap-ui-cardId",s="&sap-ui-xx-cardId",l="transient",c=e.getLogger("sap.suite.ui.commons.collaboration.CollaborationHelper"),e=t.extend("sap.suite.ui.commons.collaboration.CollaborationHelper");return e.compactHash=function(e){var t=sap.ui.require("sap/ushell/Container");return t?t&&t.getServiceAsync("AppState").then(async function(t){var a=t.createEmptyAppState(void 0,!1),n=this._getNextKey(a);if(!this._isEligibleForBackendPersistency(t))return c.warning("Transient flag is true. URL will not be shortened"),{url:e};var i=this._extractURLBeforeHash(e),r=await this._extractSemanticObjectAndAction(e),t=!1;try{t=await this._isMinificationFeasible(e)}catch(t){}return r&&t?this._storeUrl(e,a).then(function(){return{url:i+"#"+r+"&/"+o+"="+n}}).catch(function(t){return c.warning("URL is not shortened due to an error."+t.toString()),{url:e}}):{url:e}}.bind(this)):{url:e}},e._getCurrentUrl=function(){let e=sap.ui.require("sap/ushell/Container");return e?new Promise(function(t){e.getFLPUrlAsync(!0).then(function(e){t(e)})}):Promise.resolve(document.URL)},e.processAndExpandHash=function(){return this._hideAvatarFromShellbar(),this._getCurrentUrl().then(function(e){var t;return-1<e.indexOf(o)?(t=e.split(o)[1].split("=")[1],0<e.indexOf(i)?t=t.split(i)[0]:0<e.indexOf(r)||0<e.indexOf(s)?t=(0<e.indexOf(r)?t.split(r):t.split(s))[0]:0<e.indexOf(n)&&(t=t.split(n)[0]),this._retrieveURL(t).then(function(t){return t.getData()?window.location.replace(t.getData()):(t=e.split(o)[0],window.location.replace(t)),Promise.resolve()})):(-1<e.indexOf(r)?(t=e.split(r)[0],window.location.replace(t)):-1<e.indexOf(n)&&(t=e.split(n)[0],window.location.replace(t)),Promise.resolve())}.bind(this))},e._hideAvatarFromShellbar=function(){this.isTeamsModeActive().then(function(e){e&&(e=a.getElementById("userActionsMenuHeaderButton"))&&e.setVisible(!1)})},e.isTeamsModeActive=function(){var e=!1,t=sap.ui.require("sap/ushell/Container");return t?t.getServiceAsync("URLParsing").then(function(t){return this._getCurrentUrl().then(function(a){var o,a=a.split("#")[0];return-1!==a.indexOf("?")?((a=t&&t.parseParameters(a.substring(a.indexOf("?"))))&&a["sap-collaboration-teams"]&&a["sap-collaboration-teams"][0]&&"true"===a["sap-collaboration-teams"][0]&&(e=!0),o=!1,a&&a["sap-ushell-config"]&&a["sap-ushell-config"][0]&&"lean"===a["sap-ushell-config"][0]&&(o=!0),Promise.resolve(e&&o)):Promise.resolve(!1)})}.bind(this)):Promise.resolve(!1)},e._retrieveURL=function(e){var t=sap.ui.require("sap/ushell/Container");return t&&t.getServiceAsync("AppState").then(function(t){return t.getAppState(e)})},e._isEligibleForBackendPersistency=function(e){return e&&e._oConfig&&l in e._oConfig&&!e._oConfig[l]},e._getNextKey=function(e){return e.getKey()},e._extractSemanticObjectAndAction=function(e){var t=sap.ui.require("sap/ushell/Container");return t&&t.getServiceAsync("URLParsing").then(function(t){t=t.parseShellHash(this._extractURLHash(e));if(t)return Promise.resolve(t.contextRaw?t.semanticObject+"-"+t.action+"~"+t.contextRaw:t.semanticObject+"-"+t.action)}.bind(this))},e._isMinificationFeasible=async function(e){var t,a=sap.ui.require("sap/ushell/Container");return a?(t=await a.getServiceAsync("NavTargetResolution"),a=(await a.getServiceAsync("URLParsing")).parseShellHash(this._extractURLHash(e)),0<Object.keys(a.params).length?t.resolveHashFragment(`#${a.semanticObject}-`+a.action).then(function(e){return!0}).catch(function(e){return!1}):Promise.resolve(!0)):Promise.resolve(!1)},e._extractURLBeforeHash=function(e){return e.split("#")[0]},e._extractURLHash=function(e){return e.substring(e.indexOf("#"))},e._storeUrl=function(e,t){return t.setData(e),t.save()},e})},"sap/suite/ui/commons/collaboration/CollaborationManagerService.js":function(){sap.ui.define(["sap/base/Log","sap/ui/core/Core","./BaseHelperService","sap/ui/Device","sap/ui/core/Lib","sap/suite/ui/commons/collaboration/channels/MessageChannel"],function(e,t,a,o,n,i){var a=a.extend("sap.suite.ui.commons.collaboration.CollaborationManagerService"),r=n.getResourceBundleFor("sap.suite.ui.commons"),s=e.getLogger("sap.suite.ui.commons.collaboration.CollaborationManagerService");return a.prototype.triggerH2HChat=function(e,t,a){this.publishData({sAppTitle:e,sCurrentURL:t,sEmailId:a})},a.prototype.getOptions=function(){var e=window["sap-ushell-config"]&&window["sap-ushell-config"].bootstrapPlugins&&window["sap-ushell-config"].bootstrapPlugins.H2H_CHAT_PLUGIN;if(o.system.desktop){if(e)return{text:r.getText("COLLABORATION_MANGER"),icon:"sap-icon://BusinessSuiteInAppSymbols/icon-collaboration-manager",press:this.triggerH2HChat.bind(this),fesrStepName:"CM:ShareLink"};s.info("Consumer disable Collaboration Manager option")}else s.info("Collaboration Manager is not supported in Phone and Tablet");return null},a.prototype.publishData=async function(e){try{(await i.getInstance()).postMessage(e)}catch(e){s.error("Failed to publish data:",e)}},a})},"sap/suite/ui/commons/collaboration/ContactHelper.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/m/library","sap/ui/core/Lib","sap/ui/core/Core","sap/ui/model/resource/ResourceModel","./CollaborationContactInfoHelper","sap/ui/performance/trace/FESRHelper","sap/ui/core/Element"],function(e,t,a,o,n,i,r,s,l,c){var p=n.getResourceBundleFor("sap.suite.ui.commons");return e.extend("sap.suite.ui.commons.collaboration.ContactHelper",{constructor:function(){},getFullProfileByEmail:async function(e){e=await s.fetchContact(e);return e&&""===e.mail||(e&&""!=e.data&&(e.photo="data:image/png;base64,"+e.data),e=this.determineContactStatus(e)),e},getTeamsContactOptions:function(){var e=this;return Promise.resolve([{key:"chat",icon:"sap-icon://discussion",tooltip:p.getText("CHAT_BUTTON_TOOLTIP"),fesrStepName:"MST:ContactAction",callBackHandler:function(t){e.handleMSTeamsPress(t)}},{key:"call",icon:"sap-icon://call",tooltip:p.getText("CALL_BUTTON_TOOLTIP"),fesrStepName:"MST:ContactAction",callBackHandler:function(t){e.handleMSTeamsPress(t)}},{key:"videoCall",icon:"sap-icon://video",tooltip:p.getText("VIDEOCALL_BUTTON_TOOLTIP"),fesrStepName:"MST:ContactAction",callBackHandler:function(t){e.handleMSTeamsPress(t)}}])},getTeamsContactStatus:async function(e){e=await s.fetchContact(e);return[{key:"profileStatus",badgeIcon:(e=this.determineContactStatus(e)).badgeIcon,badgeValueState:e.badgeValueState,badgeTooltip:e.badgeTooltip,fesrStepName:"MST:ContactAction"}]},handleMSTeamsPress:function(e){var t=e.getSource().data("email"),a="";switch(e.getSource().data("type")){case"chat":a="https://teams.microsoft.com/l/chat/0/0?users="+t;break;case"call":a="https://teams.microsoft.com/l/call/0/0?users="+t;break;case"videoCall":a="https://teams.microsoft.com/l/call/0/0?users="+t+"&withVideo=true"}o.URLHelper.redirect(a,!0)},formatUri:function(e,t){return/^\w+[\w-+\.]*\@\w+([-\.]\w+)*\.[a-zA-Z]{2,}$/.test(e)?"mailto:"+e+(t&&t.subject?"?subject="+t.subject:"")+(t&&t.body?"&body="+t.body:""):"tel:"+e},loadContactPopover:function(e,o,n){return this.afterClose(),t.load({name:"sap.suite.ui.commons.collaboration.ContactPopover",controller:this,type:"XML"}).then(function(t){l.setSemanticStepname(t,"afterClose","MST:ContactDetails"),this._oContactPopover=t,this.sEmail=e,this.oParams=o,t.setBusy(!0);var i={setFamily:"tnt",setURI:sap.ui.require.toUrl("sap/tnt/themes/base/illustrations")},i=(sap.m.IllustrationPool.registerIllustrationSet(i,!1),new a({isUserExistsInTeams:!0}));return this._oContactPopover.setModel(i,"userData"),this.isDirectCommunicationEnabled=n,this._oContactPopover.setModel(new sap.ui.model.resource.ResourceModel({bundle:p}),"i18n"),t}.bind(this))},loadMinimalContactPopover:function(e,o){this.afterClose();var n=new a({mail:e,params:o});return t.load({name:"sap.suite.ui.commons.collaboration.MinimalContactPopover",controller:this,type:"XML"}).then(function(e){return this._oMinContactPopover=e,l.setSemanticStepname(e,"afterClose","MST:ContactDetails"),e.setModel(n,"userData"),e.setModel(new sap.ui.model.resource.ResourceModel({bundle:p}),"i18n"),e}.bind(this))},afterClose:function(){this._oContactPopover&&this._oContactPopover.destroy(),this._oMinContactPopover&&this._oMinContactPopover.destroy()},afterOpen:function(){var e=this;this.getFullProfileByEmail(this.sEmail).then(function(t){e._oContactPopover.setBusy(!1),t&&""===t.mail?(t.isUserExistsInTeams=!1,t.mail=e.sEmail,t.params=e.oParams,e._oContactPopover.setInitialFocus(c.getElementById("mail"))):(t.isUserExistsInTeams=!0,t.isDirectCommunicationEnabled=!!e.isDirectCommunicationEnabled,e._oContactPopover.setInitialFocus(c.getElementById("avatar")));var o=new a(t);o.setData(t),e._oContactPopover.setModel(o,"userData"),l.setSemanticStepname(e._oContactPopover,"afterClose","MST:ContactDetails")})},afterContinue:function(){var e=this.formatUri(this.sEmail,this.oParams);o.URLHelper.redirect(e,!0)},determineContactStatus:function(e){var t=new Map([["OOO",{badgeValueState:"Information",badgeIcon:"sap-icon://offsite-work"}],["BUSYOOO",{badgeValueState:"Error",badgeIcon:"sap-icon://circle-task"}],["ONLINEOOO",{badgeValueState:"Success",badgeIcon:"sap-icon://sys-enter"}],["AVAILABLE",{badgeValueState:"Success",badgeIcon:"sap-icon://sys-enter-2"}],["AWAY",{badgeValueState:"Warning",badgeIcon:"sap-icon://pending"}],["BUSY",{badgeValueState:"Error",badgeIcon:"sap-icon://circle-task-2"}],["PRESENTING",{badgeValueState:"Error",badgeIcon:"sap-icon://sys-minus"}],["OFFLINE",{badgeValueState:"Error",badgeIcon:"sap-icon://message-error"}]]),a=new Map([["Available","AVAILABLE"],["Away","AWAY"],["Inactive","AWAY"],["Busy","BUSY"],["DoNotDisturb","PRESENTING"],["InACall","BUSY"],["InAMeeting","BUSY"],["Presenting","PRESENTING"],["BeRightBack","AWAY"],["OffWork","OFFLINE"]]);let o={};return e.isoutofoffice?"Available"===e.activity?(o=t.get("ONLINEOOO")).badgeTooltip=p.getText("AVAILABLE")+", "+p.getText("OOO"):"Busy"===e.activity?(o=t.get("BUSYOOO")).badgeTooltip=p.getText("BUSY")+", "+p.getText("OOO"):"DoNotDisturb"===e.activity?(o=t.get("PRESENTING")).badgeTooltip=p.getText("DONOTDISTURB")+", "+p.getText("OOO"):(o=t.get("OOO")).badgeTooltip=p.getText("OOO"):(a=e.activity?a.get(e.activity):"OFFLINE",(o=t.get(a)).badgeTooltip=p.getText(e.activity.toUpperCase())),Object.assign(e,o),e}})})},"sap/suite/ui/commons/collaboration/ServiceContainer.js":function(){sap.ui.define(["sap/base/Log","./BaseHelperService","./TeamsHelperService","./CollaborationManagerService","../windowmessages/CollaborationMessageBroker","../windowmessages/CollaborationMessageConsumer"],function(e,t,a,o,n,i){var r,s,l=e.getLogger("sap.suite.ui.commons.collaboration.ServiceContainer");function c(){var e,o,n;return r?(o=r.sProvider,n=r.oProviderConfig,"COLLABORATION_MSTEAMS"===o&&(e=new a(n)),s=Promise.resolve(e)):(e=new t({}),l.info("Collaboration provider is not activated on the tenant"),Promise.resolve(e))}var p=new function(){};return p.getServiceAsync=async function(){var e=sap.ui.require("sap/ushell/Container");return s||(e&&e.inAppRuntime()&&(r=await i.getProviderConfiguration()),c())},p.getCollaborationServices=async function(){var e={oTeamsHelperService:await p.getServiceAsync(),oCMHelperService:new o};return Promise.resolve(e)},p.setCollaborationType=function(e,t){l.info("Collaboration properties are now configured"),r={sProvider:e,oProviderConfig:t},c(),n.startInstance(r)},p},!0)},"sap/suite/ui/commons/collaboration/TeamsHelperService.js":function(){sap.ui.define(["sap/base/Log","sap/ui/core/Core","sap/base/security/URLListValidator","./CollaborationHelper","./BaseHelperService","sap/ui/core/Element","./ContactHelper","sap/ui/Device","./CollaborationCardHelper","sap/ui/core/Fragment","sap/m/MessageBox","sap/ui/core/Lib","sap/m/Popover","sap/m/HBox","sap/m/VBox","sap/m/MessageStrip","sap/m/Button","./CollaborationContactInfoHelper","sap/m/library","sap/m/FlexBox","sap/base/i18n/Localization","./CollaborationManagerService","sap/m/FlexItemData"],function(e,t,a,o,n,i,r,s,l,c,p,u,d,h,m,C,f,g,b,S,T,A,v){var _,n=n.extend("sap.suite.ui.commons.collaboration.TeamsHelperService",{constructor:function(e){this._providerConfig=e,this._providerConfig.shareAsLinkUrl="https://teams.microsoft.com/share",this._getShareAsTabUrl().then(function(e){this._providerConfig.shareAsTabUrl=e}.bind(this))}}),O="db5b69c6-0430-4ae1-8d6e-a65c2220b50c",y=e.getLogger("sap.suite.ui.commons.collaboration.TeamsHelperService"),E=u.getResourceBundleFor("sap.suite.ui.commons");let L;var I={},P="width=720,height=720";return n.prototype.getOptions=function(e){I={isShareAsLinkEnabled:!e||void 0===e.isShareAsLinkEnabled||e.isShareAsLinkEnabled,isShareAsTabEnabled:!e||void 0===e.isShareAsTabEnabled||e.isShareAsTabEnabled,isShareAsCardEnabled:!(!e||void 0===e.isShareAsCardEnabled)&&e.isShareAsCardEnabled};var t=[],e=[];if(s.system.desktop?I.isShareAsLinkEnabled?"X"===this._providerConfig.isShareAsLinkEnabled?t.push({text:E.getText("COLLABORATION_MSTEAMS_CHAT"),key:"COLLABORATION_MSTEAMS_CHAT",icon:"sap-icon://post",fesrStepName:"MST:ShareAsLink"}):y.info("Share as Chat option is not enabled in the tenant"):y.info("Consumer disable Share as Chat option"):y.info("Share as Chat option is not supported in Phone and Tablet"),s.system.desktop?I.isShareAsTabEnabled?"X"===this._providerConfig.isShareAsTabEnabled?t.push({text:E.getText("COLLABORATION_MSTEAMS_TAB"),key:"COLLABORATION_MSTEAMS_TAB",icon:"sap-icon://image-viewer",fesrStepName:"MST:ShareAsTab"}):y.info("Share as Tab option is not enabled in the tenant"):y.info("Consumer disable Share as Tab option"):y.info("Share as Tab option is not supported in Phone and Tablet"),s.system.desktop)if(I.isShareAsCardEnabled){var a=this._providerConfig.isShareAsCardEnabled,o="X"===this._providerConfig.isShareAsTabEnabled,n={text:E.getText("COLLABORATION_MSTEAMS_CARD"),key:"COLLABORATION_MSTEAMS_CARD",icon:"sap-icon://ui-notifications",fesrStepName:"MST:ShareAsCard"};switch(a){case"DISABLED":y.info("Share as Card option is not enabled in the tenant");break;case"ENABLED":case"AUTHENABLE":t.push(n);break;case"":case void 0:o?t.push(n):y.info("Share as Card option is not enabled in the tenant");break;default:y.info("Share as Card option is not enabled in the tenant")}}else y.info("Consumer disable Share as Card option");else y.info("Share as Card option is not supported in Phone and Tablet");return 1===t.length?"COLLABORATION_MSTEAMS_CHAT"===(e=t)[0].key?e[0].text=E.getText("COLLABORATION_MSTEAMS_CHAT_SINGLE"):"COLLABORATION_MSTEAMS_TAB"===e[0].key?e[0].text=E.getText("COLLABORATION_MSTEAMS_TAB_SINGLE"):"COLLABORATION_MSTEAMS_CARD"===e[0].key&&(e[0].text=E.getText("COLLABORATION_MSTEAMS_CARD_SINGLE")):1<t.length&&e.push({type:"microsoft",text:E.getText("COLLABORATION_MSTEAMS_SHARE"),icon:"sap-icon://collaborate",subOptions:t}),e},n.prototype.share=function(e,t){t.url?a.validate(t.url)?"COLLABORATION_MSTEAMS_CHAT"===e.key?this._shareAsChat(t):"COLLABORATION_MSTEAMS_TAB"===e.key?this._shareAsTab(t):"COLLABORATION_MSTEAMS_CARD"===e.key&&this._shareAsCard(t):y.error("Invalid URL supplied"):y.error("url is not supplied in object so terminating Click")},n.prototype._shareAsChat=function(e){var t=window.open("","_blank",P),a=e.appTitle;0<e.subTitle.length&&(a+=": "+e.subTitle),t.opener=null,e.minifyUrlForChat?o.compactHash(e.url,[]).then(async function(o){o=await this._modifyUrlForNavigationContext(e.url,o.url);t.location=this._providerConfig.shareAsLinkUrl+"?msgText="+encodeURIComponent(a)+"&preview=false&href="+encodeURIComponent(o)}.bind(this)):t.location=this._providerConfig.shareAsLinkUrl+"?msgText="+encodeURIComponent(a)+"&preview=false&href="+encodeURIComponent(e.url)},n.prototype._modifyUrlForShareAsTab=async function(e){var t,a,o,n=e.indexOf("#");return-1!==n&&(o="sap-ushell-config=lean&sap-collaboration-teams=true",-1!==(a=(t=e.substring(0,n)).indexOf("?",0))?t=t.substring(0,a+1)+o+"&"+t.substring(a+1):t+="?"+o,e=t+e.substring(n),e=await this._addNavmodeInUrl(e,"explace")),e},n.prototype._shareAsTab=async function(e){var t=await this._modifyUrlForShareAsTab(e.url),a={subEntityId:{url:t,appTitle:e.appTitle,subTitle:e.subTitle,mode:"tab"}};e.minifyUrlForChat?o.compactHash(t,[]).then(async function(e){e=await this._modifyUrlForNavigationContext(t,e.url),a.subEntityId.url=await this._addNavmodeInUrl(e,"explace"),e=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(a));sap.m.URLHelper.redirect(e,!0)}.bind(this)):(e=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(a)),sap.m.URLHelper.redirect(e,!0))},n.prototype._addNavmodeInUrl=function(e,t){var a=sap.ui.require("sap/ushell/Container");return a&&a.getServiceAsync("URLParsing").then(function(a){var o=(i=e).indexOf("#"),n=a.parseShellHash(i.substring(o)),a=(n.params["sap-ushell-navmode"]=t,n.params["sap-ushell-next-navmode"]=t,a.constructShellHash(n)),i=i.substring(0,o)+"#"+a;return Promise.resolve(i)})},n.prototype._modifyUrlForNavigationContext=function(e,t){var a;return e===t?Promise.resolve(t):(a=sap.ui.require("sap/ushell/Container"))&&a.getServiceAsync("URLParsing").then(function(a){var o=e,n=o.indexOf("#"),a=a.parseShellHash(o.substring(n)),o=Object.keys(a.params).length,n=new URL(t);return 0<o&&(n.searchParams.has("sap-collaboration-teams")?n.searchParams.delete("sap-collaboration-teams"):n.searchParams.set("sap-collaboration-teams","true")),Promise.resolve(n.toString())})},n.prototype._shareAsCard=function(e){e.cardId&&0<e.cardId.length&&e.cardManifest&&this.isFeatureFlagEnabled()?(e.cardManifest.rtl=T.getRTL(),c.load({name:"sap.suite.ui.commons.collaboration.CollaborationBusyDialog",controller:this,type:"XML"}).then(function(t){(_=t).open(),L=setTimeout(function(){_.close(),_.destroy()},6e4),l.postCard(e.cardId,e.cardManifest).then(function(t){var a=!0,o={cardId:t.card_id,version:t.version};if(t.error)if("APS_UI_MSG/001"===t.error.code){if(a=!0,o.cardId=e.cardId,0<t.error.message.length)try{var n=JSON.parse(atob(t.error.message)).version;o.version=n}catch(t){a=!1}}else a=!1;a?this._updateUrl(e,o):(p.error(E.getText("SAVE_CARD_ERROR")),this._closeBusyDailog())}.bind(this))}.bind(this))):this._updateUrl(e,{})},n.prototype._updateUrl=async function(e,t){var a,n;e.minifyUrlForChat?o.compactHash(e.url,[]).then(async function(a){var n,i,a=await this._modifyUrlForNavigationContext(e.url,a.url);I.isShareAsTabEnabled&&this._providerConfig.isShareAsTabEnabled&&(n=await this._modifyUrlForShareAsTab(e.url),(i=(await o.compactHash(n,[])).url.split("sap-url-hash=")[1])?a+="&sap-stageview-hash="+i:(n=await this._modifyUrlForShareAsTab(a),a=await this._addNavmodeInUrl(n,"inplace"))),this._closeBusyDialogAndOpenTeamsDialog(a,e,t)}.bind(this)):(n=e.url,I.isShareAsTabEnabled&&this._providerConfig.isShareAsTabEnabled&&(a=await this._modifyUrlForShareAsTab(n),n=await this._addNavmodeInUrl(a,"inplace")),this._closeBusyDialogAndOpenTeamsDialog(n,e,t))},n.prototype._closeBusyDailog=function(){_&&(_.close(),_.destroy(),clearTimeout(L))},n.prototype._closeBusyDialogAndOpenTeamsDialog=function(e,t,a){this._closeBusyDailog();var o=window.open("","_blank",P);o.opener=null,o.location=this._addCardParamsInUrl(e,t.appTitle,a)},n.prototype._addCardParamsInUrl=function(e,t,a){return a.cardId&&(e=e+"&sap-ui-cardId="+a.cardId),e=(e=a.version?e+"&sap-ui-cardVersion="+a.version:e)+"&sap-ui-cardTitle="+encodeURIComponent(t),e=this._providerConfig.shareAsLinkUrl+"?href="+encodeURIComponent(e)},n.prototype._getShareAsTabUrl=function(){return this._getApplicationID().then(function(e){return"https://teams.microsoft.com/l/entity/"+e+"/tab"})},n.prototype._getApplicationID=function(){var e=sap.ui.require("sap/ushell/Container");return e&&e.getServiceAsync("URLParsing").then(function(e){return o._getCurrentUrl().then(function(t){var t=t.split("#")[0];return-1!==t.indexOf("?")&&(t=e&&e.parseParameters(t.substring(t.indexOf("?"))))&&t["sap-collaboration-xx-TeamsAppId"]&&t["sap-collaboration-xx-TeamsAppId"][0]&&0<t["sap-collaboration-xx-TeamsAppId"][0].length?Promise.resolve(t["sap-collaboration-xx-TeamsAppId"][0]):Promise.resolve(O)})})},n.prototype.isFeatureFlagEnabled=function(){return"AUTHENABLE"===this._providerConfig.isShareAsCardEnabled},n.prototype.isContactsCollaborationSupported=function(){return!0},n.prototype.enableContactsCollaboration=async function(e,t){var a=await o.isTeamsModeActive(),n=await g.fetchServiceStatus();return e&&n.value&&"Active"===n.value[0].FetchContacts?(this.oContactHelper||(this.oContactHelper=new r),"ENABLED"===this._providerConfig.isDirectCommunicationEnabled?this.oContactHelper.loadContactPopover(e,t,!0):this.oContactHelper.loadContactPopover(e,t)):a||!e||"ENABLED"!==this._providerConfig.isDirectCommunicationEnabled?Promise.reject():(this.oContactHelper||(this.oContactHelper=new r),this.oContactHelper.loadMinimalContactPopover(e,t))},n.prototype.getTeamsContactCollabOptions=async function(){return await o.isTeamsModeActive()||"ENABLED"!==this._providerConfig.isDirectCommunicationEnabled?Promise.reject():(this.oContactHelper||(this.oContactHelper=new r),this.oContactHelper.getTeamsContactOptions())},n.prototype.getTeamsContactStatus=async function(e){return await o.isTeamsModeActive()?Promise.reject():(this.oContactHelper||(this.oContactHelper=new r),this.oContactHelper.getTeamsContactStatus(e))},n.prototype.getCollaborationPopover=function(e,t,a,o,n){var i;void 0===t.data||""===t.data.trim()?y.error("Popover cannnot be opened without data"):(e=!e||void 0===e.isShareAsLinkEnabled||e.isShareAsLinkEnabled,n={shareToTeams:!n||void 0===n.shareToTeams||n.shareToTeams,shareToEmail:!n||void 0===n.shareToEmail||n.shareToEmail,shareToCM:!(!n||void 0===n.shareToCM)&&n.shareToCM},i=[],s.system.desktop?e?"X"===this._providerConfig.isShareAsLinkEnabled&&n.shareToTeams?i.push({text:E.getText("COLLABORATION_POPOVER_TEAMS"),icon:"sap-icon://discussion",key:"COLLABORATION_POPOVER_TEAMS"}):y.info("Share as Chat option is not enabled in the tenant"):y.info("Consumer disable Share as Chat option"):y.info("Share as Chat option is not supported in Phone and Tablet"),n.shareToEmail&&i.push({text:E.getText("COLLABORATION_POPOVER_MAIL"),icon:"sap-icon://email",key:"COLLABORATION_POPOVER_MAIL"}),this.oCollaborationManager=new A,(e=this.oCollaborationManager.getOptions())&&n.shareToCM&&i.push({text:e.text,icon:e.icon,key:"COLLABORATION_POPOVER_CM"}),1!==i.length||o||"COLLABORATION_POPOVER_MAIL"!==i[0].key?this._getPopover(t,i,o).openBy(a):this._shareData(t,i[0],o))},n.prototype._getPopover=function(e,t,a){return new d({showHeader:!1,placement:e.placement||"Auto",enableScrolling:!1,content:this._getPopoverContent(e,t,a)})},n.prototype._getPopoverContent=function(e,t,a){var o,n=new S({items:[],direction:b.FlexDirection.Column}),i=new S({direction:"Vertical"===e.sFormat?b.FlexDirection.Column:b.FlexDirection.Row,justifyContent:b.FlexJustifyContent.SpaceAround,items:[]});return t.forEach(o=>{var r=new f({text:o.text,icon:o.icon,width:"Horizontal"===e.sFormat&&3===t.length?"120px":"180px",press:t=>{t.getSource().getParent().getParent().getParent().close(),this._shareData(e,o,a)}}).addStyleClass("sapUiTinyMarginTop").addStyleClass("sapUiTinyMarginBegin");"COLLABORATION_POPOVER_TEAMS"===o.key?r.addStyleClass("sapSuiteUiCollaborationBarMSTeamsButton"+(e.sFormat||"Horizontal")):"COLLABORATION_POPOVER_CM"===o.key?r.addStyleClass("sapSuiteUiCollaborationBarCMButton"+(e.sFormat||"Horizontal")):r.addStyleClass("sapSuiteUiCollaborationBarEmailButton"+(e.sFormat||"Horizontal")),i.addItem(r),n.addItem(i)}),a&&(o=new S({justifyContent:"Vertical"===e.sFormat?b.FlexJustifyContent.Center:b.FlexJustifyContent.SpaceBetween,alignItems:b.FlexAlignItems.Center,items:[new f({text:E.getText("COLLABORATION_POPOVER_COPYURL_BUTTON"),width:"Vertical"===e.sFormat?"150px":"",press:async()=>{await this._writeToClipBoard(e.data)}}).addStyleClass("sapUiTinyMarginBeginEnd")]}),"Horizontal"!==e.sFormat&&void 0!==e.sFormat||(o.insertItem(new C({text:E.getText("COLLABORATION_POPOVER_MSGSTRIP"),showIcon:!0}).addStyleClass("sapUiTinyMarginBeginEnd").addStyleClass("sapSuiteCollaborationBarMsgStrip"),0),o.addStyleClass("sapSuiteUiCollaborationBarMsgStripHBox")),o.addStyleClass("sapUiTinyMarginBeginEnd").addStyleClass("sapUiTinyMarginTopBottom"),n.addItem(o)),("Vertical"===e.sFormat?(i.setHeight(1<t.length?50*t.length+50+"px":"80px"),i.addStyleClass("sapUiSmallMarginBottom")):(i.setHeight("110px"),i)).addStyleClass("sapUiTinyMarginEnd"),n},n.prototype._writeToClipBoard=async function(e){try{await navigator.clipboard.writeText(e)}catch(e){y.info(e)}},n.prototype._shareData=function(e,t,a){var o;"COLLABORATION_POPOVER_TEAMS"===t.key?a?(o={url:e.data,appTitle:e.title||"",subTitle:"",minifyUrlForChat:!0},this._shareAsChat(o)):(o={appTitle:e.title||"",message:e.data,showPreview:e.showPreview},this._shareSummary(o)):"COLLABORATION_POPOVER_MAIL"===t.key?sap.m.URLHelper.triggerEmail(null,e.title&&""!==e.title.trim()?e.title:null,e.data):"COLLABORATION_POPOVER_CM"===t.key&&this.oCollaborationManager.triggerH2HChat(e.title,e.data)},n.prototype._shareSummary=function(e){e={subEntityId:{appTitle:e.appTitle,mode:"summary",message:e.message,showPreview:e.showPreview}},e=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(e));sap.m.URLHelper.redirect(e,!0)},n})},"sap/suite/ui/commons/collaboration/channels/MessageChannel.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){var t,a=e.extend("sap.suite.ui.commons.collaboration.channels.MessageChannel",{postMessage:function(e,t){window.parent.postMessage({...e,_fromMessageChannel:!0},t||"*")},subscribe:function(e){window.addEventListener("message",function(t){t?.data?._fromMessageChannel&&"function"==typeof e&&e(t)})}});return{getInstance:function(){return t=t||new a,Promise.resolve(t)}}})}});
//# sourceMappingURL=Component-preload.js.map