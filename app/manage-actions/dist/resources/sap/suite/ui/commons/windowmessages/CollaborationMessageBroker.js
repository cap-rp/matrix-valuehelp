/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/base/Log","sap/ui/core/Lib"],function(e,n){"use strict";let o;const s=e.getLogger("sap.suite.ui.commons.windowmessages.CollaborationMessageBroker");function t(e){s.info("CollaborationMessageBroker instance is created");const n="sap-suite-ui-commons-collaboration-message-broker";const o="collaboration-channel";const t="get-provider-config";const i="update-top-level-url";const a=sap.ui.require("sap/ushell/Container");if(!a){s.info("UShell Container instance doesn't exist");return}const c=[{channelId:o,version:"1.0"}];const r=async function(e,t,i){try{const c=await a.getServiceAsync("MessageBroker");const r=JSON.stringify(i);await c.publish(o,n,Date.now().toString(),t,[e],r);s.info(`Published successfully to CLIENT_ID: ${e} on CHANNEL_ID: ${o} DATA: ${r}`)}catch(e){s.error(`Failed to publish message: ${e}`)}};const l=function(e,n,o){r(e,n,o)};const u=function(e,n,o){if(!o){return}try{const t=JSON.parse(o);if(t?.url){r(e,n,{success:true});window.location.replace(t.url);window.location.reload()}else{s.info("Invalid URL in the message data.")}}catch(e){s.error("Failed to parse the message data: "+e)}};const f=function(n,o,a,c){s.info("Message Received from CLIENT_ID: "+n+" on CHANNEL_ID: "+o);switch(a){case t:l(n,a,e);break;case i:u(n,a,c);break;default:s.info("Message: '"+a+"' is not supported")}};a.getServiceAsync("MessageBroker").then(function(e){e.connect(n).then(function(){s.info("Client ID: "+n+" is connected successfully");e.subscribe(n,c,f,Function.prototype)})})}return{startInstance:function(e){s.info("CollaborationMessageBroker=>startInstance method is being called");if(!o){o=new t(e)}}}});
//# sourceMappingURL=CollaborationMessageBroker.js.map