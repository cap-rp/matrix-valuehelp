{"version":3,"file":"ContactHelper.js","names":["sap","ui","define","Controller","Fragment","JSONModel","mLibrary","Library","Core","ResourceModel","CollaborationContactInfoHelper","FESRHelper","Element","I18_BUNDLE","getResourceBundleFor","extend","constructor","getFullProfileByEmail","async","sEmail","oFullProfileData","fetchContact","mail","data","photo","this","determineContactStatus","getTeamsContactOptions","that","Promise","resolve","key","icon","tooltip","getText","fesrStepName","callBackHandler","oEvent","handleMSTeamsPress","getTeamsContactStatus","calendar","fetchContactCalendar","badgeIcon","badgeValueState","badgeTooltip","getSource","sType","url","URLHelper","redirect","formatUri","sValue","oParams","mailregex","test","subject","body","loadContactPopover","isDirectCommunicationEnabled","afterClose","load","name","controller","type","then","oPopover","setSemanticStepname","_oContactPopover","setBusy","oTntSet","setFamily","setURI","require","toUrl","m","IllustrationPool","registerIllustrationSet","oJsonModel","isUserExistsInTeams","setModel","model","resource","bundle","bind","loadMinimalContactPopover","params","_oMinContactPopover","destroy","afterOpen","setInitialFocus","getElementById","setData","afterContinue","sUrl","mBadgeInfo","Map","mUserPresence","oBadgeInfo","isoutofoffice","activity","get","sUserPresence","toUpperCase","Object","assign"],"sources":["ContactHelper-dbg.js"],"mappings":"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","ignoreList":[]}