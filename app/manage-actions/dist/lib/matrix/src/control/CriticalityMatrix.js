sap.ui.define(["sap/ui/core/Control"],function(e){"use strict";return e.extend("matrix.control.CriticalityMatrix",{metadata:{properties:{values:{type:"object",defaultValue:{}},titles:{type:"object",defaultValue:{}},cellSize:{type:"int",defaultValue:56},cellsPath:{type:"string",defaultValue:null},modelName:{type:"string",defaultValue:"odata"}},events:{cellPress:{parameters:{key:{type:"string"},color:{type:"string"}}},cellChange:{parameters:{key:{type:"string"},color:{type:"string"},values:{type:"object"}}}}},init:function(){this._loading=false;this._filter="";this._selectedKey=null},_loadCellsFromModel:function(){var e=this.getCellsPath();if(!e||this._loading){return Promise.resolve()}var t=this.getModelName();var i=this.getModel(t);if(!i||typeof i.bindList!=="function"){return Promise.resolve()}this._loading=true;var r=i.bindList(e);return r.requestContexts(0,1e3).then(function(e){var t={},i={};e.forEach(function(e){var r=e.getObject();if(!r){return}var a=r.Key||r.ID||r.key;if(!a){return}t[a]=(r.Color||"white").toString();i[a]=r.Title||""});this.setProperty("values",t,true);this.setProperty("titles",i,true);this.invalidate()}.bind(this)).catch(function(e){console.error("CriticalityMatrix: failed to load cells from model",e)}).finally(function(){this._loading=false}.bind(this))},onBeforeRendering:function(){if(this.getCellsPath()){this._loadCellsFromModel()}},applyFilter:function(e){this._filter=(e||"").toString().trim().toLowerCase();this.invalidate()},renderer:function(e,t){var i=function(e){return String(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};var r=t.getValues()||{};var a=t.getTitles()||{};var l=["A","B","C","D"];var n=t.getCellSize();var o={white:"#ffffff",green:"#92d050",orange:"#f4b084",red:"#ff5c5c"};var s=t._selectedKey;var d=t._filter||"";e.write("<div");e.writeControlData(t);e.addStyle("font-family","Arial, Helvetica, sans-serif");e.writeStyles();e.write(">");e.write("<table style='border-collapse:collapse;'>");e.write("<thead><tr><th></th>");l.forEach(function(t){e.write("<th style='padding:6px 10px;text-align:center;'>"+t+"</th>")});e.write("</tr></thead>");e.write("<tbody>");for(var c=1;c<=5;c++){e.write("<tr>");e.write("<td style='padding:6px 10px;text-align:center;font-weight:600;'>"+c+"</td>");l.forEach(function(t){var l=c+t;var f=(r[l]||"white").toString();var u=a[l]||"";var v=o[f]||f||o.white;var g=true;if(d){var h=l.toLowerCase().indexOf(d)!==-1;var y=(f||"").toLowerCase().indexOf(d)!==-1;var p=(u||"").toLowerCase().indexOf(d)!==-1;g=h||y||p}var w=g?"":"display:none;";var b=s===l?"box-shadow:0 0 0 3px rgba(0,120,210,0.25);":"";var m=l+" - "+f+(u?" : "+u:"");e.write("<td role='button' data-key='"+i(l)+"' data-color='"+i(f)+"' class='cm-cell' "+"title='"+i(m)+"' aria-label='"+i(m)+"' "+"style='width:"+n+"px;height:"+n+"px;border:1px solid #ddd;padding:0;margin:0;vertical-align:middle;background:"+v+";cursor:pointer;"+w+b+"'>");e.write("<div style='width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;'>");e.write("<div style='font-weight:600;line-height:1;'>"+i(l)+"</div>");e.write("<div style='font-size:10px;color:#333;opacity:0.85;line-height:1;margin-top:3px;'>"+i(u)+"</div>");e.write("</div>");e.write("</td>")});e.write("</tr>")}e.write("</tbody>");e.write("</table>");e.write("</div>")},onAfterRendering:function(){var e=this.$();if(!e||!e.length){return}var t=this;e.off(".cm");e.on("click.cm","td[data-key]",function(e){var i=this;var r=i.getAttribute("data-key");var a=i.getAttribute("data-color")||"white";t._selectedKey=r;t.invalidate();t.fireCellPress({key:r,color:a})});e.on("dblclick.cm","td[data-key]",function(e){var i=this;var r=i.getAttribute("data-key");var a=i.getAttribute("data-color")||"white";var l=["white","green","orange","red"];var n=l.indexOf(a);var o=l[(n+1)%l.length];var s=Object.assign({},t.getValues()||{});s[r]=o;t.setProperty("values",s,true);t._selectedKey=r;t.invalidate();t.fireCellChange({key:r,color:o,values:s})})},exit:function(){var e=this.$();if(e&&e.off){e.off(".cm")}}})});
//# sourceMappingURL=CriticalityMatrix.js.map